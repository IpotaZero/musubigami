const Ls="modulepreload",As=function(e,t){return new URL(e,t).href},Qi={},Ps=function(t,n,i){let r=Promise.resolve();if(n&&n.length>0){let l=function(u){return Promise.all(u.map(d=>Promise.resolve(d).then(p=>({status:"fulfilled",value:p}),p=>({status:"rejected",reason:p}))))};const o=document.getElementsByTagName("link"),s=document.querySelector("meta[property=csp-nonce]"),c=s?.nonce||s?.getAttribute("nonce");r=l(n.map(u=>{if(u=As(u,i),u in Qi)return;Qi[u]=!0;const d=u.endsWith(".css"),p=d?'[rel="stylesheet"]':"";if(i)for(let m=o.length-1;m>=0;m--){const v=o[m];if(v.href===u&&(!d||v.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${u}"]${p}`))return;const f=document.createElement("link");if(f.rel=d?"stylesheet":Ls,d||(f.as="script"),f.crossOrigin="",f.href=u,c&&f.setAttribute("nonce",c),document.head.appendChild(f),d)return new Promise((m,v)=>{f.addEventListener("load",m),f.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${u}`)))})}))}function a(o){const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=o,window.dispatchEvent(s),!s.defaultPrevented)throw o}return r.then(o=>{for(const s of o||[])s.status==="rejected"&&a(s.reason);return t().catch(a)})};class er{static container;static init(){this.container=document.getElementById("container"),this.#e()}static#e(){if(!this.container)throw new Error("Container element not found")}}class Ga{static#e="musubigami";static#r(){return{stageDataList:Array.from({length:18},()=>({cleared:!1})),flags:[],bgmVolume:9,seVolume:9}}static#n(){const t=localStorage.getItem(this.#e);return t?JSON.parse(t):this.#r()}static#i(t){localStorage.setItem(this.#e,JSON.stringify(t))}static getStageData(){return this.#n().stageDataList}static setStageData(t,n){const i=this.#n();i.stageDataList[t]=n,this.#i(i)}static getFlags(){return this.#n().flags}static addFlag(t){const n=this.#n();n.flags.includes(t)||(n.flags.push(t),this.#i(n))}static getBGMVolume(){return this.#n().bgmVolume}static getSEVolume(){return this.#n().seVolume}static setBGMVolume(t){const n=this.#n();n.bgmVolume=t,this.#i(n)}static setSEVolume(t){const n=this.#n();n.seVolume=t,this.#i(n)}static clear(){localStorage.removeItem(this.#e)}static allWin(){for(let t=0;t<18;t++)this.setStageData(t,{cleared:!0})}}window.LocalStorage=Ga;class me{static async fadeOut(t,n=200){t.style.transition="opacity 0s",t.style.pointerEvents="none",await me.frame(()=>{t.style.opacity="1"}),await me.frame(()=>{t.style.transition=`opacity ${n}ms`,t.style.opacity="0"}),await me.sleep(n)}static async fadeIn(t,n=200){t.style.transition="opacity 0s",t.style.pointerEvents="none",await me.frame(()=>{t.style.opacity="0"}),await me.frame(()=>{t.style.transition=`opacity ${n}ms`,t.style.opacity="1"}),await me.sleep(n),await me.frame(()=>{t.style.pointerEvents=""})}static async valeOut(t,n=200){t.style.pointerEvents="none";const i=document.createElement("div");i.classList.add("vale"),i.style.transition=`left ${n}ms cubic-bezier(0.37, 0, 0.63, 1)`,document.body.appendChild(i),await me.frame(),await me.frame(()=>{i.style.left="0"}),await me.sleep(n)}static async valeIn(t,n=200){const i=document.querySelector(".vale");i&&(i.style.transition=`left ${n}ms cubic-bezier(0.12, 0, 0.39, 0)`,await me.frame(()=>{i.style.left="calc(100dvw + 4em)"}),await me.sleep(n),document.body.removeChild(i),t.style.pointerEvents="")}static sleep(t){return new Promise(n=>{setTimeout(n,t)})}static ok(){const t=new AbortController;return new Promise(n=>{document.addEventListener("click",()=>{t.abort(),n()},{signal:t.signal}),document.addEventListener("keydown",i=>{["KeyZ","Enter","Space"].includes(i.code)&&(t.abort(),n())},{signal:t.signal})})}static key(){const t=new AbortController;return new Promise(n=>{document.addEventListener("click",()=>{t.abort(),n()},{signal:t.signal}),document.addEventListener("keydown",i=>{t.abort(),n()},{signal:t.signal})})}static frame(t=()=>{}){return new Promise(n=>requestAnimationFrame(()=>{t(),n()}))}static async timeOver(t,n,i){let r;const a=new Promise(o=>{r=setTimeout(()=>{o(i())},t)});try{return await Promise.race([n,a])}finally{clearTimeout(r)}}static async loading(t,n,i){let r=!1;me.sleep(t).then(()=>{r||i()});const a=await n;return r=!0,a}}class Ds{static#e;static init(t){return this.#e=t,this.#e.ready}static async goto(t,{showLoading:n=this.#r,hideLoading:i=this.#n,fadeOut:r=me.fadeOut,fadeIn:a=me.fadeIn,msIn:o=500,msOut:s=500,afterLoad:c=()=>{}}={}){const l=document.getElementById("container");await r(l,o),await this.#e.end(),this.#e=t();let u=!1;await me.loading(1e3,this.#e.ready,()=>{n(),u=!0}),u&&i(),c(),await a(l,s)}static#r(){const t=document.createElement("p");t.textContent="Loading",t.classList.add("loading"),document.body.appendChild(t)}static#n(){document.querySelectorAll(".loading").forEach(t=>t.remove())}}class Jn{static taskMap=new Map;static register(t){this.cancel(t);const n={name:t,canceled:!1};return this.taskMap.set(t,n),n}static cancel(t){const n=this.taskMap.get(t);n&&(n.canceled=!0,this.taskMap.delete(t))}static complete(t){this.taskMap.get(t.name)===t&&this.taskMap.delete(t.name)}}class an{buffer;options;gain;fadeGain;source;state="yet";startTime=0;offset=0;constructor(t,n={}){this.buffer=t,this.options=n,this.gain=Ve.context.createGain(),this.gain.connect(Ve.gain),this.gain.gain.value=n.volume??1,this.fadeGain=Ve.context.createGain(),this.fadeGain.connect(this.gain),this.source=an.createSource(this.buffer,this.options),this.source.connect(this.fadeGain)}play(){if(this.state==="running"){console.warn("既に再生中!");return}this.resetSource(),this.state="running",this.source.start(0,this.offset),this.startTime=Ve.context.currentTime-this.offset}pause(){if(this.state=="yet"){console.warn("まだ再生されていない!");return}this.state="paused",this.source.stop(),this.offset=Ve.context.currentTime-this.startTime}stop(){if(this.state=="yet"){console.warn("まだ再生されていない!");return}this.state="yet",this.source.stop(),this.offset=0}async fade(t,n,i){const r=Ve.context.currentTime;this.fadeGain.gain.cancelScheduledValues(r),this.fadeGain.gain.setValueAtTime(n,r),this.fadeGain.gain.exponentialRampToValueAtTime(i,r+t/1e3),await me.sleep(t)}resetSource(){try{this.source.stop()}catch{}this.source.disconnect(),this.source=an.createSource(this.buffer,this.options),this.source.connect(this.fadeGain)}static createSource(t,n){const i=Ve.context.createBufferSource();return i.buffer=t,i.loopStart=n.loopStartS??0,i.loopEnd=n.loopEndS??t.duration,i.loop=n.loop??!0,i}}class Ve{static context;static gain;static cache=new Map;static bgmList=[];static async init(){if(this.context)throw new Error("BGM has already been initialized.");this.context=new AudioContext,this.gain=this.context.createGain(),this.gain.connect(this.context.destination),await this.context.resume()}static async load(t){if(this.cache.has(t))return;const i=await(await fetch(t)).arrayBuffer(),r=await Ve.context.decodeAudioData(i);this.cache.set(t,r)}static unload(t){Jn.cancel(t),this.cache.has(t)&&this.cache.delete(t)}static clearCache(){this.cache.clear()}static async change(t,n={}){const i=Jn.register(t);if(await Promise.all([this.load(t),this.fadeOut()]),i.canceled)return;this.pause();const r=new an(this.cache.get(t),n);r.play(),this.bgmList=[{bgm:r,url:t}]}static async glance(t,n={}){const i=Jn.register(t);if(await Promise.all([this.load(t),this.fadeOut()]),i.canceled)return;this.pause();const r=new an(this.cache.get(t),n);r.play(),this.bgmList.push({bgm:r,url:t})}static back(){if(this.bgmList.length<=1){console.warn("戻る場所が無いよ!");return}const t=this.bgmList.pop();t.bgm.fade(2e3,1,.001).then(()=>{t.bgm.stop()});const n=this.bgmList.at(-1);n.bgm.fade(1e3,.001,1),n.bgm.play()}static async fadeOut(t=1e3){await this.bgmList.at(-1)?.bgm.fade(t,1,.001)}static stop(){this.bgmList.at(-1)?.bgm.stop()}static pause(){this.bgmList.at(-1)?.bgm.pause()}static setVolume(t){this.gain&&(this.gain.gain.value=t)}}window.BGM=Ve;class Ts extends HTMLElement{resolve=()=>{};ready=new Promise(t=>{this.resolve=t});connectedCallback(){const n=document.createElementNS("http://www.w3.org/2000/svg","svg");n.setAttribute("viewBox","0 0 400 300"),this.appendChild(n),this.#e(n)}getConnectedVertices(t){const n=[];this.querySelectorAll(`.path[data-from="${t}"]`).forEach(r=>{n.push(Number(r.dataset.to))}),this.querySelectorAll(`.path[data-to="${t}"]`).forEach(r=>{n.push(Number(r.dataset.from))});const i=Array.from(this.querySelectorAll(".stage"));return n.map(r=>i[r])}async#e(t){const n=this.getAttribute("src");n&&await fetch(n).then(i=>i.json()).then(i=>{this.#r(t,i)})}#r(t,{vertices:n,edges:i,events:r}){const a="http://www.w3.org/2000/svg";for(;t.firstChild;)t.removeChild(t.firstChild);i.forEach(o=>{const s=document.createElementNS(a,"line"),[c,l]=n[o[0]],[u,d]=n[o[1]];s.setAttribute("x1",c.toString()),s.setAttribute("y1",l.toString()),s.setAttribute("x2",u.toString()),s.setAttribute("y2",d.toString()),s.classList.add("path","hidden"),s.dataset.from=`${o[0]}`,s.dataset.to=`${o[1]}`,t.appendChild(s)}),n.forEach(([o,s],c)=>{const l=document.createElementNS(a,"rect");l.setAttribute("x",(o-20).toString()),l.setAttribute("y",(s-20).toString()),l.setAttribute("width","40"),l.setAttribute("height","40"),l.classList.add("stage","hidden"),t.appendChild(l)}),r.forEach(([o,s,c,l,u])=>{const d=document.createElementNS(a,"image");d.setAttribute("href",c),d.setAttribute("x",o.toString()),d.setAttribute("y",s.toString()),d.setAttribute("width","40"),d.setAttribute("height","40"),d.dataset.eventName=l,d.dataset.bgm=u?u.bgm:"",d.classList.add("event"),t.appendChild(d)}),this.resolve()}}customElements.define("x-graph",Ts);class Gn{static#e=["KeyZ","Enter","Space"];static#r=["KeyX","Escape","Backspace"];static#n=[0,0];static#i=[0,0];static#t=null;static#s=new AbortController;static init(){window.addEventListener("keydown",this.#l.bind(this),{signal:this.#s.signal})}static update(t){this.#t=t??null,this.#o(),this.#u(),this.#a()}static remove(){this.#s.abort()}static#o(){if(this.#i=[0,0],!this.#t)return;const t=Array.from(this.#t.querySelectorAll("button")).filter(n=>n instanceof HTMLElement).find(n=>n.classList.contains("active"));t&&(this.#i=JSON.parse(`[${t.dataset.position}]`))}static#u(){this.#t&&(this.#n=[0,0],Array.from(this.#t.querySelectorAll("button")).filter(t=>t.dataset.position).forEach(t=>{const n=JSON.parse(`[${t.dataset.position}]`);Array.isArray(n)&&(n[0]>this.#n[0]&&(this.#n[0]=n[0]),n[1]>this.#n[1]&&(this.#n[1]=n[1]))}))}static#l(t){this.#h(t),this.#a(),this.#f(t),this.#d(t)}static#f(t){if(!Gn.#e.includes(t.code))return;const n=this.#p(this.#i);n&&n.click()}static#d(t){if(!Gn.#r.includes(t.code))return;const n=this.#c();n&&n.click()}static#h(t){switch(t.code){case"ArrowUp":this.#i[0]--;break;case"ArrowDown":this.#i[0]++;break;case"ArrowLeft":this.#i[1]--;break;case"ArrowRight":this.#i[1]++;break}this.#i[0]=tr(this.#i[0],0,this.#n[0]),this.#i[1]=tr(this.#i[1],0,this.#n[1])}static#a(){this.#t&&Array.from(this.#t.querySelectorAll("button")).filter(t=>t.dataset.position).forEach(t=>{const n=JSON.parse(`[${t.dataset.position}]`);if(!Array.isArray(n))return;const i=n.join(",")===this.#i.join(",");t.classList.toggle("active",i)})}static#p(t){if(this.#t)return Array.from(this.#t.querySelectorAll("button")).filter(n=>n.dataset.position).find(n=>{const i=JSON.parse(`[${n.dataset.position}]`);return Array.isArray(i)?i[0]===t[0]&&i[1]===t[1]:!1})}static#c(){if(this.#t)return Array.from(this.#t.querySelectorAll("button")).find(t=>t.dataset.back||t.classList.contains("back"))}}function tr(e,t,n){return Math.max(Math.min(e,n),t)}function Nt(e){let t=e.length;for(;--t>=0;)e[t]=0}const Os=3,Ms=258,Ua=29,Rs=256,Bs=Rs+1+Ua,Va=30,_s=512,Ns=new Array((Bs+2)*2);Nt(Ns);const zs=new Array(Va*2);Nt(zs);const Gs=new Array(_s);Nt(Gs);const Us=new Array(Ms-Os+1);Nt(Us);const Vs=new Array(Ua);Nt(Vs);const Hs=new Array(Va);Nt(Hs);const js=(e,t,n,i)=>{let r=e&65535|0,a=e>>>16&65535|0,o=0;for(;n!==0;){o=n>2e3?2e3:n,n-=o;do r=r+t[i++]|0,a=a+r|0;while(--o);r%=65521,a%=65521}return r|a<<16|0};var xi=js;const Ws=()=>{let e,t=[];for(var n=0;n<256;n++){e=n;for(var i=0;i<8;i++)e=e&1?3988292384^e>>>1:e>>>1;t[n]=e}return t},Xs=new Uint32Array(Ws()),qs=(e,t,n,i)=>{const r=Xs,a=i+n;e^=-1;for(let o=i;o<a;o++)e=e>>>8^r[(e^t[o])&255];return e^-1};var Ze=qs,Fi={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Ha={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const $s=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var Zs=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const n=t.shift();if(n){if(typeof n!="object")throw new TypeError(n+"must be non-object");for(const i in n)$s(n,i)&&(e[i]=n[i])}}return e},Ys=e=>{let t=0;for(let i=0,r=e.length;i<r;i++)t+=e[i].length;const n=new Uint8Array(t);for(let i=0,r=0,a=e.length;i<a;i++){let o=e[i];n.set(o,r),r+=o.length}return n},ja={assign:Zs,flattenChunks:Ys};let Wa=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{Wa=!1}const on=new Uint8Array(256);for(let e=0;e<256;e++)on[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;on[254]=on[254]=1;var Ks=e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let t,n,i,r,a,o=e.length,s=0;for(r=0;r<o;r++)n=e.charCodeAt(r),(n&64512)===55296&&r+1<o&&(i=e.charCodeAt(r+1),(i&64512)===56320&&(n=65536+(n-55296<<10)+(i-56320),r++)),s+=n<128?1:n<2048?2:n<65536?3:4;for(t=new Uint8Array(s),a=0,r=0;a<s;r++)n=e.charCodeAt(r),(n&64512)===55296&&r+1<o&&(i=e.charCodeAt(r+1),(i&64512)===56320&&(n=65536+(n-55296<<10)+(i-56320),r++)),n<128?t[a++]=n:n<2048?(t[a++]=192|n>>>6,t[a++]=128|n&63):n<65536?(t[a++]=224|n>>>12,t[a++]=128|n>>>6&63,t[a++]=128|n&63):(t[a++]=240|n>>>18,t[a++]=128|n>>>12&63,t[a++]=128|n>>>6&63,t[a++]=128|n&63);return t};const Js=(e,t)=>{if(t<65534&&e.subarray&&Wa)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let n="";for(let i=0;i<t;i++)n+=String.fromCharCode(e[i]);return n};var Qs=(e,t)=>{const n=t||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,t));let i,r;const a=new Array(n*2);for(r=0,i=0;i<n;){let o=e[i++];if(o<128){a[r++]=o;continue}let s=on[o];if(s>4){a[r++]=65533,i+=s-1;continue}for(o&=s===2?31:s===3?15:7;s>1&&i<n;)o=o<<6|e[i++]&63,s--;if(s>1){a[r++]=65533;continue}o<65536?a[r++]=o:(o-=65536,a[r++]=55296|o>>10&1023,a[r++]=56320|o&1023)}return Js(a,r)},el=(e,t)=>{t=t||e.length,t>e.length&&(t=e.length);let n=t-1;for(;n>=0&&(e[n]&192)===128;)n--;return n<0||n===0?t:n+on[e[n]]>t?n:t},ki={string2buf:Ks,buf2string:Qs,utf8border:el};function tl(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var nl=tl;const pn=16209,il=16191;var rl=function(t,n){let i,r,a,o,s,c,l,u,d,p,f,m,v,x,b,y,S,g,F,w,k,C,O,P;const M=t.state;i=t.next_in,O=t.input,r=i+(t.avail_in-5),a=t.next_out,P=t.output,o=a-(n-t.avail_out),s=a+(t.avail_out-257),c=M.dmax,l=M.wsize,u=M.whave,d=M.wnext,p=M.window,f=M.hold,m=M.bits,v=M.lencode,x=M.distcode,b=(1<<M.lenbits)-1,y=(1<<M.distbits)-1;e:do{m<15&&(f+=O[i++]<<m,m+=8,f+=O[i++]<<m,m+=8),S=v[f&b];t:for(;;){if(g=S>>>24,f>>>=g,m-=g,g=S>>>16&255,g===0)P[a++]=S&65535;else if(g&16){F=S&65535,g&=15,g&&(m<g&&(f+=O[i++]<<m,m+=8),F+=f&(1<<g)-1,f>>>=g,m-=g),m<15&&(f+=O[i++]<<m,m+=8,f+=O[i++]<<m,m+=8),S=x[f&y];n:for(;;){if(g=S>>>24,f>>>=g,m-=g,g=S>>>16&255,g&16){if(w=S&65535,g&=15,m<g&&(f+=O[i++]<<m,m+=8,m<g&&(f+=O[i++]<<m,m+=8)),w+=f&(1<<g)-1,w>c){t.msg="invalid distance too far back",M.mode=pn;break e}if(f>>>=g,m-=g,g=a-o,w>g){if(g=w-g,g>u&&M.sane){t.msg="invalid distance too far back",M.mode=pn;break e}if(k=0,C=p,d===0){if(k+=l-g,g<F){F-=g;do P[a++]=p[k++];while(--g);k=a-w,C=P}}else if(d<g){if(k+=l+d-g,g-=d,g<F){F-=g;do P[a++]=p[k++];while(--g);if(k=0,d<F){g=d,F-=g;do P[a++]=p[k++];while(--g);k=a-w,C=P}}}else if(k+=d-g,g<F){F-=g;do P[a++]=p[k++];while(--g);k=a-w,C=P}for(;F>2;)P[a++]=C[k++],P[a++]=C[k++],P[a++]=C[k++],F-=3;F&&(P[a++]=C[k++],F>1&&(P[a++]=C[k++]))}else{k=a-w;do P[a++]=P[k++],P[a++]=P[k++],P[a++]=P[k++],F-=3;while(F>2);F&&(P[a++]=P[k++],F>1&&(P[a++]=P[k++]))}}else if((g&64)===0){S=x[(S&65535)+(f&(1<<g)-1)];continue n}else{t.msg="invalid distance code",M.mode=pn;break e}break}}else if((g&64)===0){S=v[(S&65535)+(f&(1<<g)-1)];continue t}else if(g&32){M.mode=il;break e}else{t.msg="invalid literal/length code",M.mode=pn;break e}break}}while(i<r&&a<s);F=m>>3,i-=F,m-=F<<3,f&=(1<<m)-1,t.next_in=i,t.next_out=a,t.avail_in=i<r?5+(r-i):5-(i-r),t.avail_out=a<s?257+(s-a):257-(a-s),M.hold=f,M.bits=m};const kt=15,nr=852,ir=592,rr=0,Qn=1,ar=2,al=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),ol=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),sl=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),ll=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),cl=(e,t,n,i,r,a,o,s)=>{const c=s.bits;let l=0,u=0,d=0,p=0,f=0,m=0,v=0,x=0,b=0,y=0,S,g,F,w,k,C=null,O;const P=new Uint16Array(kt+1),M=new Uint16Array(kt+1);let j=null,G,W,q;for(l=0;l<=kt;l++)P[l]=0;for(u=0;u<i;u++)P[t[n+u]]++;for(f=c,p=kt;p>=1&&P[p]===0;p--);if(f>p&&(f=p),p===0)return r[a++]=1<<24|64<<16|0,r[a++]=1<<24|64<<16|0,s.bits=1,0;for(d=1;d<p&&P[d]===0;d++);for(f<d&&(f=d),x=1,l=1;l<=kt;l++)if(x<<=1,x-=P[l],x<0)return-1;if(x>0&&(e===rr||p!==1))return-1;for(M[1]=0,l=1;l<kt;l++)M[l+1]=M[l]+P[l];for(u=0;u<i;u++)t[n+u]!==0&&(o[M[t[n+u]]++]=u);if(e===rr?(C=j=o,O=20):e===Qn?(C=al,j=ol,O=257):(C=sl,j=ll,O=0),y=0,u=0,l=d,k=a,m=f,v=0,F=-1,b=1<<f,w=b-1,e===Qn&&b>nr||e===ar&&b>ir)return 1;for(;;){G=l-v,o[u]+1<O?(W=0,q=o[u]):o[u]>=O?(W=j[o[u]-O],q=C[o[u]-O]):(W=96,q=0),S=1<<l-v,g=1<<m,d=g;do g-=S,r[k+(y>>v)+g]=G<<24|W<<16|q|0;while(g!==0);for(S=1<<l-1;y&S;)S>>=1;if(S!==0?(y&=S-1,y+=S):y=0,u++,--P[l]===0){if(l===p)break;l=t[n+o[u]]}if(l>f&&(y&w)!==F){for(v===0&&(v=f),k+=d,m=l-v,x=1<<m;m+v<p&&(x-=P[m+v],!(x<=0));)m++,x<<=1;if(b+=1<<m,e===Qn&&b>nr||e===ar&&b>ir)return 1;F=y&w,r[F]=f<<24|m<<16|k-a|0}}return y!==0&&(r[k+y]=l-v<<24|64<<16|0),s.bits=f,0};var Kt=cl;const ul=0,Xa=1,qa=2,{Z_FINISH:or,Z_BLOCK:fl,Z_TREES:vn,Z_OK:St,Z_STREAM_END:dl,Z_NEED_DICT:hl,Z_STREAM_ERROR:Ge,Z_DATA_ERROR:$a,Z_MEM_ERROR:Za,Z_BUF_ERROR:pl,Z_DEFLATED:sr}=Ha,Xn=16180,lr=16181,cr=16182,ur=16183,fr=16184,dr=16185,hr=16186,pr=16187,vr=16188,mr=16189,Un=16190,Qe=16191,ei=16192,gr=16193,ti=16194,br=16195,yr=16196,Sr=16197,xr=16198,mn=16199,gn=16200,Fr=16201,kr=16202,Cr=16203,Ir=16204,wr=16205,ni=16206,Er=16207,Lr=16208,de=16209,Ya=16210,Ka=16211,vl=852,ml=592,gl=15,bl=gl,Ar=e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24);function yl(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Ft=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<Xn||t.mode>Ka?1:0},Ja=e=>{if(Ft(e))return Ge;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=t.wrap&1),t.mode=Xn,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(vl),t.distcode=t.distdyn=new Int32Array(ml),t.sane=1,t.back=-1,St},Qa=e=>{if(Ft(e))return Ge;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,Ja(e)},eo=(e,t)=>{let n;if(Ft(e))return Ge;const i=e.state;return t<0?(n=0,t=-t):(n=(t>>4)+5,t<48&&(t&=15)),t&&(t<8||t>15)?Ge:(i.window!==null&&i.wbits!==t&&(i.window=null),i.wrap=n,i.wbits=t,Qa(e))},to=(e,t)=>{if(!e)return Ge;const n=new yl;e.state=n,n.strm=e,n.window=null,n.mode=Xn;const i=eo(e,t);return i!==St&&(e.state=null),i},Sl=e=>to(e,bl);let Pr=!0,ii,ri;const xl=e=>{if(Pr){ii=new Int32Array(512),ri=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(Kt(Xa,e.lens,0,288,ii,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;Kt(qa,e.lens,0,32,ri,0,e.work,{bits:5}),Pr=!1}e.lencode=ii,e.lenbits=9,e.distcode=ri,e.distbits=5},no=(e,t,n,i)=>{let r;const a=e.state;return a.window===null&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new Uint8Array(a.wsize)),i>=a.wsize?(a.window.set(t.subarray(n-a.wsize,n),0),a.wnext=0,a.whave=a.wsize):(r=a.wsize-a.wnext,r>i&&(r=i),a.window.set(t.subarray(n-i,n-i+r),a.wnext),i-=r,i?(a.window.set(t.subarray(n-i,n),0),a.wnext=i,a.whave=a.wsize):(a.wnext+=r,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=r))),0},Fl=(e,t)=>{let n,i,r,a,o,s,c,l,u,d,p,f,m,v,x=0,b,y,S,g,F,w,k,C;const O=new Uint8Array(4);let P,M;const j=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Ft(e)||!e.output||!e.input&&e.avail_in!==0)return Ge;n=e.state,n.mode===Qe&&(n.mode=ei),o=e.next_out,r=e.output,c=e.avail_out,a=e.next_in,i=e.input,s=e.avail_in,l=n.hold,u=n.bits,d=s,p=c,C=St;e:for(;;)switch(n.mode){case Xn:if(n.wrap===0){n.mode=ei;break}for(;u<16;){if(s===0)break e;s--,l+=i[a++]<<u,u+=8}if(n.wrap&2&&l===35615){n.wbits===0&&(n.wbits=15),n.check=0,O[0]=l&255,O[1]=l>>>8&255,n.check=Ze(n.check,O,2,0),l=0,u=0,n.mode=lr;break}if(n.head&&(n.head.done=!1),!(n.wrap&1)||(((l&255)<<8)+(l>>8))%31){e.msg="incorrect header check",n.mode=de;break}if((l&15)!==sr){e.msg="unknown compression method",n.mode=de;break}if(l>>>=4,u-=4,k=(l&15)+8,n.wbits===0&&(n.wbits=k),k>15||k>n.wbits){e.msg="invalid window size",n.mode=de;break}n.dmax=1<<n.wbits,n.flags=0,e.adler=n.check=1,n.mode=l&512?mr:Qe,l=0,u=0;break;case lr:for(;u<16;){if(s===0)break e;s--,l+=i[a++]<<u,u+=8}if(n.flags=l,(n.flags&255)!==sr){e.msg="unknown compression method",n.mode=de;break}if(n.flags&57344){e.msg="unknown header flags set",n.mode=de;break}n.head&&(n.head.text=l>>8&1),n.flags&512&&n.wrap&4&&(O[0]=l&255,O[1]=l>>>8&255,n.check=Ze(n.check,O,2,0)),l=0,u=0,n.mode=cr;case cr:for(;u<32;){if(s===0)break e;s--,l+=i[a++]<<u,u+=8}n.head&&(n.head.time=l),n.flags&512&&n.wrap&4&&(O[0]=l&255,O[1]=l>>>8&255,O[2]=l>>>16&255,O[3]=l>>>24&255,n.check=Ze(n.check,O,4,0)),l=0,u=0,n.mode=ur;case ur:for(;u<16;){if(s===0)break e;s--,l+=i[a++]<<u,u+=8}n.head&&(n.head.xflags=l&255,n.head.os=l>>8),n.flags&512&&n.wrap&4&&(O[0]=l&255,O[1]=l>>>8&255,n.check=Ze(n.check,O,2,0)),l=0,u=0,n.mode=fr;case fr:if(n.flags&1024){for(;u<16;){if(s===0)break e;s--,l+=i[a++]<<u,u+=8}n.length=l,n.head&&(n.head.extra_len=l),n.flags&512&&n.wrap&4&&(O[0]=l&255,O[1]=l>>>8&255,n.check=Ze(n.check,O,2,0)),l=0,u=0}else n.head&&(n.head.extra=null);n.mode=dr;case dr:if(n.flags&1024&&(f=n.length,f>s&&(f=s),f&&(n.head&&(k=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(i.subarray(a,a+f),k)),n.flags&512&&n.wrap&4&&(n.check=Ze(n.check,i,f,a)),s-=f,a+=f,n.length-=f),n.length))break e;n.length=0,n.mode=hr;case hr:if(n.flags&2048){if(s===0)break e;f=0;do k=i[a+f++],n.head&&k&&n.length<65536&&(n.head.name+=String.fromCharCode(k));while(k&&f<s);if(n.flags&512&&n.wrap&4&&(n.check=Ze(n.check,i,f,a)),s-=f,a+=f,k)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=pr;case pr:if(n.flags&4096){if(s===0)break e;f=0;do k=i[a+f++],n.head&&k&&n.length<65536&&(n.head.comment+=String.fromCharCode(k));while(k&&f<s);if(n.flags&512&&n.wrap&4&&(n.check=Ze(n.check,i,f,a)),s-=f,a+=f,k)break e}else n.head&&(n.head.comment=null);n.mode=vr;case vr:if(n.flags&512){for(;u<16;){if(s===0)break e;s--,l+=i[a++]<<u,u+=8}if(n.wrap&4&&l!==(n.check&65535)){e.msg="header crc mismatch",n.mode=de;break}l=0,u=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=Qe;break;case mr:for(;u<32;){if(s===0)break e;s--,l+=i[a++]<<u,u+=8}e.adler=n.check=Ar(l),l=0,u=0,n.mode=Un;case Un:if(n.havedict===0)return e.next_out=o,e.avail_out=c,e.next_in=a,e.avail_in=s,n.hold=l,n.bits=u,hl;e.adler=n.check=1,n.mode=Qe;case Qe:if(t===fl||t===vn)break e;case ei:if(n.last){l>>>=u&7,u-=u&7,n.mode=ni;break}for(;u<3;){if(s===0)break e;s--,l+=i[a++]<<u,u+=8}switch(n.last=l&1,l>>>=1,u-=1,l&3){case 0:n.mode=gr;break;case 1:if(xl(n),n.mode=mn,t===vn){l>>>=2,u-=2;break e}break;case 2:n.mode=yr;break;case 3:e.msg="invalid block type",n.mode=de}l>>>=2,u-=2;break;case gr:for(l>>>=u&7,u-=u&7;u<32;){if(s===0)break e;s--,l+=i[a++]<<u,u+=8}if((l&65535)!==(l>>>16^65535)){e.msg="invalid stored block lengths",n.mode=de;break}if(n.length=l&65535,l=0,u=0,n.mode=ti,t===vn)break e;case ti:n.mode=br;case br:if(f=n.length,f){if(f>s&&(f=s),f>c&&(f=c),f===0)break e;r.set(i.subarray(a,a+f),o),s-=f,a+=f,c-=f,o+=f,n.length-=f;break}n.mode=Qe;break;case yr:for(;u<14;){if(s===0)break e;s--,l+=i[a++]<<u,u+=8}if(n.nlen=(l&31)+257,l>>>=5,u-=5,n.ndist=(l&31)+1,l>>>=5,u-=5,n.ncode=(l&15)+4,l>>>=4,u-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=de;break}n.have=0,n.mode=Sr;case Sr:for(;n.have<n.ncode;){for(;u<3;){if(s===0)break e;s--,l+=i[a++]<<u,u+=8}n.lens[j[n.have++]]=l&7,l>>>=3,u-=3}for(;n.have<19;)n.lens[j[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,P={bits:n.lenbits},C=Kt(ul,n.lens,0,19,n.lencode,0,n.work,P),n.lenbits=P.bits,C){e.msg="invalid code lengths set",n.mode=de;break}n.have=0,n.mode=xr;case xr:for(;n.have<n.nlen+n.ndist;){for(;x=n.lencode[l&(1<<n.lenbits)-1],b=x>>>24,y=x>>>16&255,S=x&65535,!(b<=u);){if(s===0)break e;s--,l+=i[a++]<<u,u+=8}if(S<16)l>>>=b,u-=b,n.lens[n.have++]=S;else{if(S===16){for(M=b+2;u<M;){if(s===0)break e;s--,l+=i[a++]<<u,u+=8}if(l>>>=b,u-=b,n.have===0){e.msg="invalid bit length repeat",n.mode=de;break}k=n.lens[n.have-1],f=3+(l&3),l>>>=2,u-=2}else if(S===17){for(M=b+3;u<M;){if(s===0)break e;s--,l+=i[a++]<<u,u+=8}l>>>=b,u-=b,k=0,f=3+(l&7),l>>>=3,u-=3}else{for(M=b+7;u<M;){if(s===0)break e;s--,l+=i[a++]<<u,u+=8}l>>>=b,u-=b,k=0,f=11+(l&127),l>>>=7,u-=7}if(n.have+f>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=de;break}for(;f--;)n.lens[n.have++]=k}}if(n.mode===de)break;if(n.lens[256]===0){e.msg="invalid code -- missing end-of-block",n.mode=de;break}if(n.lenbits=9,P={bits:n.lenbits},C=Kt(Xa,n.lens,0,n.nlen,n.lencode,0,n.work,P),n.lenbits=P.bits,C){e.msg="invalid literal/lengths set",n.mode=de;break}if(n.distbits=6,n.distcode=n.distdyn,P={bits:n.distbits},C=Kt(qa,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,P),n.distbits=P.bits,C){e.msg="invalid distances set",n.mode=de;break}if(n.mode=mn,t===vn)break e;case mn:n.mode=gn;case gn:if(s>=6&&c>=258){e.next_out=o,e.avail_out=c,e.next_in=a,e.avail_in=s,n.hold=l,n.bits=u,rl(e,p),o=e.next_out,r=e.output,c=e.avail_out,a=e.next_in,i=e.input,s=e.avail_in,l=n.hold,u=n.bits,n.mode===Qe&&(n.back=-1);break}for(n.back=0;x=n.lencode[l&(1<<n.lenbits)-1],b=x>>>24,y=x>>>16&255,S=x&65535,!(b<=u);){if(s===0)break e;s--,l+=i[a++]<<u,u+=8}if(y&&(y&240)===0){for(g=b,F=y,w=S;x=n.lencode[w+((l&(1<<g+F)-1)>>g)],b=x>>>24,y=x>>>16&255,S=x&65535,!(g+b<=u);){if(s===0)break e;s--,l+=i[a++]<<u,u+=8}l>>>=g,u-=g,n.back+=g}if(l>>>=b,u-=b,n.back+=b,n.length=S,y===0){n.mode=wr;break}if(y&32){n.back=-1,n.mode=Qe;break}if(y&64){e.msg="invalid literal/length code",n.mode=de;break}n.extra=y&15,n.mode=Fr;case Fr:if(n.extra){for(M=n.extra;u<M;){if(s===0)break e;s--,l+=i[a++]<<u,u+=8}n.length+=l&(1<<n.extra)-1,l>>>=n.extra,u-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=kr;case kr:for(;x=n.distcode[l&(1<<n.distbits)-1],b=x>>>24,y=x>>>16&255,S=x&65535,!(b<=u);){if(s===0)break e;s--,l+=i[a++]<<u,u+=8}if((y&240)===0){for(g=b,F=y,w=S;x=n.distcode[w+((l&(1<<g+F)-1)>>g)],b=x>>>24,y=x>>>16&255,S=x&65535,!(g+b<=u);){if(s===0)break e;s--,l+=i[a++]<<u,u+=8}l>>>=g,u-=g,n.back+=g}if(l>>>=b,u-=b,n.back+=b,y&64){e.msg="invalid distance code",n.mode=de;break}n.offset=S,n.extra=y&15,n.mode=Cr;case Cr:if(n.extra){for(M=n.extra;u<M;){if(s===0)break e;s--,l+=i[a++]<<u,u+=8}n.offset+=l&(1<<n.extra)-1,l>>>=n.extra,u-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=de;break}n.mode=Ir;case Ir:if(c===0)break e;if(f=p-c,n.offset>f){if(f=n.offset-f,f>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=de;break}f>n.wnext?(f-=n.wnext,m=n.wsize-f):m=n.wnext-f,f>n.length&&(f=n.length),v=n.window}else v=r,m=o-n.offset,f=n.length;f>c&&(f=c),c-=f,n.length-=f;do r[o++]=v[m++];while(--f);n.length===0&&(n.mode=gn);break;case wr:if(c===0)break e;r[o++]=n.length,c--,n.mode=gn;break;case ni:if(n.wrap){for(;u<32;){if(s===0)break e;s--,l|=i[a++]<<u,u+=8}if(p-=c,e.total_out+=p,n.total+=p,n.wrap&4&&p&&(e.adler=n.check=n.flags?Ze(n.check,r,p,o-p):xi(n.check,r,p,o-p)),p=c,n.wrap&4&&(n.flags?l:Ar(l))!==n.check){e.msg="incorrect data check",n.mode=de;break}l=0,u=0}n.mode=Er;case Er:if(n.wrap&&n.flags){for(;u<32;){if(s===0)break e;s--,l+=i[a++]<<u,u+=8}if(n.wrap&4&&l!==(n.total&4294967295)){e.msg="incorrect length check",n.mode=de;break}l=0,u=0}n.mode=Lr;case Lr:C=dl;break e;case de:C=$a;break e;case Ya:return Za;case Ka:default:return Ge}return e.next_out=o,e.avail_out=c,e.next_in=a,e.avail_in=s,n.hold=l,n.bits=u,(n.wsize||p!==e.avail_out&&n.mode<de&&(n.mode<ni||t!==or))&&no(e,e.output,e.next_out,p-e.avail_out),d-=e.avail_in,p-=e.avail_out,e.total_in+=d,e.total_out+=p,n.total+=p,n.wrap&4&&p&&(e.adler=n.check=n.flags?Ze(n.check,r,p,e.next_out-p):xi(n.check,r,p,e.next_out-p)),e.data_type=n.bits+(n.last?64:0)+(n.mode===Qe?128:0)+(n.mode===mn||n.mode===ti?256:0),(d===0&&p===0||t===or)&&C===St&&(C=pl),C},kl=e=>{if(Ft(e))return Ge;let t=e.state;return t.window&&(t.window=null),e.state=null,St},Cl=(e,t)=>{if(Ft(e))return Ge;const n=e.state;return(n.wrap&2)===0?Ge:(n.head=t,t.done=!1,St)},Il=(e,t)=>{const n=t.length;let i,r,a;return Ft(e)||(i=e.state,i.wrap!==0&&i.mode!==Un)?Ge:i.mode===Un&&(r=1,r=xi(r,t,n,0),r!==i.check)?$a:(a=no(e,t,n,n),a?(i.mode=Ya,Za):(i.havedict=1,St))};var wl=Qa,El=eo,Ll=Ja,Al=Sl,Pl=to,Dl=Fl,Tl=kl,Ol=Cl,Ml=Il,Rl="pako inflate (from Nodeca project)",nt={inflateReset:wl,inflateReset2:El,inflateResetKeep:Ll,inflateInit:Al,inflateInit2:Pl,inflate:Dl,inflateEnd:Tl,inflateGetHeader:Ol,inflateSetDictionary:Ml,inflateInfo:Rl};function Bl(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var _l=Bl;const io=Object.prototype.toString,{Z_NO_FLUSH:Nl,Z_FINISH:zl,Z_OK:sn,Z_STREAM_END:ai,Z_NEED_DICT:oi,Z_STREAM_ERROR:Gl,Z_DATA_ERROR:Dr,Z_MEM_ERROR:Ul}=Ha;function qn(e){this.options=ja.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15)===0&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new nl,this.strm.avail_out=0;let n=nt.inflateInit2(this.strm,t.windowBits);if(n!==sn)throw new Error(Fi[n]);if(this.header=new _l,nt.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=ki.string2buf(t.dictionary):io.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=nt.inflateSetDictionary(this.strm,t.dictionary),n!==sn)))throw new Error(Fi[n])}qn.prototype.push=function(e,t){const n=this.strm,i=this.options.chunkSize,r=this.options.dictionary;let a,o,s;if(this.ended)return!1;for(t===~~t?o=t:o=t===!0?zl:Nl,io.call(e)==="[object ArrayBuffer]"?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;){for(n.avail_out===0&&(n.output=new Uint8Array(i),n.next_out=0,n.avail_out=i),a=nt.inflate(n,o),a===oi&&r&&(a=nt.inflateSetDictionary(n,r),a===sn?a=nt.inflate(n,o):a===Dr&&(a=oi));n.avail_in>0&&a===ai&&n.state.wrap>0&&e[n.next_in]!==0;)nt.inflateReset(n),a=nt.inflate(n,o);switch(a){case Gl:case Dr:case oi:case Ul:return this.onEnd(a),this.ended=!0,!1}if(s=n.avail_out,n.next_out&&(n.avail_out===0||a===ai))if(this.options.to==="string"){let c=ki.utf8border(n.output,n.next_out),l=n.next_out-c,u=ki.buf2string(n.output,c);n.next_out=l,n.avail_out=i-l,l&&n.output.set(n.output.subarray(c,c+l),0),this.onData(u)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(!(a===sn&&s===0)){if(a===ai)return a=nt.inflateEnd(this.strm),this.onEnd(a),this.ended=!0,!0;if(n.avail_in===0)break}}return!0};qn.prototype.onData=function(e){this.chunks.push(e)};qn.prototype.onEnd=function(e){e===sn&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=ja.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function Vl(e,t){const n=new qn(t);if(n.push(e),n.err)throw n.msg||Fi[n.err];return n.result}var Hl=Vl,jl={inflate:Hl};const{inflate:Wl}=jl;var Xl=Wl,Jt=new Int32Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),bn=4017,yn=799,Sn=3406,xn=2276,Fn=1567,kn=3784,Ct=5793,Cn=2896,ql=100,Tr=64*1024*1024,Ci=0;function Tt(e){var t=Ci+e;if(t>Tr){var n=Math.ceil((t-Tr)/1024/1024);throw new Error("Max memory limit exceeded by at least ".concat(n,"MB"))}Ci=t}function $l(e,t){for(var n=16;n>0&&!e[n-1];)n--;for(var i=[{children:[],index:0}],r=0,a=i[0],o=0;o<n;o++){for(var s=0;s<e[o];s++){for(a=i.pop(),a.children[a.index]=t[r];a.index>0;){if(i.length===0)throw new Error("Could not recreate Huffman Table");a=i.pop()}for(a.index++,i.push(a);i.length<=o;){var c={children:[],index:0};i.push(c),a.children[a.index]=c.children,a=c}r++}if(o+1<n){var c={children:[],index:0};i.push(c),a.children[a.index]=c.children,a=c}}return i[0].children}function Zl(e,t,n,i,r,a,o,s,c){var l=n.mcusPerLine,u=n.progressive,d=t,p=0,f=0;function m(){if(f>0)return f--,p>>f&1;if(p=e[t++],p==255){var J=e[t++];if(J)throw new Error("unexpected marker: ".concat((p<<8|J).toString(16)))}return f=7,p>>>7}function v(J){for(var Z=J;;){if(Z=Z[m()],typeof Z=="number")return Z;if(Z===void 0)throw new Error("invalid huffman sequence")}}function x(J){for(var Z=0;J>0;)Z=Z<<1|m(),J--;return Z}function b(J){var Z=x(J);return Z>=1<<J-1?Z:Z+(-1<<J)+1}function y(J,Z){var ue=v(J.huffmanTableDC),pe=ue===0?0:b(ue);Z[0]=J.pred+=pe;for(var fe=1;fe<64;){var be=v(J.huffmanTableAC),we=be&15,Le=be>>4;if(we===0){if(Le<15)break;fe+=16;continue}fe+=Le;var Je=Jt[fe];Z[Je]=b(we),fe++}}function S(J,Z){var ue=v(J.huffmanTableDC),pe=ue===0?0:b(ue)<<c;Z[0]=J.pred+=pe}function g(J,Z){Z[0]|=m()<<c}var F=0;function w(J,Z){if(F>0){F--;return}for(var ue=a,pe=o;ue<=pe;){var fe=v(J.huffmanTableAC),be=fe&15,we=fe>>4;if(be===0){if(we<15){F=x(we)+(1<<we)-1;break}ue+=16;continue}ue+=we;var Le=Jt[ue];Z[Le]=b(be)*(1<<c),ue++}}var k=0,C=0;function O(J,Z){for(var ue=a,pe=o,fe=0;ue<=pe;){var be=Jt[ue],we=Z[be]<0?-1:1;switch(k){case 0:var Le=v(J.huffmanTableAC),Je=Le&15;if(fe=Le>>4,Je===0)fe<15?(F=x(fe)+(1<<fe),k=4):(fe=16,k=1);else{if(Je!==1)throw new Error("invalid ACn encoding");C=b(Je),k=fe?2:3}continue;case 1:case 2:Z[be]?Z[be]+=(m()<<c)*we:(fe--,fe===0&&(k=k==2?3:0));break;case 3:Z[be]?Z[be]+=(m()<<c)*we:(Z[be]=C<<c,k=0);break;case 4:Z[be]&&(Z[be]+=(m()<<c)*we);break}ue++}k===4&&(F--,F===0&&(k=0))}function P(J,Z,ue,pe,fe){var be=ue/l|0,we=ue%l,Le=be*J.v+pe,Je=we*J.h+fe;J.blocks[Le]!==void 0&&Z(J,J.blocks[Le][Je])}function M(J,Z,ue){var pe=ue/J.blocksPerLine|0,fe=ue%J.blocksPerLine;J.blocks[pe]!==void 0&&Z(J,J.blocks[pe][fe])}var j=i.length,G,W;u?a===0?W=s===0?S:g:W=s===0?w:O:W=y;var q=0,V;j==1?V=i[0].blocksPerLine*i[0].blocksPerColumn:V=l*n.mcusPerColumn,r||(r=V);for(var X,le,he;q<V;){for(var $=0;$<j;$++)i[$].pred=0;if(F=0,j==1){G=i[0];for(var ge=0;ge<r;ge++)M(G,W,q),q++}else for(var ge=0;ge<r;ge++){for(var $=0;$<j;$++){G=i[$],X=G.h,le=G.v;for(var Ue=0;Ue<le;Ue++)for(var ct=0;ct<X;ct++)P(G,W,q,Ue,ct)}if(q++,q===V)break}if(q===V)do{if(e[t]===255&&e[t+1]!==0)break;t+=1}while(t<e.length-2);if(f=0,he=e[t]<<8|e[t+1],he<65280)throw new Error("marker was not found");if(he>=65488&&he<=65495)t+=2;else break}return t-d}function Yl(e){var t=[],n=e.blocksPerLine,i=e.blocksPerColumn,r=n<<3,a=new Int32Array(64),o=new Uint8Array(64);function s(x,b,y){for(var S=e.quantizationTable,g=y,F=0;F<64;F++)g[F]=x[F]*S[F];for(var F=0;F<8;++F){var w=8*F;if(g[1+w]==0&&g[2+w]==0&&g[3+w]==0&&g[4+w]==0&&g[5+w]==0&&g[6+w]==0&&g[7+w]==0){var k=Ct*g[0+w]+512>>10;g[0+w]=k,g[1+w]=k,g[2+w]=k,g[3+w]=k,g[4+w]=k,g[5+w]=k,g[6+w]=k,g[7+w]=k;continue}var C=Ct*g[0+w]+128>>8,O=Ct*g[4+w]+128>>8,P=g[2+w],M=g[6+w],j=Cn*(g[1+w]-g[7+w])+128>>8,G=Cn*(g[1+w]+g[7+w])+128>>8,W=g[3+w]<<4,q=g[5+w]<<4,V=C-O+1>>1;C=C+O+1>>1,O=V,V=P*kn+M*Fn+128>>8,P=P*Fn-M*kn+128>>8,M=V,V=j-q+1>>1,j=j+q+1>>1,q=V,V=G+W+1>>1,W=G-W+1>>1,G=V,V=C-M+1>>1,C=C+M+1>>1,M=V,V=O-P+1>>1,O=O+P+1>>1,P=V,V=j*xn+G*Sn+2048>>12,j=j*Sn-G*xn+2048>>12,G=V,V=W*yn+q*bn+2048>>12,W=W*bn-q*yn+2048>>12,q=V,g[0+w]=C+G,g[7+w]=C-G,g[1+w]=O+q,g[6+w]=O-q,g[2+w]=P+W,g[5+w]=P-W,g[3+w]=M+j,g[4+w]=M-j}for(var F=0;F<8;++F){var X=F;if(g[8+X]==0&&g[16+X]==0&&g[24+X]==0&&g[32+X]==0&&g[40+X]==0&&g[48+X]==0&&g[56+X]==0){var le=Ct*y[F+0]+8192>>14;g[0+X]=le,g[8+X]=le,g[16+X]=le,g[24+X]=le,g[32+X]=le,g[40+X]=le,g[48+X]=le,g[56+X]=le;continue}var C=Ct*g[0+X]+2048>>12,O=Ct*g[32+X]+2048>>12,P=g[16+X],M=g[48+X],j=Cn*(g[8+X]-g[56+X])+2048>>12,G=Cn*(g[8+X]+g[56+X])+2048>>12,W=g[24+X],q=g[40+X],V=C-O+1>>1;C=C+O+1>>1,O=V,V=P*kn+M*Fn+2048>>12,P=P*Fn-M*kn+2048>>12,M=V,V=j-q+1>>1,j=j+q+1>>1,q=V,V=G+W+1>>1,W=G-W+1>>1,G=V,V=C-M+1>>1,C=C+M+1>>1,M=V,V=O-P+1>>1,O=O+P+1>>1,P=V,V=j*xn+G*Sn+2048>>12,j=j*Sn-G*xn+2048>>12,G=V,V=W*yn+q*bn+2048>>12,W=W*bn-q*yn+2048>>12,q=V,g[0+X]=C+G,g[56+X]=C-G,g[8+X]=O+q,g[48+X]=O-q,g[16+X]=P+W,g[40+X]=P-W,g[24+X]=M+j,g[32+X]=M-j}for(var F=0;F<64;++F){var he=128+(g[F]+8>>4);b[F]=he<0?0:he>255?255:he}}Tt(r*i*8);for(var c=0;c<i;c++){for(var l=c<<3,u=0;u<8;u++)t.push(new Uint8Array(r));for(var d=0;d<n;d++){s(e.blocks[c][d],o,a);for(var p=0,f=d<<3,m=0;m<8;m++)for(var v=t[l+m],u=0;u<8;u++)v[f+u]=o[p++]}}return t}function it(e){return e<0?0:e>255?255:e}function Kl(e){var t={width:0,height:0,comments:[],adobe:void 0,components:[],exifBuffer:void 0,jfif:void 0},n=ql*1e3*1e3,i=0;function r(){var ye=e[i]<<8|e[i+1];return i+=2,ye}function a(){var ye=r(),ut=e.subarray(i,i+ye-2);return i+=ut.length,ut}function o(ye){var ut=0,Gt=0;for(var Ut in ye.components)if(ye.components.hasOwnProperty(Ut)){var Be=ye.components[Ut];ut<Be.h&&(ut=Be.h),Gt<Be.v&&(Gt=Be.v)}var Wi=Math.ceil(ye.samplesPerLine/8/ut),Xi=Math.ceil(ye.scanLines/8/Gt);for(var Ut in ye.components)if(ye.components.hasOwnProperty(Ut)){var Be=ye.components[Ut],Is=Math.ceil(Math.ceil(ye.samplesPerLine/8)*Be.h/ut),ws=Math.ceil(Math.ceil(ye.scanLines/8)*Be.v/Gt),qi=Wi*Be.h,$i=Xi*Be.v,Es=$i*qi,Zi=[];Tt(Es*256);for(var Yi=0;Yi<$i;Yi++){for(var Ki=[],Ji=0;Ji<qi;Ji++)Ki.push(new Int32Array(64));Zi.push(Ki)}Be.blocksPerLine=Is,Be.blocksPerColumn=ws,Be.blocks=Zi}ye.maxH=ut,ye.maxV=Gt,ye.mcusPerLine=Wi,ye.mcusPerColumn=Xi}var s=null,c=null,l=void 0,u=0,d=[],p=[],f=[],m=[],v=r(),x=-1;if(v!=65496)throw new Error("SOI not found");for(v=r();v!=65497;){switch(v){case 65280:break;case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:{var b=a();if(v===65534){for(var y="",S=0;S<b.byteLength;S++)y+=String.fromCharCode(b[S]);t.comments.push(y)}v===65504&&b[0]===74&&b[1]===70&&b[2]===73&&b[3]===70&&b[4]===0&&(s={version:{major:b[5],minor:b[6]},densityUnits:b[7],xDensity:b[8]<<8|b[9],yDensity:b[10]<<8|b[11],thumbWidth:b[12],thumbHeight:b[13],thumbData:b.subarray(14,14+3*b[12]*b[13])}),v===65505&&b[0]===69&&b[1]===120&&b[2]===105&&b[3]===102&&b[4]===0&&(t.exifBuffer=b.subarray(5,b.length)),v===65518&&b[0]===65&&b[1]===100&&b[2]===111&&b[3]===98&&b[4]===101&&b[5]===0&&(c={version:b[6],flags0:b[7]<<8|b[8],flags1:b[9]<<8|b[10],transformCode:b[11]});break}case 65499:{for(var g=r(),F=g+i-2;i<F;){var w=e[i++];Tt(256);var k=new Int32Array(64);if(w>>4===0)for(var C=0;C<64;C++){var O=Jt[C];k[O]=e[i++]}else if(w>>4===1)for(var C=0;C<64;C++){var O=Jt[C];k[O]=r()}else throw new Error("DQT: invalid table spec");d[w&15]=k}break}case 65472:case 65473:case 65474:{r(),l={extended:v===65473,progressive:v===65474,precision:e[i++],scanLines:r(),samplesPerLine:r(),components:{},componentsOrder:[],maxH:0,maxV:0,mcusPerLine:0,mcusPerColumn:0};var P=l.scanLines*l.samplesPerLine;if(P>n){var M=Math.ceil((P-n)/1e6);throw new Error("maxResolutionInMP limit exceeded by ".concat(M,"MP"))}for(var j=e[i++],G=0;G<j;G++){var W=e[i],q=e[i+1]>>4,V=e[i+1]&15,X=e[i+2];l.componentsOrder.push(W),l.components[W]={h:q,v:V,quantizationIdx:X,blocksPerColumn:0,blocksPerLine:0,blocks:[],pred:0},i+=3}o(l),p.push(l);break}case 65476:{for(var le=r(),G=2;G<le;){for(var he=e[i++],$=new Uint8Array(16),ge=0,C=0;C<16;C++,i++)ge+=$[C]=e[i];Tt(16+ge);for(var Ue=new Uint8Array(ge),C=0;C<ge;C++,i++)Ue[C]=e[i];G+=17+ge;var ct=he&15,J=he>>4===0?m:f;J[ct]=$l($,Ue)}break}case 65501:r(),u=r();break;case 65500:r(),r();break;case 65498:{r();for(var Z=e[i++],ue=[],G=0;G<Z;G++){var pe=l.components[e[i++]],fe=e[i++];pe.huffmanTableDC=m[fe>>4],pe.huffmanTableAC=f[fe&15],ue.push(pe)}var be=e[i++],we=e[i++],Le=e[i++],Je=Zl(e,i,l,ue,u,be,we,Le>>4,Le&15);i+=Je;break}case 65535:e[i]!==255&&i--;break;default:{if(e[i-3]==255&&e[i-2]>=192&&e[i-2]<=254){i-=3;break}else if(v===224||v==225){if(x!==-1)throw new Error("first unknown JPEG marker at offset ".concat(x.toString(16),", second unknown JPEG marker ").concat(v.toString(16)," at offset ").concat((i-1).toString(16)));x=i-1;var ji=r();if(e[i+ji-2]===255){i+=ji-2;break}}throw new Error("unknown JPEG marker "+v.toString(16))}}v=r()}if(p.length!=1)throw new Error("only single frame JPEGs supported");for(var G=0;G<p.length;G++){var hn=p[G].components;for(var C in hn)hn[C].quantizationTable=d[hn[C].quantizationIdx],delete hn[C].quantizationIdx}t.width=l.samplesPerLine,t.height=l.scanLines,t.jfif=s,t.adobe=c,t.components=[];for(var G=0;G<l.componentsOrder.length;G++){var pe=l.components[l.componentsOrder[G]];t.components.push({lines:Yl(pe),scaleX:pe.h/l.maxH,scaleY:pe.v/l.maxV})}return t}function Jl(e){var t=0,n=!1,i=e.width,r=e.height,a=i*r*e.components.length;Tt(a);var o=new Uint8Array(a);switch(e.components.length){case 1:{for(var s=e.components[0],c=0;c<r;c++)for(var l=s.lines[0|c*s.scaleY],u=0;u<i;u++){var d=l[0|u*s.scaleX];o[t++]=d}break}case 2:{for(var s=e.components[0],p=e.components[1],c=0;c<r;c++)for(var l=s.lines[0|c*s.scaleY],f=p.lines[0|c*p.scaleY],u=0;u<i;u++){var m=l[0|u*s.scaleX];o[t++]=m;var v=f[0|u*p.scaleX];o[t++]=v}break}case 3:{n=!0,e.adobe&&e.adobe.transformCode&&(n=!0);for(var s=e.components[0],p=e.components[1],x=e.components[2],c=0;c<r;c++)for(var l=s.lines[0|c*s.scaleY],f=p.lines[0|c*p.scaleY],b=x.lines[0|c*x.scaleY],u=0;u<i;u++){var d=void 0,y=void 0,S=void 0,g=void 0,F=void 0,w=void 0;n?(d=l[0|u*s.scaleX],y=f[0|u*p.scaleX],S=b[0|u*x.scaleX],g=it(d+1.402*(S-128)),F=it(d-.3441363*(y-128)-.71413636*(S-128)),w=it(d+1.772*(y-128))):(g=l[0|u*s.scaleX],F=f[0|u*p.scaleX],w=b[0|u*x.scaleX]),o[t++]=g,o[t++]=F,o[t++]=w}break}case 4:{if(!e.adobe)throw new Error("Unsupported color mode (4 components)");n=!1,e.adobe&&e.adobe.transformCode&&(n=!0);for(var s=e.components[0],p=e.components[1],x=e.components[2],k=e.components[3],c=0;c<r;c++)for(var l=s.lines[0|c*s.scaleY],f=p.lines[0|c*p.scaleY],b=x.lines[0|c*x.scaleY],C=k.lines[0|c*k.scaleY],u=0;u<i;u++){var d=void 0,y=void 0,S=void 0,O=void 0,P=void 0,M=void 0,j=void 0;n?(d=l[0|u*s.scaleX],y=f[0|u*p.scaleX],S=b[0|u*x.scaleX],O=C[0|u*k.scaleX],P=255-it(d+1.402*(S-128)),M=255-it(d-.3441363*(y-128)-.71413636*(S-128)),j=255-it(d+1.772*(y-128))):(P=l[0|u*s.scaleX],M=f[0|u*p.scaleX],j=b[0|u*x.scaleX],O=C[0|u*k.scaleX]),o[t++]=255-P,o[t++]=255-M,o[t++]=255-j,o[t++]=255-O}break}default:throw new Error("Unsupported color mode")}return o}function Ql(e,t){if(Ci=0,e.length===0)throw new Error("Empty jpeg buffer");var n=Kl(e);Tt(n.width*n.height*4);var i=Jl(n),r=t(n.width,n.height),a=r.width,o=r.height,s=r.data,c=0,l=0;switch(n.components.length){case 1:for(var u=0;u<o;u++)for(var d=0;d<a;d++){var p=i[c++];s[l++]=p,s[l++]=p,s[l++]=p,s[l++]=255}break;case 3:for(var u=0;u<o;u++)for(var d=0;d<a;d++){var f=i[c++],m=i[c++],v=i[c++];s[l++]=f,s[l++]=m,s[l++]=v,s[l++]=255}break;case 4:for(var u=0;u<o;u++)for(var d=0;d<a;d++){var x=i[c++],b=i[c++],p=i[c++],y=i[c++],f=255-it(x*(1-y/255)+y),m=255-it(b*(1-y/255)+y),v=255-it(p*(1-y/255)+y);s[l++]=f,s[l++]=m,s[l++]=v,s[l++]=255}break;default:throw new Error("Unsupported color mode")}return r}var ro={},Rt={pass:"pass through",norm:"normal",diss:"dissolve",dark:"darken","mul ":"multiply",idiv:"color burn",lbrn:"linear burn",dkCl:"darker color",lite:"lighten",scrn:"screen","div ":"color dodge",lddg:"linear dodge",lgCl:"lighter color",over:"overlay",sLit:"soft light",hLit:"hard light",vLit:"vivid light",lLit:"linear light",pLit:"pin light",hMix:"hard mix",diff:"difference",smud:"exclusion",fsub:"subtract",fdiv:"divide","hue ":"hue","sat ":"saturation",colr:"color","lum ":"luminosity"};Object.keys(Rt).forEach(function(e){return ro[Rt[e]]=e});var Or=["none","red","orange","yellow","green","blue","violet","gray"],ec=["LMsk","Lr16","Lr32","Layr","Mt16","Mt32","Mtrn","Alph","FMsk","lnk2","FEid","FXid","PxSD","cinf"];function tc(e){var t={};return Object.keys(e).forEach(function(n){return t[e[n]]=n}),t}function z(e,t,n){var i=tc(n),r=function(o){var s=o.split(".")[1];if(s&&!i[s])throw new Error("Unrecognized value for enum: '".concat(o,"'"));return i[s]||t},a=function(o){if(o&&!n[o])throw new Error("Invalid value for enum: '".concat(o,"'"));return"".concat(e,".").concat(n[o]||n[t])};return{decode:r,encode:a}}var Mr;(function(e){e[e.RGB=0]="RGB",e[e.HSB=1]="HSB",e[e.CMYK=2]="CMYK",e[e.Lab=7]="Lab",e[e.Grayscale=8]="Grayscale"})(Mr||(Mr={}));var Rr;(function(e){e[e.PositionRelativeToLayer=1]="PositionRelativeToLayer",e[e.LayerMaskDisabled=2]="LayerMaskDisabled",e[e.InvertLayerMaskWhenBlending=4]="InvertLayerMaskWhenBlending",e[e.LayerMaskFromRenderingOtherData=8]="LayerMaskFromRenderingOtherData",e[e.MaskHasParametersAppliedToIt=16]="MaskHasParametersAppliedToIt"})(Rr||(Rr={}));var Br;(function(e){e[e.UserMaskDensity=1]="UserMaskDensity",e[e.UserMaskFeather=2]="UserMaskFeather",e[e.VectorMaskDensity=4]="VectorMaskDensity",e[e.VectorMaskFeather=8]="VectorMaskFeather"})(Br||(Br={}));var _r;(function(e){e[e.Color0=0]="Color0",e[e.Color1=1]="Color1",e[e.Color2=2]="Color2",e[e.Color3=3]="Color3",e[e.Transparency=-1]="Transparency",e[e.UserMask=-2]="UserMask",e[e.RealUserMask=-3]="RealUserMask"})(_r||(_r={}));var Nr;(function(e){e[e.RawData=0]="RawData",e[e.RleCompressed=1]="RleCompressed",e[e.ZipWithoutPrediction=2]="ZipWithoutPrediction",e[e.ZipWithPrediction=3]="ZipWithPrediction"})(Nr||(Nr={}));function nc(e,t){switch(e){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return t?3:e+1;case-1:return t?4:3;default:return e+1}}function ao(e,t,n){return e<t?t:e>n?n:e}function Ii(e){for(var t=e.data,n=t instanceof Float32Array?1:t instanceof Uint16Array?65535:255,i=0,r=t.length|0;i<r;i=i+4|0)t[i+0]=0,t[i+1]=0,t[i+2]=0,t[i+3]=n}function wi(e){var t=$n(e.width,e.height),n;if(e.data instanceof Uint8ClampedArray)n=e;else{n=Mi(e.width,e.height);var i=e.data,r=n.data;if(i instanceof Float32Array)for(var a=0,o=i.length;a<o;a+=4)r[a+0]=Math.round(Math.pow(i[a+0],1/2.2)*255),r[a+1]=Math.round(Math.pow(i[a+1],1/2.2)*255),r[a+2]=Math.round(Math.pow(i[a+2],1/2.2)*255),r[a+3]=Math.round(i[a+3]*255);else for(var s=i instanceof Uint16Array?8:0,a=0,o=i.length;a<o;a++)r[a]=i[a]>>>s}return t.getContext("2d").putImageData(n,0,0),t}function ic(e,t,n,i){if(!(e instanceof Uint8Array||e instanceof Uint8ClampedArray))throw new Error("Invalid bit depth");for(var r=0,a=0,o=0;r<i;r++)for(var s=0;s<n;)for(var c=e[o++],l=0;l<8&&s<n;l++,s++,a+=4){var u=c&128?0:255;c=c<<1,t[a+0]=u,t[a+1]=u,t[a+2]=u,t[a+3]=255}}function rc(e){var t=$n(100,100);try{var n=t.getContext("2d"),i=Ql(e,function(r,a){return n.createImageData(r,a)});t.width=i.width,t.height=i.height,n.putImageData(i,0,0)}catch(r){console.error("JPEG decompression error",r.message)}return t}var $n=function(){throw new Error("Canvas not initialized, use initializeCanvas method to set up createCanvas method")},si=void 0,Mi=function(e,t){return si||(si=$n(1,1)),si.getContext("2d").createImageData(e,t)};typeof document<"u"&&($n=function(e,t){var n=document.createElement("canvas");return n.width=e,n.height=t,n});var Vt={},zr;function ac(){if(zr)return Vt;zr=1,Vt.byteLength=s,Vt.toByteArray=l,Vt.fromByteArray=p;for(var e=[],t=[],n=typeof Uint8Array<"u"?Uint8Array:Array,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=0,a=i.length;r<a;++r)e[r]=i[r],t[i.charCodeAt(r)]=r;t[45]=62,t[95]=63;function o(f){var m=f.length;if(m%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var v=f.indexOf("=");v===-1&&(v=m);var x=v===m?0:4-v%4;return[v,x]}function s(f){var m=o(f),v=m[0],x=m[1];return(v+x)*3/4-x}function c(f,m,v){return(m+v)*3/4-v}function l(f){var m,v=o(f),x=v[0],b=v[1],y=new n(c(f,x,b)),S=0,g=b>0?x-4:x,F;for(F=0;F<g;F+=4)m=t[f.charCodeAt(F)]<<18|t[f.charCodeAt(F+1)]<<12|t[f.charCodeAt(F+2)]<<6|t[f.charCodeAt(F+3)],y[S++]=m>>16&255,y[S++]=m>>8&255,y[S++]=m&255;return b===2&&(m=t[f.charCodeAt(F)]<<2|t[f.charCodeAt(F+1)]>>4,y[S++]=m&255),b===1&&(m=t[f.charCodeAt(F)]<<10|t[f.charCodeAt(F+1)]<<4|t[f.charCodeAt(F+2)]>>2,y[S++]=m>>8&255,y[S++]=m&255),y}function u(f){return e[f>>18&63]+e[f>>12&63]+e[f>>6&63]+e[f&63]}function d(f,m,v){for(var x,b=[],y=m;y<v;y+=3)x=(f[y]<<16&16711680)+(f[y+1]<<8&65280)+(f[y+2]&255),b.push(u(x));return b.join("")}function p(f){for(var m,v=f.length,x=v%3,b=[],y=16383,S=0,g=v-x;S<g;S+=y)b.push(d(f,S,S+y>g?g:S+y));return x===1?(m=f[v-1],b.push(e[m>>2]+e[m<<4&63]+"==")):x===2&&(m=(f[v-2]<<8)+f[v-1],b.push(e[m>>10]+e[m>>4&63]+e[m<<2&63]+"=")),b.join("")}return Vt}var Ei=ac();function Li(e){return(e&4294967168)===0?1:(e&4294965248)===0?2:(e&4294901760)===0?3:4}function oc(e){for(var t=0,n=0;n<e.length;n++){var i=e.charCodeAt(n);if(i>=55296&&i<=56319){if(n+1<e.length){var r=e.charCodeAt(n+1);(r&64512)===56320&&(n++,t+=Li(((i&1023)<<10)+(r&1023)+65536))}}else t+=Li(i)}return t}function Gr(e,t,n){var i=Li(n);switch(i){case 1:e[t]=n;break;case 2:e[t]=n>>6&31|192,e[t+1]=n&63|128;break;case 3:e[t]=n>>12&15|224,e[t+1]=n>>6&63|128,e[t+2]=n&63|128;break;default:e[t]=n>>18&7|240,e[t+1]=n>>12&63|128,e[t+2]=n>>6&63|128,e[t+3]=n&63|128;break}return i}function sc(e,t,n){for(var i=0;i<n.length;i++){var r=n.charCodeAt(i);if(r>=55296&&r<=56319){if(i+1<n.length){var a=n.charCodeAt(i+1);if((a&64512)===56320){i++;var o=((r&1023)<<10)+(a&1023)+65536;t+=Gr(e,t,o)}}}else t+=Gr(e,t,r)}return t}function oo(e){if(e.length>1e3&&typeof TextEncoder<"u")return new TextEncoder().encode(e);var t=new Uint8Array(oc(e));return sc(t,0,e),t}function It(e,t){if(t>=e.length)throw Error("Invalid byte index");var n=e[t];if((n&192)===128)return n&63;throw Error("Invalid continuation byte")}function so(e){if(e.byteLength>1e3&&typeof TextDecoder<"u")return new TextDecoder().decode(e);for(var t=[],n=0;n<e.length;){var i=e[n++],r=void 0;if((i&128)===0)r=i;else if((i&224)===192){var a=It(e,n++);if(r=(i&31)<<6|a,r<128)throw Error("Invalid continuation byte")}else if((i&240)===224){var a=It(e,n++),o=It(e,n++);if(r=(i&15)<<12|a<<6|o,r<2048)throw Error("Invalid continuation byte");if(r>=55296&&r<=57343)throw Error("Lone surrogate U+".concat(r.toString(16).toUpperCase()," is not a scalar value"))}else if((i&248)===240){var a=It(e,n++),o=It(e,n++),s=It(e,n++);if(r=(i&15)<<18|a<<12|o<<6|s,r<65536||r>1114111)throw Error("Invalid continuation byte")}else throw Error("Invalid UTF-8 detected");r>65535&&(r-=65536,t.push(String.fromCharCode(r>>>10&1023|55296)),r=56320|r&1023),t.push(String.fromCharCode(r))}return t.join("")}var rt=function(){return rt=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},rt.apply(this,arguments)},lc=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function cc(e){var t={};return Object.keys(e).forEach(function(n){return t[e[n]]=n}),t}var $t={"#Ang":"Angle","#Rsl":"Density","#Rlt":"Distance","#Nne":"None","#Prc":"Percent","#Pxl":"Pixels","#Mlm":"Millimeters","#Pnt":"Points",RrPi:"Picas",RrIn:"Inches",RrCm:"Centimeters"},In=cc($t);function A(e,t){return{name:e,classID:t}}var ee=A("","null"),lo={strokeStyleContent:A("","solidColorLayer"),printProofSetup:A("Proof Setup","proofSetup"),Grad:A("Gradient","Grdn"),Trnf:A("Transform","Trnf"),patternFill:A("","patternFill"),ebbl:A("","ebbl"),SoFi:A("","SoFi"),GrFl:A("","GrFl"),sdwC:A("","RGBC"),hglC:A("","RGBC"),"Clr ":A("","RGBC"),tintColor:A("","RGBC"),Ofst:A("","Pnt "),ChFX:A("","ChFX"),MpgS:A("","ShpC"),DrSh:A("","DrSh"),IrSh:A("","IrSh"),OrGl:A("","OrGl"),IrGl:A("","IrGl"),TrnS:A("","ShpC"),Ptrn:A("","Ptrn"),FrFX:A("","FrFX"),phase:A("","Pnt "),frameStep:ee,duration:ee,workInTime:ee,workOutTime:ee,audioClipGroupList:ee,bounds:A("","Rctn"),customEnvelopeWarp:A("","customEnvelopeWarp"),warp:A("","warp"),"Sz  ":A("","Pnt "),origin:A("","Pnt "),autoExpandOffset:A("","Pnt "),keyOriginShapeBBox:A("","unitRect"),Vrsn:ee,psVersion:ee,docDefaultNewArtboardBackgroundColor:A("","RGBC"),artboardRect:A("","classFloatRect"),keyOriginRRectRadii:A("","radii"),keyOriginBoxCorners:ee,rectangleCornerA:A("","Pnt "),rectangleCornerB:A("","Pnt "),rectangleCornerC:A("","Pnt "),rectangleCornerD:A("","Pnt "),compInfo:ee,quiltWarp:A("","quiltWarp"),generatorSettings:ee,crema:ee,FrIn:ee,blendOptions:ee,FXRf:ee,Lefx:ee,time:ee,animKey:ee,timeScope:ee,inTime:ee,outTime:ee,sheetStyle:ee,translation:ee,Skew:ee,boundingBox:A("","boundingBox"),"Lnk ":A("","ExternalFileLink"),frameReader:A("","FrameReader"),effectParams:A("","motionTrackEffectParams"),Impr:A("None","none"),Anch:A("","Pnt "),"Fwd ":A("","Pnt "),"Bwd ":A("","Pnt "),FlrC:A("","Pnt "),meshBoundaryPath:A("","pathClass"),filterFX:A("","filterFXStyle"),Fltr:A("","rigidTransform"),FrgC:A("","RGBC"),BckC:A("","RGBC"),sdwM:A("Parameters","adaptCorrectTones"),hglM:A("Parameters","adaptCorrectTones"),customShape:A("","customShape"),origFXRefPoint:ee,FXRefPoint:ee,ClMg:A("","ClMg")},co={"Crv ":A("","CrPt"),Clrs:A("","Clrt"),Trns:A("","TrnS"),keyDescriptorList:ee,solidFillMulti:A("","SoFi"),gradientFillMulti:A("","GrFl"),dropShadowMulti:A("","DrSh"),innerShadowMulti:A("","IrSh"),frameFXMulti:A("","FrFX"),FrIn:ee,FSts:ee,LaSt:ee,sheetTimelineOptions:ee,trackList:A("","animationTrack"),globalTrackList:A("","animationTrack"),keyList:ee,audioClipGroupList:ee,audioClipList:ee,countObjectList:A("","countObject"),countGroupList:A("","countGroup"),slices:A("","slice"),"Pts ":A("","Pthp"),SbpL:A("","SbpL"),pathComponents:A("","PaCm"),filterFXList:A("","filterFX"),puppetShapeList:A("","puppetShape"),channelDenoise:A("","channelDenoiseParams"),ShrP:A("","Pnt "),layerSettings:ee,list:ee,Adjs:A("","CrvA")},Ur={TEXT:["Txt ","printerName","Nm  ","Idnt","blackAndWhitePresetFileName","LUT3DFileName","presetFileName","curvesPresetFileName","mixerPresetFileName","placed","description","reason","artboardPresetName","json","clipID","relPath","fullPath","mediaDescriptor","Msge","altTag","url","cellText","preset","KnNm","FPth","comment","originalPath"],tdta:["EngineData","LUT3DFileData","indexArray","originalVertexArray","deformedVertexArray","LqMe"],long:["TextIndex","RndS","Mdpn","Smth","Lctn","strokeStyleVersion","LaID","Vrsn","Cnt ","Brgh","Cntr","means","vibrance","Strt","bwPresetKind","comp","compID","originalCompID","curvesPresetKind","mixerPresetKind","uOrder","vOrder","PgNm","totalPages","Crop","numerator","denominator","frameCount","Annt","keyOriginType","unitValueQuadVersion","keyOriginIndex","major","minor","fix","docDefaultNewArtboardBackgroundType","artboardBackgroundType","numModifyingFX","deformNumRows","deformNumCols","FrID","FrDl","FsID","LCnt","AFrm","AFSt","numBefore","numAfter","Spcn","minOpacity","maxOpacity","BlnM","sheetID","gblA","globalAltitude","descVersion","frameReaderType","LyrI","zoomOrigin","fontSize","Rds ","sliceID","topOutset","leftOutset","bottomOutset","rightOutset","filterID","meshQuality","meshExpansion","meshRigidity","VrsM","VrsN","NmbG","WLMn","WLMx","AmMn","AmMx","SclH","SclV","Lvl ","TlNm","TlOf","FlRs","Thsh","ShrS","ShrE","FlRs","Vrnc","Strg","ExtS","ExtD","HrzS","VrtS","NmbR","EdgF","Ang1","Ang2","Ang3","Ang4","lastAppliedComp","capturedInfo"],enum:["textGridding","Ornt","warpStyle","warpRotate","Inte","Bltn","ClrS","BlrQ","bvlT","bvlS","bvlD","Md  ","glwS","GrdF","GlwT","RplS","BlrM","SmBM","strokeStyleLineCapType","strokeStyleLineJoinType","strokeStyleLineAlignment","strokeStyleBlendMode","PntT","Styl","lookupType","LUTFormat","dataOrder","tableOrder","enableCompCore","enableCompCoreGPU","compCoreSupport","compCoreGPUSupport","Engn","enableCompCoreThreads","gs99","FrDs","trackID","animInterpStyle","horzAlign","vertAlign","bgColorType","shapeOperation","UndA","Wvtp","Drct","WndM","Edg ","FlCl","IntE","IntC","Cnvr","Fl  ","Dstr","MztT","Lns ","ExtT","DspM","ExtR","ZZTy","SphM","SmBQ","placedLayerOCIOConversion","gradientsInterpolationMethod"],bool:["PstS","printSixteenBit","masterFXSwitch","enab","uglg","antialiasGloss","useShape","useTexture","uglg","antialiasGloss","useShape","Vsbl","useTexture","Algn","Rvrs","Dthr","Invr","VctC","ShTr","layerConceals","strokeEnabled","fillEnabled","strokeStyleScaleLock","strokeStyleStrokeAdjust","hardProof","MpBl","paperWhite","useLegacy","Auto","Lab ","useTint","keyShapeInvalidated","autoExpandEnabled","autoNestEnabled","autoPositionEnabled","shrinkwrapOnSaveEnabled","present","showInDialog","overprint","sheetDisclosed","lightsDisclosed","meshesDisclosed","materialsDisclosed","hasMotion","muted","Effc","selected","autoScope","fillCanvas","cellTextIsHTML","Smoo","Clsp","validAtPosition","rigidType","hasoptions","filterMaskEnable","filterMaskLinked","filterMaskExtendWithWhite","removeJPEGArtifact","Mnch","ExtF","ExtM","moreAccurate","GpuY","LIWy","Cnty"],doub:["warpValue","warpPerspective","warpPerspectiveOther","Intr","Wdth","Hght","strokeStyleMiterLimit","strokeStyleResolution","layerTime","keyOriginResolution","xx","xy","yx","yy","tx","ty","FrGA","frameRate","audioLevel","rotation","X   ","Y   ","redFloat","greenFloat","blueFloat","imageResolution","PuX0","PuX1","PuX2","PuX3","PuY0","PuY1","PuY2","PuY3"],UntF:["sdwO","hglO","lagl","Lald","srgR","blur","Sftn","Opct","Dstn","Angl","Ckmt","Nose","Inpr","ShdN","strokeStyleLineWidth","strokeStyleLineDashOffset","strokeStyleOpacity","H   ","Top ","Left","Btom","Rght","Rslt","topRight","topLeft","bottomLeft","bottomRight","ClNs","Shrp"],VlLs:["Crv ","Clrs","Mnm ","Mxm ","Trns","pathList","strokeStyleLineDashSet","FrLs","slices","LaSt","Trnf","nonAffineTransform","keyDescriptorList","guideIndeces","gradientFillMulti","solidFillMulti","frameFXMulti","innerShadowMulti","dropShadowMulti","FrIn","FSts","FsFr","sheetTimelineOptions","audioClipList","trackList","globalTrackList","keyList","audioClipList","warpValues","selectedPin","Pts ","SbpL","pathComponents","pinOffsets","posFinalPins","pinVertexIndices","PinP","PnRt","PnOv","PnDp","filterFXList","puppetShapeList","ShrP","channelDenoise","Mtrx","layerSettings","list","compList","Adjs"],ObAr:["meshPoints","quiltSliceX","quiltSliceY"],"obj ":["null","Chnl"],"Pth ":["DspF"]},uc=["Rd  ","Grn ","Bl  ","Yllw","Ylw ","Cyn ","Mgnt","Blck","Gry ","Lmnc","A   ","B   "],uo={"Mnm ":"long","Mxm ":"long",FrLs:"long",strokeStyleLineDashSet:"UntF",Trnf:"doub",nonAffineTransform:"doub",keyDescriptorList:"Objc",gradientFillMulti:"Objc",solidFillMulti:"Objc",frameFXMulti:"Objc",innerShadowMulti:"Objc",dropShadowMulti:"Objc",LaSt:"Objc",FrIn:"Objc",FSts:"Objc",FsFr:"long",blendOptions:"Objc",sheetTimelineOptions:"Objc",keyList:"Objc",warpValues:"doub",selectedPin:"long","Pts ":"Objc",SbpL:"Objc",pathComponents:"Objc",pinOffsets:"doub",posFinalPins:"doub",pinVertexIndices:"long",PinP:"doub",PnRt:"long",PnOv:"bool",PnDp:"doub",filterFXList:"Objc",puppetShapeList:"Objc",ShrP:"Objc",channelDenoise:"Objc",Mtrx:"long",compList:"long",Chnl:"enum"},Vn={};for(var li=0,Vr=Object.keys(Ur);li<Vr.length;li++)for(var Hr=Vr[li],ci=0,jr=Ur[Hr];ci<jr.length;ci++){var Bt=jr[ci];Vn[Bt]=Hr}for(var ui=0,Wr=Object.keys(lo);ui<Wr.length;ui++){var Bt=Wr[ui];Vn[Bt]||(Vn[Bt]="Objc")}for(var fi=0,Xr=Object.keys(co);fi<Xr.length;fi++){var Bt=Xr[fi];uo[Bt]="Objc"}function fc(e,t,n,i){return e==="presetKind"?typeof t=="string"?"enum":"long":e==="null"&&n==="slices"?"TEXT":e==="groupID"?n==="slices"?"long":"TEXT":e==="Sz  "?"Wdth"in t?"Objc":"units"in t?"UntF":"doub":e==="Type"?typeof t=="string"?"enum":"long":e==="AntA"?typeof t=="string"?"enum":"bool":(e==="Hrzn"||e==="Vrtc")&&(i.Type==="keyType.Pstn"||i._classID==="Ofst")?"long":e==="Hrzn"||e==="Vrtc"||e==="Top "||e==="Left"||e==="Btom"||e==="Rght"?n==="slices"?"long":typeof t=="number"?"doub":"UntF":e==="Vrsn"?typeof t=="number"?"long":"Objc":e==="Rd  "||e==="Grn "||e==="Bl  "?n==="artd"?"long":"doub":e==="Trnf"?Array.isArray(t)?"VlLs":"Objc":Vn[e]}function at(e){var t=_(e);return Kn(e,t||4)}function ot(e,t){if(t.length===4&&t!=="warp"&&t!=="time"&&t!=="hold"&&t!=="list")H(e,0),U(e,t);else{H(e,t.length);for(var n=0;n<t.length;n++)B(e,t.charCodeAt(n))}}function fo(e,t){for(var n=bt(e),i=t?{_name:n.name,_classID:n.classID}:{},r=L(e),a=0;a<r;a++){var o=at(e),s=se(e),c=po(e,s,t);i[o]=c}return i}function ho(e,t,n,i,r){xt(e,t),ot(e,n);var a=Object.keys(i),o=a.length;"_name"in i&&o--,"_classID"in i&&o--,D(e,o);for(var s=0,c=a;s<c.length;s++){var l=c[s];if(!(l==="_name"||l==="_classID")){var u=fc(l,i[l],r,i),d=lo[l];l==="bounds"&&r==="text"?d=A("","bounds"):l==="origin"?u=r==="slices"?"enum":"Objc":(l==="Cyn "||l==="Mgnt"||l==="Ylw "||l==="Blck")&&i._classID==="CMYC"?u="doub":/^PN[a-z][a-z]$/.test(l)?u="TEXT":/^PT[a-z][a-z]$/.test(l)?u="long":/^PF[a-z][a-z]$/.test(l)||(l==="Rds "||l==="Thsh")&&typeof i[l]=="number"&&i._classID==="SmrB"?u="doub":l==="ClSz"||l==="Rds "||l==="Amnt"?u=typeof i[l]=="number"?"long":"UntF":(l==="sdwM"||l==="hglM")&&typeof i[l]=="string"||l==="blur"&&typeof i[l]=="string"?u="enum":l==="Hght"&&typeof i[l]=="number"&&i._classID==="Embs"||l==="Angl"&&typeof i[l]=="number"&&(i._classID==="Embs"||i._classID==="smartSharpen"||i._classID==="Twrl"||i._classID==="MtnB")?u="long":l==="Angl"&&typeof i[l]=="number"?u="doub":l==="bounds"&&r==="slices"?(u="Objc",d=A("","Rct1")):l==="Scl "?typeof i[l]=="object"&&"Hrzn"in i[l]?(u="Objc",d=ee):typeof i[l]=="number"?u="long":u="UntF":l==="audioClipGroupList"&&a.length===1?u="VlLs":(l==="Strt"||l==="Brgh")&&"H   "in i?u="doub":l==="Wdth"&&typeof i[l]=="object"?u="UntF":l==="Ofst"&&typeof i[l]=="number"?u="long":l==="Strt"&&typeof i[l]=="object"?(u="Objc",d=ee):uc.indexOf(l)!==-1?u=n==="RGBC"&&r!=="artd"?"doub":"long":l==="profile"?u=n==="printOutput"?"TEXT":"tdta":l==="strokeStyleContent"?i[l]["Clr "]?d=A("","solidColorLayer"):i[l].Grad?d=A("","gradientLayer"):i[l].Ptrn&&(d=A("","patternLayer")):l==="bounds"&&r==="quiltWarp"&&(d=A("","classFloatRect")),d&&d.classID==="RGBC"&&"H   "in i[l]&&(d={classID:"HSBC",name:""}),ot(e,l),U(e,u||"long"),vo(e,u||"long",i[l],l,d,r)}}}function po(e,t,n){switch(t){case"obj ":return hc(e);case"Objc":case"GlbO":return fo(e,n);case"VlLs":{for(var i=_(e),r=[],a=0;a<i;a++){var o=se(e);r.push(po(e,o,n))}return r}case"doub":return ze(e);case"UntF":{var s=se(e),c=ze(e);if(!$t[s])throw new Error("Invalid units: ".concat(s));return{units:$t[s],value:c}}case"UnFl":{var s=se(e),c=We(e);if(!$t[s])throw new Error("Invalid units: ".concat(s));return{units:$t[s],value:c}}case"TEXT":return ke(e);case"enum":{var l=at(e),c=at(e);return"".concat(l,".").concat(c)}case"long":return _(e);case"comp":{var u=L(e),d=L(e);return{low:u,high:d}}case"bool":return!!T(e);case"type":case"GlbC":return bt(e);case"alis":{var p=_(e);return Kn(e,p)}case"tdta":{var f=_(e);return Ce(e,f)}case"ObAr":{_(e),ke(e),at(e);for(var m=_(e),r=[],a=0;a<m;a++){var v=at(e);se(e),se(e);for(var x=_(e),b=[],y=0;y<x;y++)b.push(ze(e));r.push({type:v,values:b})}return r}case"Pth ":{_(e);var S=se(e);Sa(e);var g=Sa(e),F=Cc(e,g);return{sig:S,path:F}}default:throw new Error("Invalid TySh descriptor OSType: ".concat(t," at ").concat(e.offset.toString(16)))}}var dc={meshPoints:"rationalPoint",quiltSliceX:"UntF",quiltSliceY:"UntF"};function vo(e,t,n,i,r,a){switch(t){case"obj ":pc(e,i,n);break;case"Objc":case"GlbO":{if(typeof n!="object")throw new Error("Invalid struct value: ".concat(JSON.stringify(n),", key: ").concat(i));if(!r)throw new Error("Missing ext type for: '".concat(i,"' (").concat(JSON.stringify(n),")"));var o=n._name||r.name,s=n._classID||r.classID;ho(e,o,s,n,a);break}case"VlLs":if(!Array.isArray(n))throw new Error("Invalid list value: ".concat(JSON.stringify(n),", key: ").concat(i));H(e,n.length);for(var c=0;c<n.length;c++){var l=uo[i];U(e,l||"long"),vo(e,l||"long",n[c],"".concat(i,"[]"),co[i],a)}break;case"doub":if(typeof n!="number")throw new Error("Invalid number value: ".concat(JSON.stringify(n),", key: ").concat(i));Ke(e,n);break;case"UntF":if(!In[n.units])throw new Error("Invalid units: ".concat(n.units," in ").concat(i));U(e,In[n.units]),Ke(e,n.value);break;case"UnFl":if(!In[n.units])throw new Error("Invalid units: ".concat(n.units," in ").concat(i));U(e,In[n.units]),Xe(e,n.value);break;case"TEXT":xt(e,n);break;case"enum":{if(typeof n!="string")throw new Error("Invalid enum value: ".concat(JSON.stringify(n),", key: ").concat(i));var u=n.split("."),d=u[0],p=u[1];ot(e,d),ot(e,p);break}case"long":if(typeof n!="number")throw new Error("Invalid integer value: ".concat(JSON.stringify(n),", key: ").concat(i));H(e,n);break;case"bool":if(typeof n!="boolean")throw new Error("Invalid boolean value: ".concat(JSON.stringify(n),", key: ").concat(i));B(e,n?1:0);break;case"tdta":H(e,n.byteLength),st(e,n);break;case"ObAr":{H(e,16),xt(e,"");var f=dc[i];if(!f)throw new Error("Not implemented ObArType for: ".concat(i));ot(e,f),H(e,n.length);for(var c=0;c<n.length;c++){ot(e,n[c].type),U(e,"UnFl"),U(e,"#Pxl"),H(e,n[c].values.length);for(var m=0;m<n[c].values.length;m++)Ke(e,n[c].values[m])}break}case"Pth ":{var v=12+n.path.length*2;H(e,v),U(e,n.sig),Ba(e,v),Ba(e,n.path.length),uu(e,n.path);break}default:throw new Error("Not implemented descriptor OSType: ".concat(t))}}function hc(e){for(var t=_(e),n=[],i=0;i<t;i++){var r=se(e);switch(r){case"prop":{bt(e);var a=at(e);n.push(a);break}case"Clss":n.push(bt(e));break;case"Enmr":{bt(e);var o=at(e),s=at(e);n.push("".concat(o,".").concat(s));break}case"rele":{bt(e),n.push(L(e));break}case"Idnt":n.push(_(e));break;case"indx":n.push(_(e));break;case"name":{bt(e),n.push(ke(e));break}default:throw new Error("Invalid descriptor reference type: ".concat(r))}}return n}function pc(e,t,n){H(e,n.length);for(var i=0;i<n.length;i++){var r=n[i],a="unknown";switch(typeof r=="string"&&(/^[a-z ]+\.[a-z ]+$/i.test(r)?a="Enmr":a="name"),U(e,a),a){case"Enmr":{var o=r.split("."),s=o[0],c=o[1];qr(e,"\0",s),ot(e,s),ot(e,c);break}case"name":{qr(e,"\0","Lyr "),Me(e,r+"\0");break}default:throw new Error("Invalid descriptor reference type: ".concat(a))}}return n}function bt(e){var t=ke(e),n=at(e);return{name:t,classID:n}}function qr(e,t,n){Me(e,t),ot(e,n)}function Y(e,t){t===void 0&&(t=!1);var n=L(e);if(n!==16)throw new Error("Invalid descriptor version: ".concat(n));var i=fo(e,t);return i}function K(e,t,n,i,r){r===void 0&&(r=""),D(e,16),ho(e,t,n,i,r)}function Qt(e){return{x:e.Hrzn,y:e.Vrtc}}function en(e){return{Hrzn:e.x,Vrtc:e.y}}function $r(e){return{top:ie(e["Top "]),left:ie(e.Left),right:ie(e.Rght),bottom:ie(e.Btom)}}function Zr(e){var t;return t={Left:ce(e.left,"bounds.left")},t["Top "]=ce(e.top,"bounds.top"),t.Rght=ce(e.right,"bounds.right"),t.Btom=ce(e.bottom,"bounds.bottom"),t}function Yr(e){var t={enabled:!!e.enab,position:Yn.decode(e.Styl),fillType:Do.decode(e.PntT),blendMode:Ne.decode(e["Md  "]),opacity:oe(e.Opct),size:ie(e["Sz  "])};return e.present!==void 0&&(t.present=e.present),e.showInDialog!==void 0&&(t.showInDialog=e.showInDialog),e.overprint!==void 0&&(t.overprint=e.overprint),e["Clr "]&&(t.color=qe(e["Clr "])),e.Grad&&(t.gradient=So(e)),e.Ptrn&&(t.pattern=xo(e)),t}function Kr(e){var t={};return t.enab=!!e.enabled,e.present!==void 0&&(t.present=!!e.present),e.showInDialog!==void 0&&(t.showInDialog=!!e.showInDialog),t.Styl=Yn.encode(e.position),t.PntT=Do.encode(e.fillType),t["Md  "]=Ne.encode(e.blendMode),t.Opct=xe(e.opacity),t["Sz  "]=ce(e.size,"size"),e.color&&(t["Clr "]=$e(e.color)),e.gradient&&(t=rt(rt({},t),Fo(e.gradient))),e.pattern&&(t=rt(rt({},t),ko(e.pattern))),e.overprint!==void 0&&(t.overprint=!!e.overprint),t}function cn(e,t,n){for(var i,r,a,o=n?{"Scl ":_e((i=e.scale)!==null&&i!==void 0?i:1),masterFXSwitch:!e.disabled}:{masterFXSwitch:!e.disabled,"Scl ":_e((r=e.scale)!==null&&r!==void 0?r:1)},s=["dropShadow","innerShadow","solidFill","gradientOverlay","stroke"],c=0,l=s;c<l.length;c++){var u=l[c];if(e[u]&&!Array.isArray(e[u]))throw new Error("".concat(u," should be an array"))}var d=function(S){return!!S&&S.length>1&&n},p=function(S){return!!S&&S.length>=1&&(!n||S.length===1)};if(p(e.dropShadow)&&(o.DrSh=Pe(e.dropShadow[0],"dropShadow",t)),d(e.dropShadow)&&(o.dropShadowMulti=e.dropShadow.map(function(S){return Pe(S,"dropShadow",t)})),p(e.innerShadow)&&(o.IrSh=Pe(e.innerShadow[0],"innerShadow",t)),d(e.innerShadow)&&(o.innerShadowMulti=e.innerShadow.map(function(S){return Pe(S,"innerShadow",t)})),e.outerGlow&&(o.OrGl=Pe(e.outerGlow,"outerGlow",t)),d(e.solidFill)&&(o.solidFillMulti=e.solidFill.map(function(S){return Pe(S,"solidFill",t)})),d(e.gradientOverlay)&&(o.gradientFillMulti=e.gradientOverlay.map(function(S){return Pe(S,"gradientOverlay",t)})),d(e.stroke)&&(o.frameFXMulti=e.stroke.map(function(S){return Kr(S)})),e.innerGlow&&(o.IrGl=Pe(e.innerGlow,"innerGlow",t)),e.bevel&&(o.ebbl=Pe(e.bevel,"bevel",t)),p(e.solidFill)&&(o.SoFi=Pe(e.solidFill[0],"solidFill",t)),e.patternOverlay&&(o.patternFill=Pe(e.patternOverlay,"patternOverlay",t)),p(e.gradientOverlay)&&(o.GrFl=Pe(e.gradientOverlay[0],"gradientOverlay",t)),e.satin&&(o.ChFX=Pe(e.satin,"satin",t)),p(e.stroke)&&(o.FrFX=Kr((a=e.stroke)===null||a===void 0?void 0:a[0])),n){o.numModifyingFX=0;for(var f=0,m=Object.keys(e);f<m.length;f++){var u=m[f],v=e[u];if(Array.isArray(v))for(var x=0,b=v;x<b.length;x++){var y=b[x];y.enabled&&o.numModifyingFX++}else v.enabled&&o.numModifyingFX++}}return o}function un(e,t){var n={},i=e.masterFXSwitch,r=e.DrSh,a=e.dropShadowMulti,o=e.IrSh,s=e.innerShadowMulti,c=e.OrGl,l=e.IrGl,u=e.ebbl,d=e.SoFi,p=e.solidFillMulti,f=e.patternFill,m=e.GrFl,v=e.gradientFillMulti,x=e.ChFX,b=e.FrFX,y=e.frameFXMulti;e.numModifyingFX;var S=lc(e,["masterFXSwitch","DrSh","dropShadowMulti","IrSh","innerShadowMulti","OrGl","IrGl","ebbl","SoFi","solidFillMulti","patternFill","GrFl","gradientFillMulti","ChFX","FrFX","frameFXMulti","numModifyingFX"]);return i||(n.disabled=!0),e["Scl "]&&(n.scale=oe(e["Scl "])),r&&(n.dropShadow=[Ae(r,t)]),a&&(n.dropShadow=a.map(function(g){return Ae(g,t)})),o&&(n.innerShadow=[Ae(o,t)]),s&&(n.innerShadow=s.map(function(g){return Ae(g,t)})),c&&(n.outerGlow=Ae(c,t)),l&&(n.innerGlow=Ae(l,t)),u&&(n.bevel=Ae(u,t)),d&&(n.solidFill=[Ae(d,t)]),p&&(n.solidFill=p.map(function(g){return Ae(g,t)})),f&&(n.patternOverlay=Ae(f,t)),m&&(n.gradientOverlay=[Ae(m,t)]),v&&(n.gradientOverlay=v.map(function(g){return Ae(g,t)})),x&&(n.satin=Ae(x,t)),b&&(n.stroke=[Yr(b)]),y&&(n.stroke=y.map(function(g){return Yr(g)})),t&&Object.keys(S).length>1&&console.log("Unhandled effect keys:",S),n}function Jr(e,t){for(var n=[],i=0;i<e.length;i++){var r=e[i],a=r.time,o=a.denominator,s=a.numerator,c=r.selected,l=r.animKey,u={numerator:s,denominator:o},d=Ao.decode(r.animInterpStyle);switch(l.Type){case"keyType.Opct":n.push({interpolation:d,time:u,selected:c,type:"opacity",value:oe(l.Opct)});break;case"keyType.Pstn":n.push({interpolation:d,time:u,selected:c,type:"position",x:l.Hrzn,y:l.Vrtc});break;case"keyType.Trnf":n.push({interpolation:d,time:u,selected:c,type:"transform",scale:Qt(l["Scl "]),skew:Qt(l.Skew),rotation:l.rotation,translation:Qt(l.translation)});break;case"keyType.sheetStyle":{var p={interpolation:d,time:u,selected:c,type:"style"};l.sheetStyle.Lefx&&(p.style=un(l.sheetStyle.Lefx,t)),n.push(p);break}case"keyType.globalLighting":{n.push({interpolation:d,time:u,selected:c,type:"globalLighting",globalAngle:l.gblA,globalAltitude:l.globalAltitude});break}default:throw new Error("Unsupported keyType value")}}return n}function Qr(e){for(var t=[],n=0;n<e.length;n++){var i=e[n],r=i.time,a=i.selected,o=a===void 0?!1:a,s=i.interpolation,c=Ao.encode(s),l=void 0;switch(i.type){case"opacity":l={Type:"keyType.Opct",Opct:xe(i.value)};break;case"position":l={Type:"keyType.Pstn",Hrzn:i.x,Vrtc:i.y};break;case"transform":l={Type:"keyType.Trnf","Scl ":en(i.scale),Skew:en(i.skew),rotation:i.rotation,translation:en(i.translation)};break;case"style":l={Type:"keyType.sheetStyle",sheetStyle:{Vrsn:1,blendOptions:{}}},i.style&&(l.sheetStyle={Vrsn:1,Lefx:cn(i.style,!1,!1),blendOptions:{}});break;case"globalLighting":{l={Type:"keyType.globalLighting",gblA:i.globalAngle,globalAltitude:i.globalAltitude};break}default:throw new Error("Unsupported keyType value")}t.push({Vrsn:1,animInterpStyle:c,time:r,animKey:l,selected:o})}return t}function mo(e,t){for(var n=[],i=0;i<e.length;i++){var r=e[i],a={type:Po.decode(r.trackID),enabled:r.enab,keys:Jr(r.keyList,t)};r.effectParams&&(a.effectParams={fillCanvas:r.effectParams.fillCanvas,zoomOrigin:r.effectParams.zoomOrigin,keys:Jr(r.effectParams.keyList,t)}),n.push(a)}return n}function go(e){for(var t=[],n=0;n<e.length;n++){var i=e[n];t.push(rt(rt({trackID:Po.encode(i.type),Vrsn:1,enab:!!i.enabled,Effc:!!i.effectParams},i.effectParams?{effectParams:{keyList:Qr(i.keys),fillCanvas:i.effectParams.fillCanvas,zoomOrigin:i.effectParams.zoomOrigin}}:{}),{keyList:Qr(i.keys)}))}return t}function Ae(e,t){for(var n={},i=0,r=Object.keys(e);i<r.length;i++){var a=r[i],o=e[a];switch(a){case"enab":n.enabled=!!o;break;case"uglg":n.useGlobalLight=!!o;break;case"AntA":n.antialiased=!!o;break;case"Algn":n.align=!!o;break;case"Dthr":n.dither=!!o;break;case"Invr":n.invert=!!o;break;case"Rvrs":n.reverse=!!o;break;case"Clr ":n.color=qe(o);break;case"hglC":n.highlightColor=qe(o);break;case"sdwC":n.shadowColor=qe(o);break;case"Styl":n.position=Yn.decode(o);break;case"Md  ":n.blendMode=Ne.decode(o);break;case"hglM":n.highlightBlendMode=Ne.decode(o);break;case"sdwM":n.shadowBlendMode=Ne.decode(o);break;case"bvlS":n.style=Co.decode(o);break;case"bvlD":n.direction=wo.decode(o);break;case"bvlT":n.technique=Io.decode(o);break;case"GlwT":n.technique=Eo.decode(o);break;case"glwS":n.source=Lo.decode(o);break;case"Type":n.type=Zn.decode(o);break;case"gs99":n.interpolationMethod=_t.decode(o);break;case"Opct":n.opacity=oe(o);break;case"hglO":n.highlightOpacity=oe(o);break;case"sdwO":n.shadowOpacity=oe(o);break;case"lagl":n.angle=Nn(o);break;case"Angl":n.angle=Nn(o);break;case"Lald":n.altitude=Nn(o);break;case"Sftn":n.soften=ie(o);break;case"srgR":n.strength=oe(o);break;case"blur":n.size=ie(o);break;case"Nose":n.noise=oe(o);break;case"Inpr":n.range=oe(o);break;case"Ckmt":n.choke=ie(o);break;case"ShdN":n.jitter=oe(o);break;case"Dstn":n.distance=ie(o);break;case"Scl ":n.scale=oe(o);break;case"Ptrn":n.pattern={name:o["Nm  "],id:o.Idnt};break;case"phase":n.phase={x:o.Hrzn,y:o.Vrtc};break;case"Ofst":n.offset={x:oe(o.Hrzn),y:oe(o.Vrtc)};break;case"MpgS":case"TrnS":n.contour={name:o["Nm  "],curve:o["Crv "].map(function(s){return{x:s.Hrzn,y:s.Vrtc}})};break;case"Grad":n.gradient=bo(o);break;case"useTexture":case"useShape":case"layerConceals":case"present":case"showInDialog":case"antialiasGloss":n[a]=o;break;case"_name":case"_classID":break;default:t&&console.log("Invalid effect key: '".concat(a,"', value:"),o)}}return n}function Pe(e,t,n){var i={enab:!1};t==="dropShadow"&&(i.TrnS={"Nm  ":"","Crv ":[]});for(var r=0,a=Object.keys(e);r<a.length;r++){var o=a[r],s=o,c=e[s];switch(s){case"enabled":i.enab=!!c;break;case"useGlobalLight":i.uglg=!!c;break;case"antialiased":i.AntA=!!c;break;case"align":i.Algn=!!c;break;case"dither":i.Dthr=!!c;break;case"invert":i.Invr=!!c;break;case"reverse":i.Rvrs=!!c;break;case"color":i["Clr "]=$e(c);break;case"highlightColor":i.hglC=$e(c);break;case"shadowColor":i.sdwC=$e(c);break;case"position":i.Styl=Yn.encode(c);break;case"blendMode":i["Md  "]=Ne.encode(c);break;case"highlightBlendMode":i.hglM=Ne.encode(c);break;case"shadowBlendMode":i.sdwM=Ne.encode(c);break;case"style":i.bvlS=Co.encode(c);break;case"direction":i.bvlD=wo.encode(c);break;case"technique":t==="bevel"?i.bvlT=Io.encode(c):i.GlwT=Eo.encode(c);break;case"source":i.glwS=Lo.encode(c);break;case"type":i.Type=Zn.encode(c);break;case"interpolationMethod":i.gs99=_t.encode(c);break;case"opacity":i.Opct=xe(c);break;case"highlightOpacity":i.hglO=xe(c);break;case"shadowOpacity":i.sdwO=xe(c);break;case"angle":t==="gradientOverlay"||t==="patternFill"?i.Angl=tn(c):i.lagl=tn(c);break;case"altitude":i.Lald=tn(c);break;case"soften":i.Sftn=ce(c,s);break;case"strength":i.srgR=xe(c);break;case"size":i.blur=ce(c,s);break;case"noise":i.Nose=xe(c);break;case"range":i.Inpr=xe(c);break;case"choke":i.Ckmt=ce(c,s);break;case"jitter":i.ShdN=xe(c);break;case"distance":i.Dstn=ce(c,s);break;case"scale":i["Scl "]=xe(c);break;case"pattern":i.Ptrn={"Nm  ":c.name,Idnt:c.id};break;case"phase":i.phase={Hrzn:c.x,Vrtc:c.y};break;case"offset":i.Ofst={Hrzn:xe(c.x),Vrtc:xe(c.y)};break;case"contour":{i[t==="satin"?"MpgS":"TrnS"]={"Nm  ":c.name,"Crv ":c.curve.map(function(l){return{Hrzn:l.x,Vrtc:l.y}})};break}case"gradient":i.Grad=yo(c);break;case"useTexture":case"useShape":case"layerConceals":case"present":case"showInDialog":case"antialiasGloss":i[s]=c;break;default:n&&console.log("Invalid effect key: '".concat(s,"', value:"),c)}}return i}function bo(e){if(e.GrdF==="GrdF.CstS"){var t=e.Intr||4096;return{type:"solid",name:e["Nm  "],smoothness:e.Intr/4096,colorStops:e.Clrs.map(function(n){return{color:qe(n["Clr "]),location:n.Lctn/t,midpoint:n.Mdpn/100}}),opacityStops:e.Trns.map(function(n){return{opacity:oe(n.Opct),location:n.Lctn/t,midpoint:n.Mdpn/100}})}}else return{type:"noise",name:e["Nm  "],roughness:e.Smth/4096,colorModel:Hn.decode(e.ClrS),randomSeed:e.RndS,restrictColors:!!e.VctC,addTransparency:!!e.ShTr,min:e["Mnm "].map(function(n){return n/100}),max:e["Mxm "].map(function(n){return n/100})}}function yo(e){var t,n;if(e.type==="solid"){var i=Math.round(((t=e.smoothness)!==null&&t!==void 0?t:1)*4096);return{"Nm  ":e.name||"",GrdF:"GrdF.CstS",Intr:i,Clrs:e.colorStops.map(function(r){var a;return{"Clr ":$e(r.color),Type:"Clry.UsrS",Lctn:Math.round(r.location*i),Mdpn:Math.round(((a=r.midpoint)!==null&&a!==void 0?a:.5)*100)}}),Trns:e.opacityStops.map(function(r){var a;return{Opct:xe(r.opacity),Lctn:Math.round(r.location*i),Mdpn:Math.round(((a=r.midpoint)!==null&&a!==void 0?a:.5)*100)}})}}else return{GrdF:"GrdF.ClNs","Nm  ":e.name||"",ShTr:!!e.addTransparency,VctC:!!e.restrictColors,ClrS:Hn.encode(e.colorModel),RndS:e.randomSeed||0,Smth:Math.round(((n=e.roughness)!==null&&n!==void 0?n:1)*4096),"Mnm ":(e.min||[0,0,0,0]).map(function(r){return r*100}),"Mxm ":(e.max||[1,1,1,1]).map(function(r){return r*100})}}function So(e){var t=bo(e.Grad);return t.style=Zn.decode(e.Type),e.Dthr!==void 0&&(t.dither=e.Dthr),e.gradientsInterpolationMethod!==void 0&&(t.interpolationMethod=_t.decode(e.gradientsInterpolationMethod)),e.Rvrs!==void 0&&(t.reverse=e.Rvrs),e.Angl!==void 0&&(t.angle=Nn(e.Angl)),e["Scl "]!==void 0&&(t.scale=oe(e["Scl "])),e.Algn!==void 0&&(t.align=e.Algn),e.Ofst!==void 0&&(t.offset={x:oe(e.Ofst.Hrzn),y:oe(e.Ofst.Vrtc)}),t}function xo(e){var t={name:e.Ptrn["Nm  "],id:e.Ptrn.Idnt};return e.Lnkd!==void 0&&(t.linked=e.Lnkd),e.phase!==void 0&&(t.phase={x:e.phase.Hrzn,y:e.phase.Vrtc}),t}function fn(e){if("Grad"in e)return So(e);if("Ptrn"in e)return rt({type:"pattern"},xo(e));if("Clr "in e)return{type:"color",color:qe(e["Clr "])};throw new Error("Invalid vector content")}function Fo(e){var t={};return e.dither!==void 0&&(t.Dthr=e.dither),e.interpolationMethod!==void 0&&(t.gradientsInterpolationMethod=_t.encode(e.interpolationMethod)),e.reverse!==void 0&&(t.Rvrs=e.reverse),e.angle!==void 0&&(t.Angl=tn(e.angle)),t.Type=Zn.encode(e.style),e.align!==void 0&&(t.Algn=e.align),e.scale!==void 0&&(t["Scl "]=xe(e.scale)),e.offset&&(t.Ofst={Hrzn:xe(e.offset.x),Vrtc:xe(e.offset.y)}),t.Grad=yo(e),t}function ko(e){var t={Ptrn:{"Nm  ":e.name||"",Idnt:e.id||""}};return e.linked!==void 0&&(t.Lnkd=!!e.linked),e.phase!==void 0&&(t.phase={Hrzn:e.phase.x,Vrtc:e.phase.y}),t}function dn(e){return e.type==="color"?{key:"SoCo",descriptor:{"Clr ":$e(e.color)}}:e.type==="pattern"?{key:"PtFl",descriptor:ko(e)}:{key:"GdFl",descriptor:Fo(e)}}function qe(e){if("H   "in e)return{h:vc(e["H   "]),s:e.Strt,b:e.Brgh};if("Rd  "in e)return{r:e["Rd  "],g:e["Grn "],b:e["Bl  "]};if("Cyn "in e)return{c:e["Cyn "],m:e.Mgnt,y:e["Ylw "],k:e.Blck};if("Gry "in e)return{k:e["Gry "]};if("Lmnc"in e)return{l:e.Lmnc,a:e["A   "],b:e["B   "]};if("redFloat"in e)return{fr:e.redFloat,fg:e.greenFloat,fb:e.blueFloat};throw new Error("Unsupported color descriptor")}function $e(e){if(e){if("r"in e)return{_name:"",_classID:"RGBC","Rd  ":e.r||0,"Grn ":e.g||0,"Bl  ":e.b||0};if("fr"in e)return{_name:"",_classID:"RGBC",redFloat:e.fr,greenFloat:e.fg,blueFloat:e.fb};if("h"in e)return{_name:"",_classID:"HSBC","H   ":tn(e.h*360),Strt:e.s||0,Brgh:e.b||0};if("c"in e)return{_name:"",_classID:"CMYC","Cyn ":e.c||0,Mgnt:e.m||0,"Ylw ":e.y||0,Blck:e.k||0};if("l"in e)return{_name:"",_classID:"LABC",Lmnc:e.l||0,"A   ":e.a||0,"B   ":e.b||0};if("k"in e)return{_name:"",_classID:"GRYC","Gry ":e.k};throw new Error("Invalid color value")}else return{_name:"",_classID:"RGBC","Rd  ":0,"Grn ":0,"Bl  ":0}}function Nn(e){if(e===void 0)return 0;if(e.units!=="Angle")throw new Error("Invalid units: ".concat(e.units));return e.value}function oe(e){if(e===void 0)return 1;if(e.units!=="Percent")throw new Error("Invalid units: ".concat(e.units));return e.value/100}function vc(e){if(e===void 0)return 1;if(e.units==="Percent")return e.value/100;if(e.units==="Angle")return e.value/360;throw new Error("Invalid units: ".concat(e.units))}function ie(e){var t=e.units,n=e.value;if(t!=="Pixels"&&t!=="Millimeters"&&t!=="Points"&&t!=="None"&&t!=="Picas"&&t!=="Inches"&&t!=="Centimeters"&&t!=="Density")throw new Error("Invalid units: ".concat(JSON.stringify({units:t,value:n})));return{value:n,units:t}}function ht(e,t){return t===void 0&&(t="Pixels"),typeof e=="number"?{value:e,units:t}:ie(e)}function tn(e){return{units:"Angle",value:e||0}}function xe(e){return{units:"Percent",value:Math.round((e||0)*100)}}function _e(e){return{units:"Percent",value:(e||0)*100}}function ce(e,t){if(e==null)return{units:"Pixels",value:0};if(typeof e!="object")throw new Error("Invalid value: ".concat(JSON.stringify(e)," (key: ").concat(t,") (should have value and units)"));var n=e.units,i=e.value;if(typeof i!="number")throw new Error("Invalid value in ".concat(JSON.stringify(e)," (key: ").concat(t,")"));if(n!=="Pixels"&&n!=="Millimeters"&&n!=="Points"&&n!=="None"&&n!=="Picas"&&n!=="Inches"&&n!=="Centimeters"&&n!=="Density")throw new Error("Invalid units in ".concat(JSON.stringify(e)," (key: ").concat(t,")"));return{units:n,value:i}}function Ee(e){var t=e.numerator,n=e.denominator;return{numerator:t,denominator:n}}var ea=z("textGridding","none",{none:"None",round:"Rnd "}),nn=z("Ornt","horizontal",{horizontal:"Hrzn",vertical:"Vrtc"}),ta=z("Annt","sharp",{none:"Anno",sharp:"antiAliasSharp",crisp:"AnCr",strong:"AnSt",smooth:"AnSm",platform:"antiAliasPlatformGray",platformLCD:"antiAliasPlatformLCD"}),Ri=z("warpStyle","none",{none:"warpNone",arc:"warpArc",arcLower:"warpArcLower",arcUpper:"warpArcUpper",arch:"warpArch",bulge:"warpBulge",shellLower:"warpShellLower",shellUpper:"warpShellUpper",flag:"warpFlag",wave:"warpWave",fish:"warpFish",rise:"warpRise",fisheye:"warpFisheye",inflate:"warpInflate",squeeze:"warpSqueeze",twist:"warpTwist",cylinder:"warpCylinder",custom:"warpCustom"}),Ne=z("BlnM","normal",{normal:"Nrml",dissolve:"Dslv",darken:"Drkn",multiply:"Mltp","color burn":"CBrn","linear burn":"linearBurn","darker color":"darkerColor",lighten:"Lghn",screen:"Scrn","color dodge":"CDdg","linear dodge":"linearDodge","lighter color":"lighterColor",overlay:"Ovrl","soft light":"SftL","hard light":"HrdL","vivid light":"vividLight","linear light":"linearLight","pin light":"pinLight","hard mix":"hardMix",difference:"Dfrn",exclusion:"Xclu",subtract:"blendSubtraction",divide:"blendDivide",hue:"H   ",saturation:"Strt",color:"Clr ",luminosity:"Lmns","linear height":"linearHeight",height:"Hght",subtraction:"Sbtr"}),Co=z("BESl","inner bevel",{"inner bevel":"InrB","outer bevel":"OtrB",emboss:"Embs","pillow emboss":"PlEb","stroke emboss":"strokeEmboss"}),Io=z("bvlT","smooth",{smooth:"SfBL","chisel hard":"PrBL","chisel soft":"Slmt"}),wo=z("BESs","up",{up:"In  ",down:"Out "}),Eo=z("BETE","softer",{softer:"SfBL",precise:"PrBL"}),Lo=z("IGSr","edge",{edge:"SrcE",center:"SrcC"}),Zn=z("GrdT","linear",{linear:"Lnr ",radial:"Rdl ",angle:"Angl",reflected:"Rflc",diamond:"Dmnd"}),Ao=z("animInterpStyle","linear",{linear:"Lnr ",hold:"hold"}),Po=z("stdTrackID","opacity",{opacity:"opacityTrack",style:"styleTrack",sheetTransform:"sheetTransformTrack",sheetPosition:"sheetPositionTrack",globalLighting:"globalLightingTrack"}),_t=z("gradientInterpolationMethodType","perceptual",{perceptual:"Perc",linear:"Lnr ",classic:"Gcls",smooth:"Smoo"}),Hn=z("ClrS","rgb",{rgb:"RGBC",hsb:"HSBl",lab:"LbCl",hsl:"HSLC"}),Yn=z("FStl","outside",{outside:"OutF",center:"CtrF",inside:"InsF"}),Do=z("FrFl","color",{color:"SClr",gradient:"GrFl",pattern:"Ptrn"}),na=z("ESliceType","image",{image:"Img ",noImage:"noImage"}),ia=z("ESliceHorzAlign","default",{default:"default"}),ra=z("ESliceVertAlign","default",{default:"default"}),aa=z("ESliceOrigin","userGenerated",{userGenerated:"userGenerated",autoGenerated:"autoGenerated",layer:"layer"}),oa=z("ESliceBGColorType","none",{none:"None",matte:"matte",color:"Clr "}),sa=z("strokeStyleLineCapType","butt",{butt:"strokeStyleButtCap",round:"strokeStyleRoundCap",square:"strokeStyleSquareCap"}),la=z("strokeStyleLineJoinType","miter",{miter:"strokeStyleMiterJoin",round:"strokeStyleRoundJoin",bevel:"strokeStyleBevelJoin"}),ca=z("strokeStyleLineAlignment","inside",{inside:"strokeStyleAlignInside",center:"strokeStyleAlignCenter",outside:"strokeStyleAlignOutside"}),To=z("BlrM","ispinmage",{spin:"Spn ",zoom:"Zm  "}),Oo=z("BlrQ","good",{draft:"Drft",good:"Gd  ",best:"Bst "}),Mo=z("SmBM","normal",{normal:"SBMN","edge only":"SBME","overlay edge":"SBMO"}),Ro=z("SmBQ","medium",{low:"SBQL",medium:"SBQM",high:"SBQH"}),Bo=z("DspM","stretch to fit",{"stretch to fit":"StrF",tile:"Tile"}),Ot=z("UndA","repeat edge pixels",{"wrap around":"WrpA","repeat edge pixels":"RptE"}),_o=z("Cnvr","rectangular to polar",{"rectangular to polar":"RctP","polar to rectangular":"PlrR"}),No=z("RplS","medium",{small:"Sml ",medium:"Mdm ",large:"Lrg "}),zo=z("SphM","normal",{normal:"Nrml","horizontal only":"HrzO","vertical only":"VrtO"}),Go=z("Wvtp","sine",{sine:"WvSn",triangle:"WvTr",square:"WvSq"}),Uo=z("ZZTy","pond ripples",{"around center":"ArnC","out from center":"OtFr","pond ripples":"PndR"}),Vo=z("Dstr","uniform",{uniform:"Unfr",gaussian:"Gsn "}),rn=z("Chnl","composite",{red:"Rd  ",green:"Grn ",blue:"Bl  ",composite:"Cmps"}),Ho=z("MztT","fine dots",{"fine dots":"FnDt","medium dots":"MdmD","grainy dots":"GrnD","coarse dots":"CrsD","short lines":"ShrL","medium lines":"MdmL","long lines":"LngL","short strokes":"ShSt","medium strokes":"MdmS","long strokes":"LngS"}),jo=z("Lns ","50-300mm zoom",{"50-300mm zoom":"Zm  ","32mm prime":"Nkn ","105mm prime":"Nkn1","movie prime":"PnVs"}),Wo=z("blurType","gaussian blur",{"gaussian blur":"GsnB","lens blur":"lensBlur","motion blur":"MtnB"}),Xo=z("DfsM","normal",{normal:"Nrml","darken only":"DrkO","lighten only":"LghO",anisotropic:"anisotropic"}),qo=z("ExtT","blocks",{blocks:"Blks",pyramids:"Pyrm"}),$o=z("ExtR","random",{random:"Rndm","level-based":"LvlB"}),Zo=z("FlCl","background color",{"background color":"FlBc","foreground color":"FlFr","inverse image":"FlIn","unaltered image":"FlSm"}),Yo=z("CntE","upper",{lower:"Lwr ",upper:"Upr "}),Ko=z("WndM","wind",{wind:"Wnd ",blast:"Blst",stagger:"Stgr"}),Jo=z("Drct","from the right",{left:"Left",right:"Rght"}),Qo=z("IntE","odd lines",{"odd lines":"ElmO","even lines":"ElmE"}),es=z("IntC","interpolation",{duplication:"CrtD",interpolation:"CrtI"}),ts=z("FlMd","wrap around",{"set to transparent":"Bckg","repeat edge pixels":"Rpt ","wrap around":"Wrp "});z("prjM","fisheye",{fisheye:"fisP",perspective:"perP",auto:"auto","full spherical":"fusP"});var ns=z("presetKindType","presetKindCustom",{custom:"presetKindCustom",default:"presetKindDefault"}),Pt=function(){return Pt=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},Pt.apply(this,arguments)},is={};function te(e,t,n,i){var r={key:e,has:t,read:n,write:i};is[r.key]=r}var wn=[void 0,"PPI","PPCM"],En=[void 0,"Inches","Centimeters","Points","Picas","Columns"],ua="0123456789abcdef";function fa(e){return e<=57?e-48:e-87}function mc(e,t){return fa(e.charCodeAt(t))<<4|fa(e.charCodeAt(t+1))}function Bi(e,t){var n=Ce(e,t);return so(n)}function _i(e,t){var n=oo(t);st(e,n)}function gc(e){for(var t=T(e),n=Ce(e,t),i=!1,r=0;r<n.byteLength;r++)if(n[r]&128){i=!0;break}if(i){var a=new TextDecoder("gbk");return a.decode(n)}else return so(n)}function bc(e,t){for(var n="",i=0,r=t.codePointAt(i++);r!==void 0;r=t.codePointAt(i++))n+=r>127?"?":String.fromCodePoint(r);var a=oo(n);B(e,a.byteLength),st(e,a)}te(1061,function(e){return e.captionDigest!==void 0},function(e,t){for(var n="",i=0;i<16;i++){var r=T(e);n+=ua[r>>4],n+=ua[r&15]}t.captionDigest=n},function(e,t){for(var n=0;n<16;n++)B(e,mc(t.captionDigest,n*2))});te(1060,function(e){return e.xmpMetadata!==void 0},function(e,t,n){t.xmpMetadata=Bi(e,n())},function(e,t){_i(e,t.xmpMetadata)});var Ln=z("Inte","perceptual",{perceptual:"Img ",saturation:"Grp ","relative colorimetric":"Clrm","absolute colorimetric":"AClr"});te(1082,function(e){return e.printInformation!==void 0},function(e,t){var n,i,r=Y(e);t.printInformation={printerName:r.printerName||"",renderingIntent:Ln.decode((n=r.Inte)!==null&&n!==void 0?n:"Inte.Img ")};var a=t.printInformation;r.PstS!==void 0&&(a.printerManagesColors=r.PstS),r["Nm  "]!==void 0&&(a.printerProfile=r["Nm  "]),r.MpBl!==void 0&&(a.blackPointCompensation=r.MpBl),r.printSixteenBit!==void 0&&(a.printSixteenBit=r.printSixteenBit),r.hardProof!==void 0&&(a.hardProof=r.hardProof),r.printProofSetup&&("Bltn"in r.printProofSetup?a.proofSetup={builtin:r.printProofSetup.Bltn.split(".")[1]}:a.proofSetup={profile:r.printProofSetup.profile,renderingIntent:Ln.decode((i=r.printProofSetup.Inte)!==null&&i!==void 0?i:"Inte.Img "),blackPointCompensation:!!r.printProofSetup.MpBl,paperWhite:!!r.printProofSetup.paperWhite})},function(e,t){var n,i,r=t.printInformation,a={};r.printerManagesColors?a.PstS=!0:(r.hardProof!==void 0&&(a.hardProof=!!r.hardProof),a.ClrS="ClrS.RGBC",a["Nm  "]=(n=r.printerProfile)!==null&&n!==void 0?n:"CIE RGB"),a.Inte=Ln.encode(r.renderingIntent),r.printerManagesColors||(a.MpBl=!!r.blackPointCompensation),a.printSixteenBit=!!r.printSixteenBit,a.printerName=r.printerName||"",r.proofSetup&&"profile"in r.proofSetup?a.printProofSetup={profile:r.proofSetup.profile||"",Inte:Ln.encode(r.proofSetup.renderingIntent),MpBl:!!r.proofSetup.blackPointCompensation,paperWhite:!!r.proofSetup.paperWhite}:a.printProofSetup={Bltn:!((i=r.proofSetup)===null||i===void 0)&&i.builtin?"builtinProof.".concat(r.proofSetup.builtin):"builtinProof.proofCMYK"},K(e,"","printOutput",a)});te(1005,function(e){return e.resolutionInfo!==void 0},function(e,t){var n=De(e),i=E(e),r=E(e),a=De(e),o=E(e),s=E(e);t.resolutionInfo={horizontalResolution:n,horizontalResolutionUnit:wn[i]||"PPI",widthUnit:En[r]||"Inches",verticalResolution:a,verticalResolutionUnit:wn[o]||"PPI",heightUnit:En[s]||"Inches"}},function(e,t){var n=t.resolutionInfo;Oe(e,n.horizontalResolution||0),I(e,Math.max(1,wn.indexOf(n.horizontalResolutionUnit))),I(e,Math.max(1,En.indexOf(n.widthUnit))),Oe(e,n.verticalResolution||0),I(e,Math.max(1,wn.indexOf(n.verticalResolutionUnit))),I(e,Math.max(1,En.indexOf(n.heightUnit)))});var da=["centered","size to fit","user defined"];te(1062,function(e){return e.printScale!==void 0},function(e,t){t.printScale={style:da[Q(e)],x:We(e),y:We(e),scale:We(e)}},function(e,t){var n=t.printScale,i=n.style,r=n.x,a=n.y,o=n.scale;ne(e,Math.max(0,da.indexOf(i))),Xe(e,r||0),Xe(e,a||0),Xe(e,o||0)});te(1006,function(e){return e.alphaChannelNames!==void 0},function(e,t,n){if(t.alphaChannelNames)R(e,n());else for(t.alphaChannelNames=[];n()>0;){var i=gc(e);t.alphaChannelNames.push(i)}},function(e,t){for(var n=0,i=t.alphaChannelNames;n<i.length;n++){var r=i[n];bc(e,r)}});te(1045,function(e){return e.alphaChannelNames!==void 0},function(e,t,n){for(t.alphaChannelNames=[];n()>0;)t.alphaChannelNames.push(ke(e))},function(e,t){for(var n=0,i=t.alphaChannelNames;n<i.length;n++){var r=i[n];xt(e,r)}});te(1053,function(e){return e.alphaIdentifiers!==void 0},function(e,t,n){for(t.alphaIdentifiers=[];n()>=4;)t.alphaIdentifiers.push(L(e))},function(e,t){for(var n=0,i=t.alphaIdentifiers;n<i.length;n++){var r=i[n];D(e,r)}});te(1010,function(e){return e.backgroundColor!==void 0},function(e,t){return t.backgroundColor=Se(e)},function(e,t){return Fe(e,t.backgroundColor)});te(1037,function(e){return e.globalAngle!==void 0},function(e,t){return t.globalAngle=_(e)},function(e,t){return H(e,t.globalAngle)});te(1049,function(e){return e.globalAltitude!==void 0},function(e,t){return t.globalAltitude=L(e)},function(e,t){return D(e,t.globalAltitude)});te(1011,function(e){return e.printFlags!==void 0},function(e,t){t.printFlags={labels:!!T(e),cropMarks:!!T(e),colorBars:!!T(e),registrationMarks:!!T(e),negative:!!T(e),flip:!!T(e),interpolate:!!T(e),caption:!!T(e),printFlags:!!T(e)}},function(e,t){var n=t.printFlags;B(e,n.labels?1:0),B(e,n.cropMarks?1:0),B(e,n.colorBars?1:0),B(e,n.registrationMarks?1:0),B(e,n.negative?1:0),B(e,n.flip?1:0),B(e,n.interpolate?1:0),B(e,n.caption?1:0),B(e,n.printFlags?1:0)});te(1034,function(e){return e.copyrighted!==void 0},function(e,t){t.copyrighted=!!T(e)},function(e,t){B(e,t.copyrighted?1:0)});te(1035,function(e){return e.url!==void 0},function(e,t,n){t.url=Kn(e,n())},function(e,t){lu(e,t.url)});te(1080,function(e){return e.countInformation!==void 0},function(e,t){var n=Y(e);t.countInformation=n.countGroupList.map(function(i){return{color:{r:i["Rd  "],g:i["Grn "],b:i["Bl  "]},name:i["Nm  "],size:i["Rds "],fontSize:i.fontSize,visible:i.Vsbl,points:i.countObjectList.map(function(r){return{x:r["X   "],y:r["Y   "]}})}})},function(e,t){var n={Vrsn:1,countGroupList:t.countInformation.map(function(i){return{"Rd  ":i.color.r,"Grn ":i.color.g,"Bl  ":i.color.b,"Nm  ":i.name,"Rds ":i.size,fontSize:i.fontSize,Vsbl:i.visible,countObjectList:i.points.map(function(r){return{"X   ":r.x,"Y   ":r.y}})}})};K(e,"","Cnt ",n)});te(1024,function(e){return e.layerState!==void 0},function(e,t){return t.layerState=E(e)},function(e,t){return I(e,t.layerState)});te(1026,function(e){return e.layersGroup!==void 0},function(e,t,n){for(t.layersGroup=[];n()>0;)t.layersGroup.push(E(e))},function(e,t){for(var n=0,i=t.layersGroup;n<i.length;n++){var r=i[n];I(e,r)}});te(1072,function(e){return e.layerGroupsEnabledId!==void 0},function(e,t,n){for(t.layerGroupsEnabledId=[];n()>0;)t.layerGroupsEnabledId.push(T(e))},function(e,t){for(var n=0,i=t.layerGroupsEnabledId;n<i.length;n++){var r=i[n];B(e,r)}});te(1069,function(e){return e.layerSelectionIds!==void 0},function(e,t){var n=E(e);for(t.layerSelectionIds=[];n--;)t.layerSelectionIds.push(L(e))},function(e,t){I(e,t.layerSelectionIds.length);for(var n=0,i=t.layerSelectionIds;n<i.length;n++){var r=i[n];D(e,r)}});te(1032,function(e){return e.gridAndGuidesInformation!==void 0},function(e,t){var n=L(e),i=L(e),r=L(e),a=L(e);if(n!==1)throw new Error("Invalid 1032 resource version: ".concat(n));t.gridAndGuidesInformation={grid:{horizontal:i,vertical:r},guides:[]};for(var o=0;o<a;o++)t.gridAndGuidesInformation.guides.push({location:L(e)/32,direction:T(e)?"horizontal":"vertical"})},function(e,t){var n=t.gridAndGuidesInformation,i=n.grid||{horizontal:576,vertical:576},r=n.guides||[];D(e,1),D(e,i.horizontal),D(e,i.vertical),D(e,r.length);for(var a=0,o=r;a<o.length;a++){var s=o[a];D(e,s.location*32),B(e,s.direction==="horizontal"?1:0)}});te(1065,function(e){return e.layerComps!==void 0},function(e,t){var n=Y(e,!0);t.layerComps={list:[]};for(var i=0,r=n.list;i<r.length;i++){var a=r[i];t.layerComps.list.push({id:a.compID,name:a["Nm  "],capturedInfo:a.capturedInfo}),"comment"in a&&(t.layerComps.list[t.layerComps.list.length-1].comment=a.comment)}"lastAppliedComp"in n&&(t.layerComps.lastApplied=n.lastAppliedComp)},function(e,t){for(var n=t.layerComps,i={list:[]},r=0,a=n.list;r<a.length;r++){var o=a[r],s={};s._classID="Comp",s["Nm  "]=o.name,"comment"in o&&(s.comment=o.comment),s.compID=o.id,s.capturedInfo=o.capturedInfo,i.list.push(s)}"lastApplied"in n&&(i.lastAppliedComp=n.lastApplied),K(e,"","CompList",i)});var ha=["normal",void 0,void 0,void 0,void 0,void 0,void 0,"multiply","screen",void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,"difference"];te(1078,function(e){return e.onionSkins!==void 0},function(e,t){var n=Y(e);t.onionSkins={enabled:n.enab,framesBefore:n.numBefore,framesAfter:n.numAfter,frameSpacing:n.Spcn,minOpacity:n.minOpacity/100,maxOpacity:n.maxOpacity/100,blendMode:ha[n.BlnM]||"normal"}},function(e,t){var n=t.onionSkins,i={Vrsn:1,enab:n.enabled,numBefore:n.framesBefore,numAfter:n.framesAfter,Spcn:n.frameSpacing,minOpacity:n.minOpacity*100|0,maxOpacity:n.maxOpacity*100|0,BlnM:Math.max(0,ha.indexOf(n.blendMode))};K(e,"","null",i)});te(1075,function(e){return e.timelineInformation!==void 0},function(e,t){var n,i,r=Y(e);t.timelineInformation={enabled:r.enab,frameStep:Ee(r.frameStep),frameRate:r.frameRate,time:Ee(r.time),duration:Ee(r.duration),workInTime:Ee(r.workInTime),workOutTime:Ee(r.workOutTime),repeats:r.LCnt,hasMotion:r.hasMotion,globalTracks:mo(r.globalTrackList,!!e.logMissingFeatures)},!((i=(n=r.audioClipGroupList)===null||n===void 0?void 0:n.audioClipGroupList)===null||i===void 0)&&i.length&&(t.timelineInformation.audioClipGroups=r.audioClipGroupList.audioClipGroupList.map(function(a){return{id:a.groupID,muted:a.muted,audioClips:a.audioClipList.map(function(o){var s=o.clipID,c=o.timeScope,l=o.muted,u=o.audioLevel,d=o.frameReader;return{id:s,start:Ee(c.Strt),duration:Ee(c.duration),inTime:Ee(c.inTime),outTime:Ee(c.outTime),muted:l,audioLevel:u,frameReader:{type:d.frameReaderType,mediaDescriptor:d.mediaDescriptor,link:{name:d["Lnk "]["Nm  "],fullPath:d["Lnk "].fullPath,relativePath:d["Lnk "].relPath}}}})}}))},function(e,t){var n,i=t.timelineInformation,r={Vrsn:1,enab:i.enabled,frameStep:i.frameStep,frameRate:i.frameRate,time:i.time,duration:i.duration,workInTime:i.workInTime,workOutTime:i.workOutTime,LCnt:i.repeats,globalTrackList:go(i.globalTracks),audioClipGroupList:{audioClipGroupList:(n=i.audioClipGroups)===null||n===void 0?void 0:n.map(function(a){return{groupID:a.id,muted:a.muted,audioClipList:a.audioClips.map(function(o){return{clipID:o.id,timeScope:{Vrsn:1,Strt:o.start,duration:o.duration,inTime:o.inTime,outTime:o.outTime},frameReader:{frameReaderType:o.frameReader.type,descVersion:1,"Lnk ":{descVersion:1,"Nm  ":o.frameReader.link.name,fullPath:o.frameReader.link.fullPath,relPath:o.frameReader.link.relativePath},mediaDescriptor:o.frameReader.mediaDescriptor},muted:o.muted,audioLevel:o.audioLevel}})}})},hasMotion:i.hasMotion};K(e,"","null",r,"anim")});te(1076,function(e){return e.sheetDisclosure!==void 0},function(e,t){var n=Y(e);t.sheetDisclosure={},n.sheetTimelineOptions&&(t.sheetDisclosure.sheetTimelineOptions=n.sheetTimelineOptions.map(function(i){return{sheetID:i.sheetID,sheetDisclosed:i.sheetDisclosed,lightsDisclosed:i.lightsDisclosed,meshesDisclosed:i.meshesDisclosed,materialsDisclosed:i.materialsDisclosed}}))},function(e,t){var n=t.sheetDisclosure,i={Vrsn:1};n.sheetTimelineOptions&&(i.sheetTimelineOptions=n.sheetTimelineOptions.map(function(r){return{Vrsn:2,sheetID:r.sheetID,sheetDisclosed:r.sheetDisclosed,lightsDisclosed:r.lightsDisclosed,meshesDisclosed:r.meshesDisclosed,materialsDisclosed:r.materialsDisclosed}})),K(e,"","null",i)});te(1054,function(e){return e.urlsList!==void 0},function(e,t){var n=L(e);t.urlsList=[];for(var i=0;i<n;i++){var r=se(e);if(r!=="slic"&&e.throwForMissingFeatures)throw new Error("Unknown long");var a=L(e),o=ke(e);t.urlsList.push({id:a,url:o,ref:"slice"})}},function(e,t){var n=t.urlsList;D(e,n.length);for(var i=0;i<n.length;i++)U(e,"slic"),D(e,n[i].id),Me(e,n[i].url)});function pa(e){return{"Top ":e.top,Left:e.left,Btom:e.bottom,Rght:e.right}}function va(e){return{top:e["Top "],left:e.Left,bottom:e.Btom,right:e.Rght}}function An(e,t){return e[Math.max(0,Math.min(e.length-1,t))]}var ma=["autoGenerated","layer","userGenerated"],ga=["noImage","image"],Pn=["default"];te(1050,function(e){return e.slices?e.slices.length:0},function(e,t){var n=L(e);if(n===6){t.slices||(t.slices=[]);var i=_(e),r=_(e),a=_(e),o=_(e),s=ke(e),c=L(e);t.slices.push({bounds:{top:i,left:r,bottom:a,right:o},groupName:s,slices:[]});for(var l=t.slices[t.slices.length-1].slices,u=0;u<c;u++){var d=L(e),p=L(e),f=An(ma,L(e)),m=f=="layer"?L(e):0,v=ke(e),x=An(ga,L(e)),b=_(e),y=_(e),S=_(e),g=_(e),F=ke(e),w=ke(e),k=ke(e),C=ke(e),O=!!T(e),P=ke(e),M=An(Pn,L(e)),j=An(Pn,L(e)),G=T(e),W=T(e),q=T(e),V=T(e),X=G+W+q+V===0?"none":G===0?"matte":"color";l.push({id:d,groupId:p,origin:f,associatedLayerId:m,name:v,target:w,message:k,altTag:C,cellTextIsHTML:O,cellText:P,horizontalAlignment:M,verticalAlignment:j,type:x,url:F,bounds:{top:y,left:b,bottom:g,right:S},backgroundColorType:X,backgroundColor:{r:W,g:q,b:V,a:G}})}var le=Y(e);le.slices.forEach(function(he){var $=l.find(function(ge){return he.sliceID==ge.id});$&&($.topOutset=he.topOutset,$.leftOutset=he.leftOutset,$.bottomOutset=he.bottomOutset,$.rightOutset=he.rightOutset)})}else if(n===7||n===8){var le=Y(e);t.slices||(t.slices=[]),t.slices.push({groupName:le.baseName,bounds:va(le.bounds),slices:le.slices.map(function($){return Pt(Pt({},$["Nm  "]?{name:$["Nm  "]}:{}),{id:$.sliceID,groupId:$.groupID,associatedLayerId:0,origin:aa.decode($.origin),type:na.decode($.Type),bounds:va($.bounds),url:$.url,target:$.null,message:$.Msge,altTag:$.altTag,cellTextIsHTML:$.cellTextIsHTML,cellText:$.cellText,horizontalAlignment:ia.decode($.horzAlign),verticalAlignment:ra.decode($.vertAlign),backgroundColorType:oa.decode($.bgColorType),backgroundColor:$.bgColor?{r:$.bgColor["Rd  "],g:$.bgColor["Grn "],b:$.bgColor["Bl  "],a:$.bgColor.alpha}:{r:0,g:0,b:0,a:0},topOutset:$.topOutset||0,leftOutset:$.leftOutset||0,bottomOutset:$.bottomOutset||0,rightOutset:$.rightOutset||0})})})}else throw new Error("Invalid slices version (".concat(n,")"))},function(e,t,n){var i=t.slices[n],r=i.bounds,a=i.groupName,o=i.slices;D(e,6),H(e,r.top),H(e,r.left),H(e,r.bottom),H(e,r.right),Me(e,a),D(e,o.length);for(var s=0;s<o.length;s++){var c=o[s],l=c.backgroundColor,u=l.a,d=l.r,p=l.g,f=l.b;c.backgroundColorType==="none"?u=d=p=f=0:c.backgroundColorType==="matte"&&(u=0,d=p=f=255),D(e,c.id),D(e,c.groupId),D(e,ma.indexOf(c.origin)),c.origin==="layer"&&D(e,c.associatedLayerId),Me(e,c.name||""),D(e,ga.indexOf(c.type)),H(e,c.bounds.left),H(e,c.bounds.top),H(e,c.bounds.right),H(e,c.bounds.bottom),Me(e,c.url),Me(e,c.target),Me(e,c.message),Me(e,c.altTag),B(e,c.cellTextIsHTML?1:0),Me(e,c.cellText),D(e,Pn.indexOf(c.horizontalAlignment)),D(e,Pn.indexOf(c.verticalAlignment)),B(e,u),B(e,d),B(e,p),B(e,f)}var m={bounds:pa(r),slices:[]};o.forEach(function(v){var x=Pt(Pt({sliceID:v.id,groupID:v.groupId,origin:aa.encode(v.origin),Type:na.encode(v.type),bounds:pa(v.bounds)},v.name?{"Nm  ":v.name}:{}),{url:v.url,null:v.target,Msge:v.message,altTag:v.altTag,cellTextIsHTML:v.cellTextIsHTML,cellText:v.cellText,horzAlign:ia.encode(v.horizontalAlignment),vertAlign:ra.encode(v.verticalAlignment),bgColorType:oa.encode(v.backgroundColorType)});if(v.backgroundColorType==="color"){var b=v.backgroundColor,y=b.r,S=b.g,g=b.b,F=b.a;x.bgColor={"Rd  ":y,"Grn ":S,"Bl  ":g,alpha:F}}x.topOutset=v.topOutset||0,x.leftOutset=v.leftOutset||0,x.bottomOutset=v.bottomOutset||0,x.rightOutset=v.rightOutset||0,m.slices.push(x)}),K(e,"","null",m,"slices")});te(1064,function(e){return e.pixelAspectRatio!==void 0},function(e,t){if(L(e)>2)throw new Error("Invalid pixelAspectRatio version");t.pixelAspectRatio={aspect:ze(e)}},function(e,t){D(e,2),Ke(e,t.pixelAspectRatio.aspect)});te(1041,function(e){return e.iccUntaggedProfile!==void 0},function(e,t){t.iccUntaggedProfile=!!T(e)},function(e,t){B(e,t.iccUntaggedProfile?1:0)});te(1044,function(e){return e.idsSeedNumber!==void 0},function(e,t){return t.idsSeedNumber=L(e)},function(e,t){return D(e,t.idsSeedNumber)});te(1036,function(e){return e.thumbnail!==void 0||e.thumbnailRaw!==void 0},function(e,t,n){var i=L(e),r=L(e),a=L(e);L(e),L(e),L(e);var o=E(e),s=E(e);if(i!==1||o!==24||s!==1){e.logMissingFeatures&&e.log("Invalid thumbnail data (format: ".concat(i,", bitsPerPixel: ").concat(o,", planes: ").concat(s,")")),R(e,n());return}var c=n(),l=Ce(e,c);e.useRawThumbnail?t.thumbnailRaw={width:r,height:a,data:l}:l.byteLength&&(t.thumbnail=rc(l))},function(e,t){var n,i=0,r=0,a=new Uint8Array(0);if(t.thumbnailRaw)i=t.thumbnailRaw.width,r=t.thumbnailRaw.height,a=t.thumbnailRaw.data;else try{var o=(n=t.thumbnail.toDataURL("image/jpeg",1))===null||n===void 0?void 0:n.substring(23);o&&(a=Ei.toByteArray(o),i=t.thumbnail.width,r=t.thumbnail.height)}catch{}var s=24,c=Math.floor((i*s+31)/32)*4,l=1,u=c*r*l,d=a.length;D(e,1),D(e,i),D(e,r),D(e,c),D(e,u),D(e,d),I(e,s),I(e,l),st(e,a)});te(1057,function(e){return e.versionInfo!==void 0},function(e,t,n){var i=L(e);if(i!==1)throw new Error("Invalid versionInfo version");t.versionInfo={hasRealMergedData:!!T(e),writerName:ke(e),readerName:ke(e),fileVersion:L(e)},R(e,n())},function(e,t){var n=t.versionInfo;D(e,1),B(e,n.hasRealMergedData?1:0),Me(e,n.writerName),Me(e,n.readerName),D(e,n.fileVersion)});te(7e3,function(e){return e.imageReadyVariables!==void 0},function(e,t,n){t.imageReadyVariables=Bi(e,n())},function(e,t){_i(e,t.imageReadyVariables)});te(7001,function(e){return e.imageReadyDataSets!==void 0},function(e,t,n){t.imageReadyDataSets=Bi(e,n())},function(e,t){_i(e,t.imageReadyDataSets)});te(1088,function(e){return e.pathSelectionState!==void 0},function(e,t,n){var i=Y(e);t.pathSelectionState=i.null},function(e,t){var n={null:t.pathSelectionState};K(e,"","null",n)});var ba=z("FrmD","",{auto:"Auto",none:"None",dispose:"Disp"});te(4e3,function(e){return e.animations!==void 0},function(e,t,n){var i=se(e);if(i==="mani")vt(e,"IRFR"),Re(e,1,function(a){for(var o=function(){vt(e,"8BIM");var s=se(e);Re(e,1,function(c){if(s==="AnDs"){var l=Y(e);t.animations={frames:l.FrIn.map(function(d){return{id:d.FrID,delay:(d.FrDl||0)/100,dispose:d.FrDs?ba.decode(d.FrDs):"auto"}}),animations:l.FSts.map(function(d){return{id:d.FsID,frames:d.FsFr,repeats:d.LCnt,activeFrame:d.AFrm||0}})}}else if(s==="Roll"){var u=Ce(e,c());e.logDevFeatures&&e.log("#4000 Roll",u)}else e.logMissingFeatures&&e.log("Unhandled subsection in #4000",s)})};a()>0;)o()});else if(i==="mopt"){var r=Ce(e,n());e.logDevFeatures&&e.log("#4000 mopt",r)}else e.logMissingFeatures&&e.log("Unhandled key in #4000:",i)},function(e,t){t.animations&&(U(e,"mani"),U(e,"IRFR"),yt(e,1,function(){U(e,"8BIM"),U(e,"AnDs"),yt(e,1,function(){for(var n={FrIn:[],FSts:[]},i=0;i<t.animations.frames.length;i++){var r=t.animations.frames[i],a={FrID:r.id};r.delay&&(a.FrDl=r.delay*100|0),a.FrDs=ba.encode(r.dispose),n.FrIn.push(a)}for(var i=0;i<t.animations.animations.length;i++){var o=t.animations.animations[i],s={FsID:o.id,AFrm:o.activeFrame|0,FsFr:o.frames,LCnt:o.repeats|0};n.FSts.push(s)}K(e,"","null",n)})}))});var yc=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n},rs=[0,1,3,2],Sc=["bitmap","grayscale","indexed","RGB","CMYK","multichannel","duotone","lab"];function Ai(e){for(var t=e.width*e.height*4,n=0;n<t;n+=4){var i=e.data[n];e.data[n+1]=i,e.data[n+2]=i}}function ya(e,t,n){var i=new DataView(e,t,n);return{view:i,offset:0,strict:!1,debug:!1,large:!1,globalAlpha:!1,log:console.log}}function Pi(e,t){if(e.strict)throw new Error(t);e.debug&&e.log(t)}function T(e){return e.offset+=1,e.view.getUint8(e.offset-1)}function xc(e){return e.view.getUint8(e.offset)}function Q(e){return e.offset+=2,e.view.getInt16(e.offset-2,!1)}function E(e){return e.offset+=2,e.view.getUint16(e.offset-2,!1)}function Fc(e){return e.offset+=2,e.view.getUint16(e.offset-2,!0)}function _(e){return e.offset+=4,e.view.getInt32(e.offset-4,!1)}function Sa(e){return e.offset+=4,e.view.getInt32(e.offset-4,!0)}function L(e){return e.offset+=4,e.view.getUint32(e.offset-4,!1)}function We(e){return e.offset+=4,e.view.getFloat32(e.offset-4,!1)}function ze(e){return e.offset+=8,e.view.getFloat64(e.offset-8,!1)}function De(e){return _(e)/65536}function He(e){return _(e)/(1<<24)}function Ce(e,t){var n=e.view.byteOffset+e.offset;if(e.offset+=t,n+t>e.view.buffer.byteLength){if(Pi(e,"Reading bytes exceeding buffer length"),t>100*1024*1024)throw new Error("Reading past end of file");var i=new Uint8Array(t),r=Math.min(t,e.view.byteLength-n);return r>0&&i.set(new Uint8Array(e.view.buffer,n,r)),i}else return new Uint8Array(e.view.buffer,n,t)}function se(e){return as(e,4)}function kc(e,t){var n=String.fromCharCode(e.view.getUint8(t))+String.fromCharCode(e.view.getUint8(t+1))+String.fromCharCode(e.view.getUint8(t+2))+String.fromCharCode(e.view.getUint8(t+3));return n=="8BIM"||n=="8B64"}function pt(e,t){for(var n=T(e),i=n?as(e,n):"";++n%t;)e.offset++;return i}function ke(e){var t=L(e);return Ni(e,t)}function Ni(e,t){for(var n="";t--;){var i=E(e);(i||t>0)&&(n+=String.fromCharCode(i))}return n}function Cc(e,t){for(var n="";t--;){var i=Fc(e);(i||t>0)&&(n+=String.fromCharCode(i))}return n}function Kn(e,t){for(var n="";t--;)n+=String.fromCharCode(T(e));return n}function R(e,t){e.offset+=t}function vt(e,t,n){var i=e.offset,r=se(e);if(r!==t&&r!==n)throw new Error("Invalid signature: '".concat(r,"' at 0x").concat(i.toString(16)))}function as(e,t){for(var n=Ce(e,t),i="",r=0;r<n.length;r++)i+=String.fromCharCode(n[r]);return i}function Ic(e){return e==="8BIM"||e==="MeSa"||e==="AgHg"||e==="PHUT"||e==="DCSR"}function wc(e,t){var n;t===void 0&&(t={}),vt(e,"8BPS");var i=E(e);if(i!==1&&i!==2)throw new Error("Invalid PSD file version: ".concat(i));R(e,6);var r=E(e),a=L(e),o=L(e),s=E(e),c=E(e),l=i===1?3e4:3e5;if(o>l||a>l)throw new Error("Invalid size: ".concat(o,"x").concat(a));if(r>16)throw new Error("Invalid channel count: ".concat(r));if(![1,8,16,32].includes(s))throw new Error("Invalid bitsPerChannel: ".concat(s));if(rs.indexOf(c)===-1)throw new Error("Color mode not supported: ".concat((n=Sc[c])!==null&&n!==void 0?n:c));var u={width:o,height:a,channels:r,bitsPerChannel:s,colorMode:c};Object.assign(e,t),e.large=i===2,e.globalAlpha=!1,Re(e,1,function(v){if(v()){if(c===2){if(v()!=768)throw new Error("Invalid color palette size");u.palette=[];for(var x=0;x<256;x++)u.palette.push({r:T(e),g:0,b:0});for(var x=0;x<256;x++)u.palette[x].g=T(e);for(var x=0;x<256;x++)u.palette[x].b=T(e)}R(e,v())}});var d={};Re(e,1,function(v){for(var x=function(){os(e,Ic);var b=E(e);pt(e,2),Re(e,2,function(y){var S=is[b],g=b===1036&&!!e.skipThumbnail;if(S&&!g)try{S.read(e,d,y)}catch(F){if(e.throwForMissingFeatures)throw F;R(e,y())}else R(e,y())})};v()>0;)x()}),d.layersGroup,d.layerGroupsEnabledId;var p=yc(d,["layersGroup","layerGroupsEnabledId"]);Object.keys(p)&&(u.imageResources=p),Re(e,1,function(v){if(Re(e,2,function(b){zi(e,u,d),R(e,b())},void 0,e.large),v()>0){var x=Dc(e);x&&(u.globalLayerMaskInfo=x)}else R(e,v());for(;v()>0;){for(;v()&&xc(e)===0;)R(e,1);v()>=12?ss(e,u,u,d):R(e,v())}},void 0,e.large);var f=u.children&&u.children.length,m=e.skipCompositeImageData&&(e.skipLayerImageData||f);return m||Mc(e,u),u}function zi(e,t,n){var i,r,a=n.layersGroup,o=a===void 0?[]:a,s=n.layerGroupsEnabledId,c=s===void 0?[]:s,l=Q(e);l<0&&(e.globalAlpha=!0,l=-l);for(var u=[],d=[],p=0;p<l;p++){var f=Ec(e,t,n),m=f.layer,v=f.channels;o[p]!==void 0&&(m.linkGroup=o[p]),c[p]!==void 0&&(m.linkGroupEnabled=!!c[p]),u.push(m),d.push(v)}if(!e.skipLayerImageData)for(var p=0;p<l;p++)Pc(e,t,u[p],d[p]);t.children||(t.children=[]);for(var x=[t],p=u.length-1;p>=0;p--){var b=u[p],y=b.sectionDivider?b.sectionDivider.type:0;y===1||y===2?(b.opened=y===1,b.children=[],!((i=b.sectionDivider)===null||i===void 0)&&i.key&&(b.blendMode=(r=Rt[b.sectionDivider.key])!==null&&r!==void 0?r:b.blendMode),x[x.length-1].children.unshift(b),x.push(b)):y===3?x.pop():x[x.length-1].children.unshift(b)}}function Ec(e,t,n){var i={};i.top=_(e),i.left=_(e),i.bottom=_(e),i.right=_(e);for(var r=E(e),a=[],o=0;o<r;o++){var s=Q(e),c=L(e);if(e.large){if(c!==0)throw new Error("Sizes larger than 4GB are not supported");c=L(e)}a.push({id:s,length:c})}vt(e,"8BIM");var l=se(e);if(!Rt[l])throw new Error("Invalid blend mode: '".concat(l,"'"));i.blendMode=Rt[l],i.opacity=T(e)/255,i.clipping=T(e)===1;var u=T(e);return i.transparencyProtected=(u&1)!==0,i.hidden=(u&2)!==0,u&32&&(i.effectsOpen=!0),R(e,1),Re(e,1,function(d){Lc(e,i);var p=Ac(e);for(p&&(i.blendingRanges=p),i.name=pt(e,1);d()>4&&!kc(e,e.offset);)e.offset++;for(;d()>=12;)ss(e,i,t,n);R(e,d())}),{layer:i,channels:a}}function Lc(e,t){return Re(e,1,function(n){if(n()){var i={};t.mask=i,i.top=_(e),i.left=_(e),i.bottom=_(e),i.right=_(e),i.defaultColor=T(e);var r=T(e);if(i.positionRelativeToLayer=(r&1)!==0,i.disabled=(r&2)!==0,i.fromVectorData=(r&8)!==0,n()>=18){var a={};t.realMask=a;var o=T(e);a.positionRelativeToLayer=(o&1)!==0,a.disabled=(o&2)!==0,a.fromVectorData=(o&8)!==0,a.defaultColor=T(e),a.top=_(e),a.left=_(e),a.bottom=_(e),a.right=_(e)}if(r&16){var s=T(e);s&1&&(i.userMaskDensity=T(e)/255),s&2&&(i.userMaskFeather=ze(e)),s&4&&(i.vectorMaskDensity=T(e)/255),s&8&&(i.vectorMaskFeather=ze(e))}R(e,n())}})}function Dn(e){return[T(e),T(e),T(e),T(e)]}function Ac(e){return Re(e,1,function(t){for(var n=Dn(e),i=Dn(e),r=[];t()>0;){var a=Dn(e),o=Dn(e);r.push({sourceRange:a,destRange:o})}return{compositeGrayBlendSource:n,compositeGraphBlendDestinationRange:i,ranges:r}})}function Pc(e,t,n,i){var r,a,o,s,c=(n.right||0)-(n.left||0),l=(n.bottom||0)-(n.top||0),u=t.colorMode===4,d;if(c&&l)if(u){if(t.bitsPerChannel!==8)throw new Error("bitsPerChannel Not supproted");d={width:c,height:l,data:new Uint8ClampedArray(c*l*5)};for(var p=4;p<d.data.byteLength;p+=5)d.data[p]=255}else d=Di(c,l,(r=t.bitsPerChannel)!==null&&r!==void 0?r:8),Ii(d);for(var f=0,m=i;f<m.length;f++){var v=m[f];if(v.length!==0){if(v.length<2)throw new Error("Invalid channel length");var x=e.offset,b=E(e);if(b>3&&(e.offset-=1,b=E(e)),b>3&&(e.offset-=3,b=E(e)),b>3)throw new Error("Invalid compression: ".concat(b));if(v.id===-2||v.id===-3){var y=v.id===-2?n.mask:n.realMask;if(!y)throw new Error("Missing layer ".concat(v.id===-2?"mask":"real mask"," data"));var S=(y.right||0)-(y.left||0),g=(y.bottom||0)-(y.top||0);if(S<0||g<0||S>3e4||g>3e4)throw new Error("Invalid mask size");if(S&&g){var F=Di(S,g,(a=t.bitsPerChannel)!==null&&a!==void 0?a:8);Ii(F),e.offset,xa(e,v.length,F,b,S,g,(o=t.bitsPerChannel)!==null&&o!==void 0?o:8,0,e.large,4),Ai(F),e.useImageData?y.imageData=F:y.canvas=wi(F)}}else{var w=nc(v.id,u),k=d;if(w<0&&(k=void 0,e.throwForMissingFeatures))throw new Error("Channel not supported: ".concat(v.id));xa(e,v.length,k,b,c,l,(s=t.bitsPerChannel)!==null&&s!==void 0?s:8,w,e.large,u?5:4),e.offset=x+v.length,k&&t.colorMode===1&&Ai(k)}}}if(d){if(u){var C=d;d=Mi(C.width,C.height),ls(C,d,!1)}e.useImageData?n.imageData=d:n.canvas=wi(d)}}function xa(e,t,n,i,r,a,o,s,c,l){if(i===0)us(e,n,r,a,o,l,s);else if(i===1)Zt(e,n,r,a,o,l,[s],c);else if(i===2)Fa(e,t,n,r,a,o,l,s,!1);else if(i===3)Fa(e,t,n,r,a,o,l,s,!0);else throw new Error("Invalid Compression type: ".concat(i))}function Dc(e){return Re(e,1,function(t){if(t()){var n=E(e),i=E(e),r=E(e),a=E(e),o=E(e),s=E(e)/255,c=T(e);return R(e,t()),{overlayColorSpace:n,colorSpace1:i,colorSpace2:r,colorSpace3:a,colorSpace4:o,opacity:s,kind:c}}})}var Tc=[0,1,-1,2,-2,3,-3,4,-4];function os(e,t){for(var n=e.offset,i="",r=0,a=Tc;r<a.length;r++){var o=a[r];try{e.offset=n+o,i=se(e)}catch{}if(t(i))break}if(!t(i))throw new Error("Invalid signature: '".concat(i,"' at 0x").concat(n.toString(16)));return i}function Oc(e){return e==="8BIM"||e==="8B64"}function ss(e,t,n,i){var r=os(e,Oc),a=se(e),o=r==="8B64"||e.large&&ec.indexOf(a)!==-1;Re(e,2,function(s){var c=jn[a];if(c)try{c.read(e,t,s,n,i)}catch(l){if(e.throwForMissingFeatures)throw l}else e.logMissingFeatures&&e.log("Unhandled additional info: ".concat(a)),R(e,s());s()&&(e.logMissingFeatures&&e.log("Unread ".concat(s()," bytes left for additional info: ").concat(a)),R(e,s()))},!1,o)}function Di(e,t,n,i){if(i===void 0&&(i=4),n===1||n===8)return i===4?Mi(e,t):{width:e,height:t,data:new Uint8ClampedArray(e*t*i)};if(n===16)return{width:e,height:t,data:new Uint16Array(e*t*i)};if(n===32)return{width:e,height:t,data:new Float32Array(e*t*i)};throw new Error("Invalid bitDepth (".concat(n,")"))}function Mc(e,t){var n,i=E(e),r=(n=t.bitsPerChannel)!==null&&n!==void 0?n:8;if(rs.indexOf(t.colorMode)===-1)throw new Error("Color mode not supported: ".concat(t.colorMode));if(i!==0&&i!==1)throw new Error("Compression type not supported: ".concat(i));var a=Di(t.width,t.height,r);switch(Ii(a),t.colorMode){case 0:{if(r!==1)throw new Error("Invalid bitsPerChannel for bitmap color mode");var o=void 0;if(i===0)o=Ce(e,Math.ceil(t.width/8)*t.height);else if(i===1)o=new Uint8Array(t.width*t.height),Zt(e,{data:o,width:t.width,height:t.height},t.width,t.height,8,1,[0],e.large);else throw new Error("Bitmap compression not supported: ".concat(i));ic(o,a.data,t.width,t.height);break}case 3:case 1:{var s=t.colorMode===1?[0]:[0,1,2];if(t.channels&&t.channels>3)for(var c=3;c<t.channels;c++)s.push(c);else e.globalAlpha&&s.push(3);if(i===0)for(var c=0;c<s.length;c++)us(e,a,t.width,t.height,r,4,s[c]);else i===1&&(e.offset,Zt(e,a,t.width,t.height,r,4,s,e.large));t.colorMode===1&&Ai(a);break}case 2:{if(r!==8)throw new Error("bitsPerChannel Not supproted");if(t.channels!==1)throw new Error("Invalid channel count");if(!t.palette)throw new Error("Missing color palette");if(i===0)throw new Error("Not implemented");if(i===1){var l={width:a.width,height:a.height,data:new Uint8Array(a.width*a.height)};Zt(e,l,t.width,t.height,r,1,[0],e.large),Rc(l,a,t.palette)}else throw new Error("Not implemented");break}case 4:{if(r!==8)throw new Error("bitsPerChannel Not supproted");if(t.channels!==4)throw new Error("Invalid channel count");var s=[0,1,2,3];if(e.globalAlpha&&s.push(4),i===0)throw new Error("Not implemented");if(i===1){var u={width:a.width,height:a.height,data:new Uint8Array(a.width*a.height*5)};e.offset,Zt(e,u,t.width,t.height,r,5,s,e.large),ls(u,a,!0)}else throw new Error("Not implemented");break}default:throw new Error("Color mode not supported: ".concat(t.colorMode))}if(e.globalAlpha){if(t.bitsPerChannel!==8)throw new Error("bitsPerChannel Not supproted");for(var d=a.data,p=a.width*a.height*4,c=0;c<p;c+=4){var f=d[c+3];if(f!=0&&f!=255){var m=f/255,v=1/m,x=255*(1-v);d[c+0]=d[c+0]*v+x,d[c+1]=d[c+1]*v+x,d[c+2]=d[c+2]*v+x}}}e.useImageData?t.imageData=a:t.canvas=wi(a)}function ls(e,t,n){for(var i=t.width*t.height*4,r=e.data,a=t.data,o=0,s=0;s<i;o+=5,s+=4){var c=r[o],l=r[o+1],u=r[o+2],d=r[o+3];a[s]=(c*d|0)/255|0,a[s+1]=(l*d|0)/255|0,a[s+2]=(u*d|0)/255|0,a[s+3]=n?255-r[o+4]:r[o+4]}}function Rc(e,t,n){for(var i=e.width*e.height,r=e.data,a=t.data,o=0,s=0;o<i;o++,s+=4){var c=n[r[o]];a[s+0]=c.r,a[s+1]=c.g,a[s+2]=c.b,a[s+3]=255}}function Bc(e,t){if(e.byteLength/e.length!==t.byteLength/t.length)throw new Error("Invalid array types")}function cs(e,t){if(t===8)return e;if(t===16)if(e.byteOffset%2){var n=new Uint16Array(e.byteLength/2);return new Uint8Array(n.buffer,n.byteOffset,n.byteLength).set(e),n}else return new Uint16Array(e.buffer,e.byteOffset,e.byteLength/2);else if(t===32)if(e.byteOffset%4){var n=new Float32Array(e.byteLength/4);return new Uint8Array(n.buffer,n.byteOffset,n.byteLength).set(e),n}else return new Float32Array(e.buffer,e.byteOffset,e.byteLength/4);else throw new Error("Invalid bitDepth (".concat(t,")"))}function Ti(e,t,n,i){Bc(e.data,t);for(var r=e.width*e.height,a=e.data,o=0,s=n|0;o<r;o++,s=s+i|0)a[s]=t[o]}function us(e,t,n,i,r,a,o){var s=Ce(e,n*i*Math.floor(r/8));if(r==32)for(var c=0;c<s.byteLength;c+=4){var l=s[c+0],u=s[c+1],d=s[c+2],p=s[c+3];s[c+0]=p,s[c+1]=d,s[c+2]=u,s[c+3]=l}var f=cs(s,r);t&&o<a&&Ti(t,f,o,a)}function di(e,t,n,i){for(var r=0;r<n;r++)for(var a=r*t,o=1,s=a+1;o<t;o++,s++)e[s]=(e[s-1]+e[s])%i}function Fa(e,t,n,i,r,a,o,s,c){var l=Ce(e,t),u=Xl(l);if(n&&s<o){var d=cs(u,a);if(a===8)c&&di(u,i,r,256),Ti(n,u,s,o);else if(a===16)c&&di(d,i,r,65536),Ti(n,d,s,o);else if(a===32){c&&di(u,i*4,r,256);for(var p=s,f=new Uint32Array(n.data.buffer,n.data.byteOffset,n.data.length),m=0;m<r;m++)for(var v=i*4*m,x=0;x<i;x++,v++,p+=o){var b=v+i,y=b+i,S=y+i;f[p]=(u[v]<<24|u[b]<<16|u[y]<<8|u[S])>>>0}}else throw new Error("Invalid bitDepth")}}function Zt(e,t,n,i,r,a,o,s){var c=t&&t.data,l;if(s){l=new Uint32Array(o.length*i);for(var u=0,d=0;u<o.length;u++)for(var p=0;p<i;p++,d++)l[d]=L(e)}else{l=new Uint16Array(o.length*i);for(var u=0,d=0;u<o.length;u++)for(var p=0;p<i;p++,d++)l[d]=E(e)}if(r!==1&&r!==8)throw new Error("Invalid bit depth (".concat(r,")"));for(var f=a-1|0,m=0,d=0;m<o.length;m++){var v=o[m]|0,x=m>f||v>f;if(!c||x)for(var p=0;p<i;p++,d++)R(e,l[d]);else for(var p=0,b=v|0;p<i;p++,d++)for(var y=l[d],S=Ce(e,y),g=0,F=0;g<y;g++){var w=S[g];if(w>128){var k=S[++g];w=256-w|0;for(var C=0;C<=w&&F<n;C=C+1|0,F=F+1|0)c[b]=k,b=b+a|0}else if(w<128)for(var C=0;C<=w&&F<n;C=C+1|0,F=F+1|0)c[b]=S[++g],b=b+a|0}}}function Re(e,t,n,i,r){i===void 0&&(i=!0),r===void 0&&(r=!1);var a=L(e);if(r){if(a!==0)throw new Error("Sizes larger than 4GB are not supported");a=L(e)}if(!(a<=0&&i)){var o=e.offset+a;if(o>e.view.byteLength)throw new Error("Section exceeds file size");var s=n(function(){return o-e.offset});for(e.offset!==o&&(e.offset>o?Pi(e,"Exceeded section limits"):Pi(e,"Unread section data"));a%t;)a++,o++;return e.offset=o,s}}function Se(e){var t=E(e);switch(t){case 0:{var n=E(e)/257,i=E(e)/257,r=E(e)/257;return R(e,2),{r:n,g:i,b:r}}case 1:{var a=E(e)/65535,o=E(e)/65535,r=E(e)/65535;return R(e,2),{h:a,s:o,b:r}}case 2:{var s=E(e)/257,c=E(e)/257,l=E(e)/257,u=E(e)/257;return{c:s,m:c,y:l,k:u}}case 7:{var d=Q(e)/1e4,p=Q(e),f=Q(e),m=p<0?p/12800:p/12700,r=f<0?f/12800:f/12700;return R(e,2),{l:d,a:m,b:r}}case 8:{var u=E(e)*255/1e4;return R(e,6),{k:u}}default:throw new Error("Invalid color space")}}var fs=[void 0,"outer bevel","inner bevel","emboss","pillow emboss","stroke emboss"];function wt(e){return vt(e,"8BIM"),Rt[se(e)]||"normal"}function Lt(e,t){U(e,"8BIM"),U(e,ro[t]||"norm")}function Et(e){return T(e)/255}function At(e,t){B(e,Math.round(t*255)|0)}function _c(e){var t=E(e);if(t!==0)throw new Error("Invalid effects layer version: ".concat(t));for(var n=E(e),i={},r=0;r<n;r++){vt(e,"8BIM");var a=se(e);switch(a){case"cmnS":{var o=L(e),s=L(e),c=!!T(e);if(R(e,2),o!==7||s!==0||!c)throw new Error("Invalid effects common state");break}case"dsdw":case"isdw":{var l=L(e),u=L(e);if(l!==41&&l!==51)throw new Error("Invalid shadow size: ".concat(l));if(u!==0&&u!==2)throw new Error("Invalid shadow version: ".concat(u));var o=De(e);De(e);var d=De(e),p=De(e),f=Se(e),m=wt(e),v=!!T(e),x=!!T(e),b=Et(e);l>=51&&Se(e);var y={size:{units:"Pixels",value:o},distance:{units:"Pixels",value:p},angle:d,color:f,blendMode:m,enabled:v,useGlobalLight:x,opacity:b};a==="dsdw"?i.dropShadow=[y]:i.innerShadow=[y];break}case"oglw":{var l=L(e),S=L(e);if(l!==32&&l!==42)throw new Error("Invalid outer glow size: ".concat(l));if(S!==0&&S!==2)throw new Error("Invalid outer glow version: ".concat(S));var o=De(e);De(e);var f=Se(e),m=wt(e),v=!!T(e),b=Et(e);l>=42&&Se(e),i.outerGlow={size:{units:"Pixels",value:o},color:f,blendMode:m,enabled:v,opacity:b};break}case"iglw":{var l=L(e),g=L(e);if(l!==32&&l!==43)throw new Error("Invalid inner glow size: ".concat(l));if(g!==0&&g!==2)throw new Error("Invalid inner glow version: ".concat(g));var o=De(e);De(e);var f=Se(e),m=wt(e),v=!!T(e),b=Et(e);l>=43&&(T(e),Se(e)),i.innerGlow={size:{units:"Pixels",value:o},color:f,blendMode:m,enabled:v,opacity:b};break}case"bevl":{var l=L(e),F=L(e);if(l!==58&&l!==78)throw new Error("Invalid bevel size: ".concat(l));if(F!==0&&F!==2)throw new Error("Invalid bevel version: ".concat(F));var d=De(e),w=De(e),o=De(e),k=wt(e),C=wt(e),O=Se(e),P=Se(e),M=fs[T(e)]||"inner bevel",j=Et(e),G=Et(e),v=!!T(e),x=!!T(e),W=T(e)?"down":"up";l>=78&&(Se(e),Se(e)),i.bevel={size:{units:"Pixels",value:o},angle:d,strength:w,highlightBlendMode:k,shadowBlendMode:C,highlightColor:O,shadowColor:P,style:M,highlightOpacity:j,shadowOpacity:G,enabled:v,useGlobalLight:x,direction:W};break}case"sofi":{var o=L(e),q=L(e);if(o!==34)throw new Error("Invalid effects solid fill info size: ".concat(o));if(q!==2)throw new Error("Invalid effects solid fill info version: ".concat(q));var m=wt(e),f=Se(e),b=Et(e),v=!!T(e);Se(e),i.solidFill=[{blendMode:m,color:f,opacity:b,enabled:v}];break}default:throw new Error("Invalid effect type: '".concat(a,"'"))}}return i}function ka(e,t){var n;D(e,51),D(e,2),Oe(e,t.size&&t.size.value||0),Oe(e,0),Oe(e,t.angle||0),Oe(e,t.distance&&t.distance.value||0),Fe(e,t.color),Lt(e,t.blendMode),B(e,t.enabled?1:0),B(e,t.useGlobalLight?1:0),At(e,(n=t.opacity)!==null&&n!==void 0?n:1),Fe(e,t.color)}function Nc(e,t){var n,i,r,a,o,s,c=(n=t.dropShadow)===null||n===void 0?void 0:n[0],l=(i=t.innerShadow)===null||i===void 0?void 0:i[0],u=t.outerGlow,d=t.innerGlow,p=t.bevel,f=(r=t.solidFill)===null||r===void 0?void 0:r[0],m=1;if(c&&m++,l&&m++,u&&m++,d&&m++,p&&m++,f&&m++,I(e,0),I(e,m),U(e,"8BIM"),U(e,"cmnS"),D(e,7),D(e,0),B(e,1),re(e,2),c&&(U(e,"8BIM"),U(e,"dsdw"),ka(e,c)),l&&(U(e,"8BIM"),U(e,"isdw"),ka(e,l)),u&&(U(e,"8BIM"),U(e,"oglw"),D(e,42),D(e,2),Oe(e,((a=u.size)===null||a===void 0?void 0:a.value)||0),Oe(e,0),Fe(e,u.color),Lt(e,u.blendMode),B(e,u.enabled?1:0),At(e,u.opacity||0),Fe(e,u.color)),d&&(U(e,"8BIM"),U(e,"iglw"),D(e,43),D(e,2),Oe(e,((o=d.size)===null||o===void 0?void 0:o.value)||0),Oe(e,0),Fe(e,d.color),Lt(e,d.blendMode),B(e,d.enabled?1:0),At(e,d.opacity||0),B(e,0),Fe(e,d.color)),p){U(e,"8BIM"),U(e,"bevl"),D(e,78),D(e,2),Oe(e,p.angle||0),Oe(e,p.strength||0),Oe(e,((s=p.size)===null||s===void 0?void 0:s.value)||0),Lt(e,p.highlightBlendMode),Lt(e,p.shadowBlendMode),Fe(e,p.highlightColor),Fe(e,p.shadowColor);var v=fs.indexOf(p.style);B(e,v<=0?1:v),At(e,p.highlightOpacity||0),At(e,p.shadowOpacity||0),B(e,p.enabled?1:0),B(e,p.useGlobalLight?1:0),B(e,p.direction==="down"?1:0),Fe(e,p.highlightColor),Fe(e,p.shadowColor)}f&&(U(e,"8BIM"),U(e,"sofi"),D(e,34),D(e,2),Lt(e,f.blendMode),Fe(e,f.color),At(e,f.opacity||0),B(e,f.enabled?1:0),Fe(e,f.color))}function Ca(e){return e===32||e===10||e===13||e===9}function Ia(e){return e>=48&&e<=57||e===46||e===45}function ds(e){var t=0;function n(){for(;t<e.length&&Ca(e[t]);)t++}function i(){var y=e[t];return t++,y===92&&(y=e[t],t++),y}function r(){var y="";if(e[t]===41)return t++,y;if(e[t]!==254||e[t+1]!==255)throw new Error("Invalid utf-16 BOM");for(t+=2;t<e.length&&e[t]!==41;){var S=i(),g=i(),F=S<<8|g;y+=String.fromCharCode(F)}return t++,y}var a=null,o=[];function s(y){o.length?(c(y),o.push(y)):(o.push(y),a=y)}function c(y){if(!o.length)throw new Error("Invalid data");var S=o[o.length-1];if(typeof S=="string")o[o.length-2][S]=y,u();else if(Array.isArray(S))S.push(y);else throw new Error("Invalid data")}function l(y){o.length||s({});var S=o[o.length-1];if(S&&typeof S=="string")c(y==="nil"?null:"/".concat(y));else if(S&&typeof S=="object")o.push(y);else throw new Error("Invalid data")}function u(){if(!o.length)throw new Error("Invalid data");o.pop()}n();for(var d=e.length;d>0&&e[d-1]===0;)d--;for(;t<d;){var p=t,f=e[p];if(f===60&&e[p+1]===60)t+=2,s({});else if(f===62&&e[p+1]===62)t+=2,u();else if(f===47){t+=1;for(var m=t;t<e.length&&!Ca(e[t]);)t++;for(var v="",x=m;x<t;x++)v+=String.fromCharCode(e[x]);l(v)}else if(f===40)t+=1,c(r());else if(f===91)t+=1,s([]);else if(f===93)t+=1,u();else if(f===110&&e[p+1]===117&&e[p+2]===108&&e[p+3]===108)t+=4,c(null);else if(f===116&&e[p+1]===114&&e[p+2]===117&&e[p+3]===101)t+=4,c(!0);else if(f===102&&e[p+1]===97&&e[p+2]===108&&e[p+3]===115&&e[p+4]===101)t+=5,c(!1);else if(Ia(f)){for(var b="";t<e.length&&Ia(e[t]);)b+=String.fromCharCode(e[t]),t++;c(parseFloat(b))}else t+=1,console.log("Invalid token '".concat(String.fromCharCode(f),"' (").concat(f,") at ").concat(t));n()}return a}var zc=["Axis","XY","Zone","WordSpacing","FirstLineIndent","GlyphSpacing","StartIndent","EndIndent","SpaceBefore","SpaceAfter","LetterSpacing","Values","GridSize","GridLeading","PointBase","BoxBounds","TransformPoint0","TransformPoint1","TransformPoint2","FontSize","Leading","HorizontalScale","VerticalScale","BaselineShift","Tsume","OutlineWidth","AutoLeading"],Gc=["RunLengthArray"];function Uc(e,t){t===void 0&&(t=!1);var n=new Uint8Array(1024),i=0,r=0;function a(y){if(i>=n.length){var S=new Uint8Array(n.length*2);S.set(n),n=S}n[i]=y,i++}function o(y){for(var S=0;S<y.length;S++)a(y.charCodeAt(S))}function s(){if(t)o(" ");else for(var y=0;y<r;y++)o("	")}function c(y,S){s(),o("/".concat(y)),m(S,y,!0),t||o(`
`)}function l(y){return y.toString()}function u(y){return y.toFixed(5).replace(/(\d)0+$/g,"$1").replace(/^0+\.([1-9])/g,".$1").replace(/^-0+\.0(\d)/g,"-.0$1")}function d(y,S){var g=S&&zc.indexOf(S)!==-1||(y|0)!==y;return g?u(y):l(y)}function p(y){var S=Object.keys(y);return S.indexOf("98")!==-1&&S.unshift.apply(S,S.splice(S.indexOf("99"),1)),S.indexOf("99")!==-1&&S.unshift.apply(S,S.splice(S.indexOf("99"),1)),S}function f(y){(y===40||y===41||y===92)&&a(92),a(y)}function m(y,S,g){g===void 0&&(g=!1);function F(){g?o(" "):s()}if(y===null)F(),o(t?"/nil":"null");else if(typeof y=="number")F(),o(d(y,S));else if(typeof y=="boolean")F(),o(y?"true":"false");else if(typeof y=="string")if(F(),(S==="99"||S==="98")&&y.charAt(0)==="/")o(y);else{o("("),a(254),a(255);for(var w=0;w<y.length;w++){var k=y.charCodeAt(w);f(k>>8&255),f(k&255)}o(")")}else if(Array.isArray(y))if(F(),y.every(function(X){return typeof X=="number"})){o("[");for(var C=Gc.indexOf(S)!==-1,O=0,P=y;O<P.length;O++){var M=P[O];o(" "),o(C?d(M):u(M))}o(" ]")}else{o("["),t||o(`
`);for(var j=0,G=y;j<G.length;j++){var M=G[j];m(M,S),t||o(`
`)}s(),o("]")}else if(typeof y=="object"){g&&!t&&o(`
`),s(),o("<<"),t||o(`
`),r++;for(var W=0,q=p(y);W<q.length;W++){var V=q[W];c(V,y[V])}r--,s(),o(">>")}}if(t){if(typeof e=="object")for(var v=0,x=p(e);v<x.length;v++){var b=x[v];c(b,e[b])}}else o(`

`),m(e);return n.slice(0,i)}var ve=function(){return ve=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},ve.apply(this,arguments)},hs={name:"MyriadPro-Regular",script:0,type:0,synthetic:0},Tn={justification:"left",firstLineIndent:0,startIndent:0,endIndent:0,spaceBefore:0,spaceAfter:0,autoHyphenate:!0,hyphenatedWordSize:6,preHyphen:2,postHyphen:2,consecutiveHyphens:8,zone:36,wordSpacing:[.8,1,1.33],letterSpacing:[0,0,0],glyphSpacing:[1,1,1],autoLeading:1.2,leadingType:0,hanging:!1,burasagari:!1,kinsokuOrder:0,everyLineComposer:!1},Vc={font:hs,fontSize:12,fauxBold:!1,fauxItalic:!1,autoLeading:!0,leading:0,horizontalScale:1,verticalScale:1,tracking:0,autoKerning:!0,kerning:0,baselineShift:0,fontCaps:0,fontBaseline:0,underline:!1,strikethrough:!1,ligatures:!0,dLigatures:!1,baselineDirection:2,tsume:0,styleRunAlignment:2,language:0,noBreak:!1,fillColor:{r:0,g:0,b:0},strokeColor:{r:0,g:0,b:0},fillFlag:!0,strokeFlag:!1,fillFirst:!0,yUnderline:1,outlineWidth:1,characterDirection:0,hindiNumbers:!1,kashida:1,diacriticPos:2},Hc={isOn:!1,show:!1,size:18,leading:22,color:{r:0,g:0,b:255},leadingFillColor:{r:0,g:0,b:255},alignLineHeightToGridFlags:!1},Gi=["justification","firstLineIndent","startIndent","endIndent","spaceBefore","spaceAfter","autoHyphenate","hyphenatedWordSize","preHyphen","postHyphen","consecutiveHyphens","zone","wordSpacing","letterSpacing","glyphSpacing","autoLeading","leadingType","hanging","burasagari","kinsokuOrder","everyLineComposer"],Ui=["font","fontSize","fauxBold","fauxItalic","autoLeading","leading","horizontalScale","verticalScale","tracking","autoKerning","kerning","baselineShift","fontCaps","fontBaseline","underline","strikethrough","ligatures","dLigatures","baselineDirection","tsume","styleRunAlignment","language","noBreak","fillColor","strokeColor","fillFlag","strokeFlag","fillFirst","yUnderline","outlineWidth","characterDirection","hindiNumbers","kashida","diacriticPos"],ps=["none","crisp","strong","smooth","sharp"],vs=["left","right","center","justify-left","justify-right","justify-center","justify-all"];function ms(e){return e.substring(0,1).toUpperCase()+e.substring(1)}function jc(e){var t=e.Values;switch(e.Type){case 0:return{k:t[1]*255};case 1:return t[0]===1?{r:t[1]*255,g:t[2]*255,b:t[3]*255}:{r:t[1]*255,g:t[2]*255,b:t[3]*255,a:t[0]*255};case 2:return{c:t[1]*255,m:t[2]*255,y:t[3]*255,k:t[4]*255};default:throw new Error("Unknown color type in text layer")}}function Oi(e){if(e){if("r"in e)return{Type:1,Values:["a"in e?e.a/255:1,e.r/255,e.g/255,e.b/255]};if("c"in e)return{Type:2,Values:[1,e.c/255,e.m/255,e.y/255,e.k/255]};if("k"in e)return{Type:0,Values:[1,e.k/255]};throw new Error("Invalid color type in text layer")}else return{Type:1,Values:[0,0,0,0]}}function wa(e,t){if(!e||!t||e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Ea(e,t){if(!e||!t)return!1;for(var n=0,i=Object.keys(e);n<i.length;n++){var r=i[n];if(e[r]!==t[r])return!1}for(var a=0,o=Object.keys(t);a<o.length;a++){var r=o[a];if(e[r]!==t[r])return!1}return!0}function Wc(e,t){for(var n=0;n<e.length;n++)if(e[n].name===t.name)return n;return e.push(t),e.length-1}function gs(e,t,n){for(var i={},r=0,a=t;r<a.length;r++){var o=a[r],s=ms(o);e[s]!==void 0&&(o==="justification"?i[o]=vs[e[s]]:o==="font"?i[o]=n[e[s]]:o==="fillColor"||o==="strokeColor"?i[o]=jc(e[s]):i[o]=e[s])}return i}function bs(e,t,n){for(var i,r={},a=0,o=t;a<o.length;a++){var s=o[a],c=ms(s);e[s]!==void 0&&(s==="justification"?r[c]=vs.indexOf((i=e[s])!==null&&i!==void 0?i:"left"):s==="font"?r[c]=Wc(n,e[s]):s==="fillColor"||s==="strokeColor"?r[c]=Oi(e[s]):r[c]=e[s])}return r}function Xc(e,t){return gs(e,Gi,t)}function qc(e,t){return gs(e,Ui,t)}function On(e,t){return bs(e,Gi,t)}function hi(e,t){return bs(e,Ui,t)}function La(e,t,n){if(t.length){for(var i=function(s){var c=t[0].style[s];if(c!==void 0){var l=!1;Array.isArray(c)?l=t.every(function(v){return wa(v.style[s],c)}):typeof c=="object"?l=t.every(function(v){return Ea(v.style[s],c)}):l=t.every(function(v){return v.style[s]===c}),l&&(e[s]=c)}var u=e[s];if(u!==void 0)for(var d=0,p=t;d<p.length;d++){var f=p[d],m=!1;Array.isArray(c)?m=wa(f.style[s],c):typeof c=="object"?m=Ea(f.style[s],c):m=f.style[s]===c,m&&delete f.style[s]}},r=0,a=n;r<a.length;r++){var o=a[r];i(o)}t.every(function(s){return Object.keys(s.style).length===0})&&(t.length=0)}}function $c(e){for(var t,n,i,r,a,o,s=e.EngineDict,c=e.ResourceDict,l=c.FontSet.map(function(w){return{name:w.Name,script:w.Script,type:w.FontType,synthetic:w.Synthetic}}),u=s.Editor.Text.replace(/\r/g,`
`),d=0;/\n$/.test(u);)u=u.substring(0,u.length-1),d++;var p={text:u,antiAlias:(t=ps[s.AntiAlias])!==null&&t!==void 0?t:"smooth",useFractionalGlyphWidths:!!s.UseFractionalGlyphWidths,superscriptSize:c.SuperscriptSize,superscriptPosition:c.SuperscriptPosition,subscriptSize:c.SubscriptSize,subscriptPosition:c.SubscriptPosition,smallCapSize:c.SmallCapSize},f=(o=(a=(r=(i=(n=s.Rendered)===null||n===void 0?void 0:n.Shapes)===null||i===void 0?void 0:i.Children)===null||r===void 0?void 0:r[0])===null||a===void 0?void 0:a.Cookie)===null||o===void 0?void 0:o.Photoshop;f&&(p.shapeType=f.ShapeType===1?"box":"point",f.PointBase&&(p.pointBase=f.PointBase),f.BoxBounds&&(p.boxBounds=f.BoxBounds));var m=s.ParagraphRun;p.paragraphStyle={},p.paragraphStyleRuns=[];for(var v=0;v<m.RunArray.length;v++){var x=m.RunArray[v],b=m.RunLengthArray[v],y=Xc(x.ParagraphSheet.Properties,l);p.paragraphStyleRuns.push({length:b,style:y})}for(var S=d;p.paragraphStyleRuns.length&&S>0;S--)--p.paragraphStyleRuns[p.paragraphStyleRuns.length-1].length===0&&p.paragraphStyleRuns.pop();La(p.paragraphStyle,p.paragraphStyleRuns,Gi),p.paragraphStyleRuns.length||delete p.paragraphStyleRuns;var g=s.StyleRun;p.style={},p.styleRuns=[];for(var v=0;v<g.RunArray.length;v++){var F=g.RunLengthArray[v],y=qc(g.RunArray[v].StyleSheet.StyleSheetData,l);y.font||(y.font=l[0]),p.styleRuns.push({length:F,style:y})}for(var S=d;p.styleRuns.length&&S>0;S--)--p.styleRuns[p.styleRuns.length-1].length===0&&p.styleRuns.pop();return La(p.style,p.styleRuns,Ui),p.styleRuns.length||delete p.styleRuns,p}function Zc(e){var t,n,i,r,a,o,s,c,l,u,d,p,f="".concat((e.text||"").replace(/\r?\n/g,"\r"),"\r"),m=[{name:"AdobeInvisFont",script:0,type:0,synthetic:0}],v=((t=e.style)===null||t===void 0?void 0:t.font)||((i=(n=e.styleRuns)===null||n===void 0?void 0:n.find(function(Z){return Z.style.font}))===null||i===void 0?void 0:i.style.font)||hs,x=[],b=[],y=e.paragraphStyleRuns;if(y&&y.length){for(var S=f.length,g=0,F=y;g<F.length;g++){var w=F[g],k=Math.min(w.length,S);S-=k,k&&(S===1&&w===y[y.length-1]&&(k++,S--),b.push(k),x.push({ParagraphSheet:{DefaultStyleSheet:0,Properties:On(ve(ve(ve({},Tn),e.paragraphStyle),w.style),m)},Adjustments:{Axis:[1,0,1],XY:[0,0]}}))}S&&(b.push(S),x.push({ParagraphSheet:{DefaultStyleSheet:0,Properties:On(ve(ve({},Tn),e.paragraphStyle),m)},Adjustments:{Axis:[1,0,1],XY:[0,0]}}))}else for(var C=0,O=0;C<f.length;C++)f.charCodeAt(C)===13&&(b.push(C-O+1),x.push({ParagraphSheet:{DefaultStyleSheet:0,Properties:On(ve(ve({},Tn),e.paragraphStyle),m)},Adjustments:{Axis:[1,0,1],XY:[0,0]}}),O=C+1);for(var P=hi(ve(ve({},Vc),{font:v}),m),M=e.styleRuns||[{length:f.length,style:e.style||{}}],j=[],G=[],W=f.length,q=0,V=M;q<V.length;q++){var X=V[q],k=Math.min(X.length,W);W-=k,k&&(W===1&&X===M[M.length-1]&&(k++,W--),G.push(k),j.push({StyleSheet:{StyleSheetData:hi(ve(ve({kerning:0,autoKerning:!0,fillColor:{r:0,g:0,b:0}},e.style),X.style),m)}}))}W&&M.length&&(G.push(W),j.push({StyleSheet:{StyleSheetData:hi(ve({kerning:0,autoKerning:!0,fillColor:{r:0,g:0,b:0}},e.style),m)}}));var le=ve(ve({},Hc),e.gridInfo),he=e.orientation==="vertical"?2:0,$=e.orientation==="vertical"?1:0,ge=e.shapeType==="box"?1:0,Ue={ShapeType:ge};ge===0?Ue.PointBase=e.pointBase||[0,0]:Ue.BoxBounds=e.boxBounds||[0,0,0,0],Ue.Base={ShapeType:ge,TransformPoint0:[1,0],TransformPoint1:[0,1],TransformPoint2:[0,0]};var ct={KinsokuSet:[{Name:"PhotoshopKinsokuHard",NoStart:"、。，．・：；？！ー―’”）〕］｝〉》」』】ヽヾゝゞ々ぁぃぅぇぉっゃゅょゎァィゥェォッャュョヮヵヶ゛゜?!)]},.:;℃℉¢％‰",NoEnd:"‘“（〔［｛〈《「『【([{￥＄£＠§〒＃",Keep:"―‥",Hanging:"、。.,"},{Name:"PhotoshopKinsokuSoft",NoStart:"、。，．・：；？！’”）〕］｝〉》」』】ヽヾゝゞ々",NoEnd:"‘“（〔［｛〈《「『【",Keep:"―‥",Hanging:"、。.,"}],MojiKumiSet:[{InternalName:"Photoshop6MojiKumiSet1"},{InternalName:"Photoshop6MojiKumiSet2"},{InternalName:"Photoshop6MojiKumiSet3"},{InternalName:"Photoshop6MojiKumiSet4"}],TheNormalStyleSheet:0,TheNormalParagraphSheet:0,ParagraphSheetSet:[{Name:"Normal RGB",DefaultStyleSheet:0,Properties:On(ve(ve({},Tn),e.paragraphStyle),m)}],StyleSheetSet:[{Name:"Normal RGB",StyleSheetData:P}],FontSet:m.map(function(Z){return{Name:Z.name,Script:Z.script||0,FontType:Z.type||0,Synthetic:Z.synthetic||0}}),SuperscriptSize:(r=e.superscriptSize)!==null&&r!==void 0?r:.583,SuperscriptPosition:(a=e.superscriptPosition)!==null&&a!==void 0?a:.333,SubscriptSize:(o=e.subscriptSize)!==null&&o!==void 0?o:.583,SubscriptPosition:(s=e.subscriptPosition)!==null&&s!==void 0?s:.333,SmallCapSize:(c=e.smallCapSize)!==null&&c!==void 0?c:.7},J={EngineDict:{Editor:{Text:f},ParagraphRun:{DefaultRunData:{ParagraphSheet:{DefaultStyleSheet:0,Properties:{}},Adjustments:{Axis:[1,0,1],XY:[0,0]}},RunArray:x,RunLengthArray:b,IsJoinable:1},StyleRun:{DefaultRunData:{StyleSheet:{StyleSheetData:{}}},RunArray:j,RunLengthArray:G,IsJoinable:2},GridInfo:{GridIsOn:!!le.isOn,ShowGrid:!!le.show,GridSize:(l=le.size)!==null&&l!==void 0?l:18,GridLeading:(u=le.leading)!==null&&u!==void 0?u:22,GridColor:Oi(le.color),GridLeadingFillColor:Oi(le.color),AlignLineHeightToGridFlags:!!le.alignLineHeightToGridFlags},AntiAlias:ps.indexOf((d=e.antiAlias)!==null&&d!==void 0?d:"sharp"),UseFractionalGlyphWidths:(p=e.useFractionalGlyphWidths)!==null&&p!==void 0?p:!0,Rendered:{Version:1,Shapes:{WritingDirection:he,Children:[{ShapeType:ge,Procession:$,Lines:{WritingDirection:he,Children:[]},Cookie:{Photoshop:Ue}}]}}},ResourceDict:ve({},ct),DocumentResources:ve({},ct)};return J}var pi={0:{uproot:!0,children:{0:{name:"Type"},1:{name:"Values"}}}},Vi={0:{name:"Font"},1:{name:"FontSize"},2:{name:"FauxBold"},3:{name:"FauxItalic"},4:{name:"AutoLeading"},5:{name:"Leading"},6:{name:"HorizontalScale"},7:{name:"VerticalScale"},8:{name:"Tracking"},9:{name:"BaselineShift"},11:{name:"Kerning?"},12:{name:"FontCaps"},13:{name:"FontBaseline"},15:{name:"Strikethrough?"},16:{name:"Underline?"},18:{name:"Ligatures"},19:{name:"DLigatures"},23:{name:"Fractions"},24:{name:"Ordinals"},28:{name:"StylisticAlternates"},30:{name:"OldStyle?"},35:{name:"BaselineDirection"},38:{name:"Language"},52:{name:"NoBreak"},53:{name:"FillColor",children:pi},54:{name:"StrokeColor",children:pi},55:{children:{99:{uproot:!0}}},79:{children:pi}},vi={0:{name:"Justification"},1:{name:"FirstLineIndent"},2:{name:"StartIndent"},3:{name:"EndIndent"},4:{name:"SpaceBefore"},5:{name:"SpaceAfter"},7:{name:"AutoLeading"},9:{name:"AutoHyphenate"},10:{name:"HyphenatedWordSize"},11:{name:"PreHyphen"},12:{name:"PostHyphen"},13:{name:"ConsecutiveHyphens?"},14:{name:"Zone"},15:{name:"HypenateCapitalizedWords"},17:{name:"WordSpacing"},18:{name:"LetterSpacing"},19:{name:"GlyphSpacing"},32:{name:"StyleSheet",children:Vi}},Aa={name:"StyleSheetData",children:Vi},Yc={0:{name:"ResourceDict",children:{1:{name:"FontSet",children:{0:{uproot:!0,children:{0:{uproot:!0,children:{0:{uproot:!0,children:{0:{name:"Name"},2:{name:"FontType"}}}}}}}}},2:{name:"2",children:{}},3:{name:"MojiKumiSet",children:{0:{uproot:!0,children:{0:{uproot:!0,children:{0:{name:"InternalName"}}}}}}},4:{name:"KinsokuSet",children:{0:{uproot:!0,children:{0:{uproot:!0,children:{0:{name:"Name"},5:{uproot:!0,children:{0:{name:"NoStart"},1:{name:"NoEnd"},2:{name:"Keep"},3:{name:"Hanging"},4:{name:"Name"}}}}}}}}},5:{name:"StyleSheetSet",children:{0:{uproot:!0,children:{0:{uproot:!0,children:{0:{name:"Name"},6:Aa}}}}}},6:{name:"ParagraphSheetSet",children:{0:{uproot:!0,children:{0:{uproot:!0,children:{0:{name:"Name"},5:{name:"Properties",children:vi},6:{name:"DefaultStyleSheet"}}}}}}},8:{name:"TextFrameSet",children:{0:{uproot:!0,children:{0:{name:"path",children:{0:{name:"name"},1:{name:"bezierCurve",children:{0:{name:"controlPoints"}}},2:{name:"data",children:{0:{name:"type"},1:{name:"orientation"},2:{name:"frameMatrix"},4:{name:"4"},6:{name:"textRange"},7:{name:"rowGutter"},8:{name:"columnGutter"},9:{name:"9"},10:{name:"baselineAlignment",children:{0:{name:"flag"},1:{name:"min"}}},11:{name:"pathData",children:{1:{name:"1"},0:{name:"reversed"},2:{name:"2"},3:{name:"3"},4:{name:"spacing"},5:{name:"5"},6:{name:"6"},7:{name:"7"},18:{name:"18"}}},12:{name:"12"},13:{name:"13"}}},3:{name:"3"},97:{name:"uuid"}}}}}}},9:{name:"Predefined",children:{0:{children:{0:{uproot:!0}}},1:{children:{0:{uproot:!0}}}}}}},1:{name:"EngineDict",children:{0:{name:"0",children:{3:{name:"SuperscriptSize"},4:{name:"SuperscriptPosition"},5:{name:"SubscriptSize"},6:{name:"SubscriptPosition"},7:{name:"SmallCapSize"},8:{name:"UseFractionalGlyphWidths"},15:{children:{0:{uproot:!0}}}}},1:{name:"Editors?",children:{0:{name:"Editor",children:{0:{name:"Text"},5:{name:"ParagraphRun",children:{0:{name:"RunArray",children:{0:{name:"ParagraphSheet",children:{0:{uproot:!0,children:{0:{name:"0"},5:{name:"5",children:vi},6:{name:"6"}}}}},1:{name:"RunLength"}}}}},6:{name:"StyleRun",children:{0:{name:"RunArray",children:{0:{name:"StyleSheet",children:{0:{uproot:!0,children:{6:Aa}}}},1:{name:"RunLength"}}}}}}},1:{name:"FontVectorData ???"}}},2:{name:"StyleSheet",children:Vi},3:{name:"ParagraphSheet",children:vi}}}};function Yt(e,t){var n,i;if(e===null)return e;if(Array.isArray(e))return e.map(function(c){return Yt(c,t)});if(typeof e!="object")return e;for(var r={},a=0,o=Object.keys(e);a<o.length;a++){var s=o[a];if(t[s])if(t[s].uproot){s!=="99"&&(r=Yt(e[s],(n=t[s].children)!==null&&n!==void 0?n:{})),e[99]&&(r._type=e[99]);break}else r[t[s].name||s]=Yt(e[s],(i=t[s].children)!==null&&i!==void 0?i:{});else s==="99"?r._type=e[s]:r[s]=Yt(e[s],{})}return r}function Kc(e){return Yt(e,Yc)}var h=function(){return h=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},h.apply(this,arguments)},Te="abcdefghijklmnopqrstuvwxyz",jn={};function N(e,t,n,i){var r={key:e,has:t,read:n,write:i};jn[r.key]=r}function zt(e,t){jn[e]=jn[t]}function ae(e){return function(t){return t[e]!==void 0}}function mi(e){if(L(e))throw new Error("Resource size above 4 GB limit at ".concat(e.offset.toString(16)));return L(e)}function gi(e,t){D(e,0),D(e,t)}N("TySh",ae("text"),function(e,t,n){if(Q(e)!==1)throw new Error("Invalid TySh version");for(var i=[],r=0;r<6;r++)i.push(ze(e));if(Q(e)!==50)throw new Error("Invalid TySh text version");var a=Y(e);if(Q(e)!==1)throw new Error("Invalid TySh warp version");var o=Y(e);if(t.text={transform:i,left:We(e),top:We(e),right:We(e),bottom:We(e),text:a["Txt "].replace(/\r/g,`
`),index:a.TextIndex||0,gridding:ea.decode(a.textGridding),antiAlias:ta.decode(a.AntA),orientation:nn.decode(a.Ornt),warp:{style:Ri.decode(o.warpStyle),value:o.warpValue||0,perspective:o.warpPerspective||0,perspectiveOther:o.warpPerspectiveOther||0,rotate:nn.decode(o.warpRotate)}},a.bounds&&(t.text.bounds=$r(a.bounds)),a.boundingBox&&(t.text.boundingBox=$r(a.boundingBox)),a.EngineData){var s=ds(a.EngineData),c=$c(s);t.text=h(h({},t.text),c)}R(e,n())},function(e,t){var n=t.text,i=n.warp||{},r=n.transform||[1,0,0,1,0,0],a=h(h(h({"Txt ":(n.text||"").replace(/\r?\n/g,"\r"),textGridding:ea.encode(n.gridding),Ornt:nn.encode(n.orientation),AntA:ta.encode(n.antiAlias)},n.bounds?{bounds:Zr(n.bounds)}:{}),n.boundingBox?{boundingBox:Zr(n.boundingBox)}:{}),{TextIndex:n.index||0,EngineData:Uc(Zc(n))});ne(e,1);for(var o=0;o<6;o++)Ke(e,r[o]);ne(e,50),K(e,"","TxLr",a,"text"),ne(e,1),K(e,"","warp",Wn(i)),Xe(e,n.left),Xe(e,n.top),Xe(e,n.right),Xe(e,n.bottom)});N("SoCo",function(e){return e.vectorFill!==void 0&&e.vectorStroke===void 0&&e.vectorFill.type==="color"},function(e,t){var n=Y(e);t.vectorFill=fn(n)},function(e,t){var n=dn(t.vectorFill).descriptor;K(e,"","null",n)});N("GdFl",function(e){return e.vectorFill!==void 0&&e.vectorStroke===void 0&&(e.vectorFill.type==="solid"||e.vectorFill.type==="noise")},function(e,t,n){var i=Y(e);t.vectorFill=fn(i),R(e,n())},function(e,t){var n=dn(t.vectorFill).descriptor;K(e,"","null",n)});N("PtFl",function(e){return e.vectorFill!==void 0&&e.vectorStroke===void 0&&e.vectorFill.type==="pattern"},function(e,t){var n=Y(e);t.vectorFill=fn(n)},function(e,t){var n=dn(t.vectorFill).descriptor;K(e,"","null",n)});N("vscg",function(e){return e.vectorFill!==void 0&&e.vectorStroke!==void 0},function(e,t,n){se(e);var i=Y(e);t.vectorFill=fn(i),R(e,n())},function(e,t){var n=dn(t.vectorFill),i=n.descriptor,r=n.key;U(e,r),K(e,"","null",i)});function Jc(e,t,n){var i=He(e)*n,r=He(e)*t,a=He(e)*n,o=He(e)*t,s=He(e)*n,c=He(e)*t;return[r,i,o,a,c,s]}function Qc(e,t,n,i){je(e,t[1]/i),je(e,t[0]/n),je(e,t[3]/i),je(e,t[2]/n),je(e,t[5]/i),je(e,t[4]/n)}var ys=["exclude","combine","subtract","intersect"];function eu(e,t,n,i,r){for(var a=e.offset+r,o=t.paths,s=void 0;a-e.offset>=26;){var c=E(e);switch(c){case 0:case 3:{E(e);var l=Q(e),u=E(e);R(e,18),s={open:c===3,knots:[],fillRule:u===2?"non-zero":"even-odd"},l!==-1&&(s.operation=ys[l]),o.push(s);break}case 1:case 2:case 4:case 5:s.knots.push({linked:c===1||c===4,points:Jc(e,n,i)});break;case 6:R(e,24);break;case 7:{var d=He(e),p=He(e),f=He(e),m=He(e),v=He(e);R(e,4),t.clipboard={top:d,left:p,bottom:f,right:m,resolution:v};break}case 8:t.fillStartsWithAllPixels=!!E(e),R(e,22);break;default:throw new Error("Invalid vmsk section")}}return o}N("vmsk",ae("vectorMask"),function(e,t,n,i){var r=i.width,a=i.height;if(L(e)!==3)throw new Error("Invalid vmsk version");t.vectorMask={paths:[]};var o=t.vectorMask,s=L(e);o.invert=(s&1)!==0,o.notLink=(s&2)!==0,o.disable=(s&4)!==0,eu(e,o,r,a,n()),R(e,n())},function(e,t,n){var i=n.width,r=n.height,a=t.vectorMask,o=(a.invert?1:0)|(a.notLink?2:0)|(a.disable?4:0);D(e,3),D(e,o),I(e,6),re(e,24);var s=a.clipboard;s&&(I(e,7),je(e,s.top),je(e,s.left),je(e,s.bottom),je(e,s.right),je(e,s.resolution),re(e,4)),I(e,8),I(e,a.fillStartsWithAllPixels?1:0),re(e,22);for(var c=0,l=a.paths;c<l.length;c++){var u=l[c];I(e,u.open?3:0),I(e,u.knots.length),I(e,u.operation?ys.indexOf(u.operation):-1),I(e,u.fillRule==="non-zero"?2:1),re(e,18);for(var d=u.open?4:1,p=u.open?5:2,f=0,m=u.knots;f<m.length;f++){var v=m[f],x=v.linked,b=v.points;I(e,x?d:p),Qc(e,b,i,r)}}});zt("vsms","vmsk");N("vowv",ae("vowv"),function(e,t){t.vowv=L(e)},function(e,t){D(e,t.vowv)});N("vogk",ae("vectorOrigination"),function(e,t,n){if(_(e)!==1)throw new Error("Invalid vogk version");var i=Y(e);t.vectorOrigination={keyDescriptorList:[]};for(var r=0,a=i.keyDescriptorList;r<a.length;r++){var o=a[r],s={};o.keyShapeInvalidated!=null&&(s.keyShapeInvalidated=o.keyShapeInvalidated),o.keyOriginType!=null&&(s.keyOriginType=o.keyOriginType),o.keyOriginResolution!=null&&(s.keyOriginResolution=o.keyOriginResolution),o.keyOriginShapeBBox&&(s.keyOriginShapeBoundingBox={top:ht(o.keyOriginShapeBBox["Top "]),left:ht(o.keyOriginShapeBBox.Left),bottom:ht(o.keyOriginShapeBBox.Btom),right:ht(o.keyOriginShapeBBox.Rght)});var c=o.keyOriginRRectRadii;c&&(s.keyOriginRRectRadii={topRight:ie(c.topRight),topLeft:ie(c.topLeft),bottomLeft:ie(c.bottomLeft),bottomRight:ie(c.bottomRight)});var l=o.keyOriginBoxCorners;l&&(s.keyOriginBoxCorners=[{x:l.rectangleCornerA.Hrzn,y:l.rectangleCornerA.Vrtc},{x:l.rectangleCornerB.Hrzn,y:l.rectangleCornerB.Vrtc},{x:l.rectangleCornerC.Hrzn,y:l.rectangleCornerC.Vrtc},{x:l.rectangleCornerD.Hrzn,y:l.rectangleCornerD.Vrtc}]);var u=o.Trnf;u&&(s.transform=[u.xx,u.xy,u.yx,u.yy,u.tx,u.ty]),t.vectorOrigination.keyDescriptorList.push(s)}R(e,n())},function(e,t){for(var n=t.vectorOrigination,i={keyDescriptorList:[]},r=0;r<n.keyDescriptorList.length;r++){var a=n.keyDescriptorList[r];i.keyDescriptorList.push({});var o=i.keyDescriptorList[i.keyDescriptorList.length-1];a.keyOriginType!=null&&(o.keyOriginType=a.keyOriginType),a.keyOriginResolution!=null&&(o.keyOriginResolution=a.keyOriginResolution);var s=a.keyOriginRRectRadii;s&&(o.keyOriginRRectRadii={unitValueQuadVersion:1,topRight:ce(s.topRight,"topRight"),topLeft:ce(s.topLeft,"topLeft"),bottomLeft:ce(s.bottomLeft,"bottomLeft"),bottomRight:ce(s.bottomRight,"bottomRight")});var c=a.keyOriginShapeBoundingBox;c&&(o.keyOriginShapeBBox={unitValueQuadVersion:1,"Top ":ce(c.top,"top"),Left:ce(c.left,"left"),Btom:ce(c.bottom,"bottom"),Rght:ce(c.right,"right")});var l=a.keyOriginBoxCorners;l&&l.length===4&&(o.keyOriginBoxCorners={rectangleCornerA:{Hrzn:l[0].x,Vrtc:l[0].y},rectangleCornerB:{Hrzn:l[1].x,Vrtc:l[1].y},rectangleCornerC:{Hrzn:l[2].x,Vrtc:l[2].y},rectangleCornerD:{Hrzn:l[3].x,Vrtc:l[3].y}});var u=a.transform;u&&u.length===6&&(o.Trnf={xx:u[0],xy:u[1],yx:u[2],yy:u[3],tx:u[4],ty:u[5]}),a.keyShapeInvalidated!=null&&(o.keyShapeInvalidated=a.keyShapeInvalidated),o.keyOriginIndex=r}H(e,1),K(e,"","null",i)});N("lmfx",function(e){return e.effects!==void 0&&ks(e.effects)},function(e,t,n){var i=L(e);if(i!==0)throw new Error("Invalid lmfx version");var r=Y(e);t.effects=un(r,!!e.logMissingFeatures),R(e,n())},function(e,t,n,i){var r=cn(t.effects,!!i.logMissingFeatures,!0);D(e,0),K(e,"","null",r)});N("lrFX",ae("effects"),function(e,t,n){t.effects||(t.effects=_c(e)),R(e,n())},function(e,t){Nc(e,t.effects)});N("luni",ae("name"),function(e,t,n){if(n()>4){var i=L(e);n()>=i*2?t.name=Ni(e,i):e.logDevFeatures&&e.log("name in luni section is too long")}else e.logDevFeatures&&e.log("empty luni section");R(e,n())},function(e,t){Me(e,t.name)});N("lnsr",ae("nameSource"),function(e,t){return t.nameSource=se(e)},function(e,t){return U(e,t.nameSource)});N("lyid",ae("id"),function(e,t){t.id=L(e)},function(e,t,n,i){for(var r=t.id;i.layerIds.has(r);)r+=100;D(e,r),i.layerIds.add(r),i.layerToId.set(t,r)});N("lsct",ae("sectionDivider"),function(e,t,n){t.sectionDivider={type:L(e)},n()&&(vt(e,"8BIM"),t.sectionDivider.key=se(e)),n()&&(t.sectionDivider.subType=L(e))},function(e,t){D(e,t.sectionDivider.type),t.sectionDivider.key&&(U(e,"8BIM"),U(e,t.sectionDivider.key),t.sectionDivider.subType!==void 0&&D(e,t.sectionDivider.subType))});zt("lsdk","lsct");N("clbl",ae("blendClippendElements"),function(e,t){t.blendClippendElements=!!T(e),R(e,3)},function(e,t){B(e,t.blendClippendElements?1:0),re(e,3)});N("infx",ae("blendInteriorElements"),function(e,t){t.blendInteriorElements=!!T(e),R(e,3)},function(e,t){B(e,t.blendInteriorElements?1:0),re(e,3)});N("knko",ae("knockout"),function(e,t){t.knockout=!!T(e),R(e,3)},function(e,t){B(e,t.knockout?1:0),re(e,3)});N("lmgm",ae("layerMaskAsGlobalMask"),function(e,t){t.layerMaskAsGlobalMask=!!T(e),R(e,3)},function(e,t){B(e,t.layerMaskAsGlobalMask?1:0),re(e,3)});N("lspf",ae("protected"),function(e,t){var n=L(e);t.protected={transparency:(n&1)!==0,composite:(n&2)!==0,position:(n&4)!==0},n&8&&(t.protected.artboards=!0)},function(e,t){var n=(t.protected.transparency?1:0)|(t.protected.composite?2:0)|(t.protected.position?4:0)|(t.protected.artboards?8:0);D(e,n)});N("lclr",ae("layerColor"),function(e,t){var n=E(e);R(e,6),t.layerColor=Or[n]},function(e,t){var n=Or.indexOf(t.layerColor);I(e,n===-1?0:n),re(e,6)});N("shmd",function(e){return e.timestamp!==void 0||e.animationFrames!==void 0||e.animationFrameFlags!==void 0||e.timeline!==void 0||e.comps!==void 0},function(e,t,n){for(var i=L(e),r=function(o){vt(e,"8BIM");var s=se(e);T(e),R(e,3),Re(e,1,function(c){if(s==="cust"){var l=Y(e);l.layerTime!==void 0&&(t.timestamp=l.layerTime)}else if(s==="mlst"){var l=Y(e);t.animationFrames=[];for(var u=0;u<l.LaSt.length;u++){var d=l.LaSt[u],p={frames:d.FrLs};d.enab!==void 0&&(p.enable=d.enab),d.Ofst&&(p.offset=Qt(d.Ofst)),d.FXRf&&(p.referencePoint=Qt(d.FXRf)),d.Lefx&&(p.effects=un(d.Lefx,!!e.logMissingFeatures)),d.blendOptions&&d.blendOptions.Opct&&(p.opacity=oe(d.blendOptions.Opct)),t.animationFrames.push(p)}}else if(s==="mdyn"){E(e);var f=T(e),m=T(e);t.animationFrameFlags={propagateFrameOne:!f,unifyLayerPosition:(m&1)!==0,unifyLayerStyle:(m&2)!==0,unifyLayerVisibility:(m&4)!==0}}else if(s==="tmln"){var l=Y(e),v=l.timeScope,x={start:Ee(v.Strt),duration:Ee(v.duration),inTime:Ee(v.inTime),outTime:Ee(v.outTime),autoScope:l.autoScope,audioLevel:l.audioLevel};l.trackList&&(x.tracks=mo(l.trackList,!!e.logMissingFeatures)),t.timeline=x}else if(s==="cmls"){var l=Y(e);t.comps={settings:[]},l.origFXRefPoint&&(t.comps.originalEffectsReferencePoint={x:l.origFXRefPoint.Hrzn,y:l.origFXRefPoint.Vrtc});for(var b=0,y=l.layerSettings;b<y.length;b++){var S=y[b];t.comps.settings.push({compList:S.compList});var g=t.comps.settings[t.comps.settings.length-1];"enab"in S&&(g.enabled=S.enab),S.Ofst&&(g.offset={x:S.Ofst.Hrzn,y:S.Ofst.Vrtc}),S.FXRefPoint&&(g.effectsReferencePoint={x:S.FXRefPoint.Hrzn,y:S.FXRefPoint.Vrtc})}}else if(s==="extn"){var l=Y(e);e.logMissingFeatures&&e.log('Unhandled "shmd" section key',s)}else e.logMissingFeatures&&e.log('Unhandled "shmd" section key',s);R(e,c())})},a=0;a<i;a++)r();R(e,n())},function(e,t,n,i){var r=t.animationFrames,a=t.animationFrameFlags,o=t.timestamp,s=t.timeline,c=t.comps,l=0;r&&l++,a&&l++,s&&l++,o!==void 0&&l++,c&&l++,D(e,l),r&&(U(e,"8BIM"),U(e,"mlst"),B(e,0),re(e,3),yt(e,2,function(){for(var u,d={LaID:(u=t.id)!==null&&u!==void 0?u:0,LaSt:[]},p=0;p<r.length;p++){var f=r[p],m={};f.enable!==void 0&&(m.enab=f.enable),m.FrLs=f.frames,f.offset&&(m.Ofst=en(f.offset)),f.referencePoint&&(m.FXRf=en(f.referencePoint)),f.effects&&(m.Lefx=cn(f.effects,!1,!1)),f.opacity!==void 0&&(m.blendOptions={Opct:xe(f.opacity)}),d.LaSt.push(m)}K(e,"","null",d)},!0)),a&&(U(e,"8BIM"),U(e,"mdyn"),B(e,0),re(e,3),yt(e,2,function(){I(e,0),B(e,a.propagateFrameOne?0:15),B(e,(a.unifyLayerPosition?1:0)|(a.unifyLayerStyle?2:0)|(a.unifyLayerVisibility?4:0))})),s&&(U(e,"8BIM"),U(e,"tmln"),B(e,0),re(e,3),yt(e,2,function(){var u={Vrsn:1,timeScope:{Vrsn:1,Strt:s.start,duration:s.duration,inTime:s.inTime,outTime:s.outTime},autoScope:s.autoScope,audioLevel:s.audioLevel};s.tracks&&(u.trackList=go(s.tracks));var d=i.layerToId.get(t)||t.id;if(!d)throw new Error("You need to provide layer.id value whan writing document with animations");u.LyrI=d,K(e,"","null",u,"anim")},!0)),o!==void 0&&(U(e,"8BIM"),U(e,"cust"),B(e,0),re(e,3),yt(e,2,function(){var u={layerTime:o};K(e,"","metadata",u)},!0)),c&&(U(e,"8BIM"),U(e,"cmls"),B(e,0),re(e,3),yt(e,2,function(){var u=i.layerToId.get(t)||t.id;if(!u)throw new Error("You need to provide layer.id value whan writing document with layer comps");var d={};c.originalEffectsReferencePoint&&(d.origFXRefPoint={Hrzn:c.originalEffectsReferencePoint.x,Vrtc:c.originalEffectsReferencePoint.y}),d.LyrI=u,d.layerSettings=[];for(var p=0,f=c.settings;p<f.length;p++){var m=f[p],v={};m.enabled!==void 0&&(v.enab=m.enabled),m.offset&&(v.Ofst={Hrzn:m.offset.x,Vrtc:m.offset.y}),m.effectsReferencePoint&&(v.FXRefPoint={Hrzn:m.effectsReferencePoint.x,Vrtc:m.effectsReferencePoint.y}),v.compList=m.compList,d.layerSettings.push(v)}K(e,"","null",d)},!0))});N("PxSc",function(){return!1},function(e,t){var n=Y(e,!0);n.pixelSourceType===1986285651?t.pixelSource={type:"vdPS",origin:{x:n.origin.Hrzn,y:n.origin.Vrtc},interpretation:{interpretAlpha:n.interpretation.interpretAlpha.split(".")[1],profile:n.interpretation.profile},frameReader:{type:"QTFR",link:{name:n.frameReader["Lnk "]["Nm  "],fullPath:n.frameReader["Lnk "].fullPath,originalPath:n.frameReader["Lnk "].originalPath,relativePath:n.frameReader["Lnk "].relPath,alias:n.frameReader["Lnk "].alis},mediaDescriptor:n.frameReader.mediaDescriptor},showAlteredVideo:n.showAlteredVideo}:e.log("Unknown pixelSourceType")},function(e,t){var n=t.pixelSource,i={_name:"",_classID:"PixelSource",pixelSourceType:1986285651,descVersion:1,origin:{Hrzn:n.origin.x,Vrtc:n.origin.y},interpretation:{_name:"",_classID:"footageInterpretation",Vrsn:1,interpretAlpha:"alphaInterpretation.".concat(n.interpretation.interpretAlpha),profile:n.interpretation.profile},frameReader:{_name:"",_classID:"FrameReader",frameReaderType:1364477522,descVersion:1,"Lnk ":{_name:"",_classID:"ExternalFileLink",descVersion:2,"Nm  ":n.frameReader.link.name,fullPath:n.frameReader.link.fullPath,originalPath:n.frameReader.link.originalPath,alis:n.frameReader.link.alias,relPath:n.frameReader.link.relativePath},mediaDescriptor:n.frameReader.mediaDescriptor},showAlteredVideo:n.showAlteredVideo};K(e,"","PixelSource",i)});N("vstk",ae("vectorStroke"),function(e,t,n){var i=Y(e);t.vectorStroke={strokeEnabled:i.strokeEnabled,fillEnabled:i.fillEnabled,lineWidth:ie(i.strokeStyleLineWidth),lineDashOffset:ie(i.strokeStyleLineDashOffset),miterLimit:i.strokeStyleMiterLimit,lineCapType:sa.decode(i.strokeStyleLineCapType),lineJoinType:la.decode(i.strokeStyleLineJoinType),lineAlignment:ca.decode(i.strokeStyleLineAlignment),scaleLock:i.strokeStyleScaleLock,strokeAdjust:i.strokeStyleStrokeAdjust,lineDashSet:i.strokeStyleLineDashSet.map(ie),blendMode:Ne.decode(i.strokeStyleBlendMode),opacity:oe(i.strokeStyleOpacity),content:fn(i.strokeStyleContent),resolution:i.strokeStyleResolution},R(e,n())},function(e,t){var n,i,r,a=t.vectorStroke,o={strokeStyleVersion:2,strokeEnabled:!!a.strokeEnabled,fillEnabled:!!a.fillEnabled,strokeStyleLineWidth:a.lineWidth||{value:3,units:"Points"},strokeStyleLineDashOffset:a.lineDashOffset||{value:0,units:"Points"},strokeStyleMiterLimit:(n=a.miterLimit)!==null&&n!==void 0?n:100,strokeStyleLineCapType:sa.encode(a.lineCapType),strokeStyleLineJoinType:la.encode(a.lineJoinType),strokeStyleLineAlignment:ca.encode(a.lineAlignment),strokeStyleScaleLock:!!a.scaleLock,strokeStyleStrokeAdjust:!!a.strokeAdjust,strokeStyleLineDashSet:a.lineDashSet||[],strokeStyleBlendMode:Ne.encode(a.blendMode),strokeStyleOpacity:xe((i=a.opacity)!==null&&i!==void 0?i:1),strokeStyleContent:dn(a.content||{type:"color",color:{r:0,g:0,b:0}}).descriptor,strokeStyleResolution:(r=a.resolution)!==null&&r!==void 0?r:72};K(e,"","strokeStyle",o)});N("artb",ae("artboard"),function(e,t,n){var i=Y(e),r=i.artboardRect;t.artboard={rect:{top:r["Top "],left:r.Left,bottom:r.Btom,right:r.Rght},guideIndices:i.guideIndeces,presetName:i.artboardPresetName,color:qe(i["Clr "]),backgroundType:i.artboardBackgroundType},R(e,n())},function(e,t){var n,i=t.artboard,r=i.rect,a={artboardRect:{"Top ":r.top,Left:r.left,Btom:r.bottom,Rght:r.right},guideIndeces:i.guideIndices||[],artboardPresetName:i.presetName||"","Clr ":$e(i.color),artboardBackgroundType:(n=i.backgroundType)!==null&&n!==void 0?n:1};K(e,"","artboard",a)});N("sn2P",ae("usingAlignedRendering"),function(e,t){return t.usingAlignedRendering=!!L(e)},function(e,t){return D(e,t.usingAlignedRendering?1:0)});var Dt=["unknown","vector","raster","image stack"];function Ss(e){var t,n,i,r,a,o,s=h(h({style:Ri.decode(e.warpStyle)},e.warpValues?{values:e.warpValues}:{value:e.warpValue||0}),{perspective:e.warpPerspective||0,perspectiveOther:e.warpPerspectiveOther||0,rotate:nn.decode(e.warpRotate),bounds:e.bounds&&{top:ht(e.bounds["Top "]),left:ht(e.bounds.Left),bottom:ht(e.bounds.Btom),right:ht(e.bounds.Rght)},uOrder:e.uOrder,vOrder:e.vOrder});(e.deformNumRows!=null||e.deformNumCols!=null)&&(s.deformNumRows=e.deformNumRows,s.deformNumCols=e.deformNumCols);var c=e.customEnvelopeWarp;if(c){s.customEnvelopeWarp={meshPoints:[]};for(var l=((t=c.meshPoints.find(function(p){return p.type==="Hrzn"}))===null||t===void 0?void 0:t.values)||[],u=((n=c.meshPoints.find(function(p){return p.type==="Vrtc"}))===null||n===void 0?void 0:n.values)||[],d=0;d<l.length;d++)s.customEnvelopeWarp.meshPoints.push({x:l[d],y:u[d]});(c.quiltSliceX||c.quiltSliceY)&&(s.customEnvelopeWarp.quiltSliceX=((r=(i=c.quiltSliceX)===null||i===void 0?void 0:i[0])===null||r===void 0?void 0:r.values)||[],s.customEnvelopeWarp.quiltSliceY=((o=(a=c.quiltSliceY)===null||a===void 0?void 0:a[0])===null||o===void 0?void 0:o.values)||[])}return s}function Hi(e){var t,n;return e.deformNumCols!=null||e.deformNumRows!=null||((t=e.customEnvelopeWarp)===null||t===void 0?void 0:t.quiltSliceX)||((n=e.customEnvelopeWarp)===null||n===void 0?void 0:n.quiltSliceY)}function Wn(e){var t=e.bounds,n=h(h({warpStyle:Ri.encode(e.style)},e.values?{warpValues:e.values}:{warpValue:e.value||0}),{warpPerspective:e.perspective||0,warpPerspectiveOther:e.perspectiveOther||0,warpRotate:nn.encode(e.rotate),bounds:{"Top ":ce(t&&t.top||{units:"Pixels",value:0},"bounds.top"),Left:ce(t&&t.left||{units:"Pixels",value:0},"bounds.left"),Btom:ce(t&&t.bottom||{units:"Pixels",value:0},"bounds.bottom"),Rght:ce(t&&t.right||{units:"Pixels",value:0},"bounds.right")},uOrder:e.uOrder||0,vOrder:e.vOrder||0}),i=Hi(e);if(i){var r=n;r.deformNumRows=e.deformNumRows||0,r.deformNumCols=e.deformNumCols||0}var a=e.customEnvelopeWarp;if(a){var o=a.meshPoints||[];if(i){var r=n;r.customEnvelopeWarp={_name:"",_classID:"customEnvelopeWarp",quiltSliceX:[{type:"quiltSliceX",values:a.quiltSliceX||[]}],quiltSliceY:[{type:"quiltSliceY",values:a.quiltSliceY||[]}],meshPoints:[{type:"Hrzn",values:o.map(function(c){return c.x})},{type:"Vrtc",values:o.map(function(c){return c.y})}]}}else n.customEnvelopeWarp={_name:"",_classID:"customEnvelopeWarp",meshPoints:[{type:"Hrzn",values:o.map(function(s){return s.x})},{type:"Vrtc",values:o.map(function(s){return s.y})}]}}return n}N("PlLd",ae("placedLayer"),function(e,t,n){if(se(e)!=="plcL")throw new Error("Invalid PlLd signature");if(_(e)!==3)throw new Error("Invalid PlLd version");var i=pt(e,1),r=_(e),a=_(e);_(e);var o=_(e);if(!Dt[o])throw new Error("Invalid PlLd type");for(var s=[],c=0;c<8;c++)s.push(ze(e));var l=_(e);if(l!==0)throw new Error("Invalid Warp version ".concat(l));var u=Y(e);t.placedLayer=t.placedLayer||{id:i,type:Dt[o],pageNumber:r,totalPages:a,transform:s,warp:Ss(u)},R(e,n())},function(e,t){var n=t.placedLayer;if(U(e,"plcL"),H(e,3),!n.id||typeof n.id!="string"||!/^[0-9a-f]{8}-([0-9a-f]{4}-){3}[0-9a-f]{12}$/.test(n.id))throw new Error("Placed layer ID must be in a GUID format (example: 20953ddb-9391-11ec-b4f1-c15674f50bc4)");if(Mt(e,n.id,1),H(e,1),H(e,1),H(e,16),Dt.indexOf(n.type)===-1)throw new Error("Invalid placedLayer type");H(e,Dt.indexOf(n.type));for(var i=0;i<8;i++)Ke(e,n.transform[i]);H(e,0);var r=xs(n),a=Hi(r),o=a?"quiltWarp":"warp";K(e,"",o,Wn(r),o)});function tu(e){return new Float32Array(e.buffer.slice(e.byteOffset),0,e.byteLength/4)}function nu(e){return new Uint32Array(e.buffer.slice(e.byteOffset),0,e.byteLength/4)}function bi(e){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}function zn(e){for(var t=[],n=0;n<e.length;n+=2)t.push({x:e[n],y:e[n+1]});return t}function Ht(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n].x,e[n].y);return t}function Pa(e){return zn(tu(e))}function jt(e){return{x:ie(e.Hrzn),y:ie(e.Vrtc)}}function Wt(e){return{_name:"",_classID:"Pnt ",Hrzn:ce(e.x,"x"),Vrtc:ce(e.y,"y")}}function iu(e,t){var n={name:e["Nm  "],opacity:oe(e.blendOptions.Opct),blendMode:Ne.decode(e.blendOptions["Md  "]),enabled:e.enab,hasOptions:e.hasoptions,foregroundColor:qe(e.FrgC),backgroundColor:qe(e.BckC)};if("Fltr"in e)switch(e.Fltr._classID){case"boxblur":return h(h({},n),{type:"box blur",filter:{radius:ie(e.Fltr["Rds "])}});case"GsnB":return h(h({},n),{type:"gaussian blur",filter:{radius:ie(e.Fltr["Rds "])}});case"MtnB":return h(h({},n),{type:"motion blur",filter:{angle:e.Fltr.Angl,distance:ie(e.Fltr.Dstn)}});case"RdlB":return h(h({},n),{type:"radial blur",filter:{amount:e.Fltr.Amnt,method:To.decode(e.Fltr.BlrM),quality:Oo.decode(e.Fltr.BlrQ)}});case"shapeBlur":return h(h({},n),{type:"shape blur",filter:{radius:ie(e.Fltr["Rds "]),customShape:{name:e.Fltr.customShape["Nm  "],id:e.Fltr.customShape.Idnt}}});case"SmrB":return h(h({},n),{type:"smart blur",filter:{radius:e.Fltr["Rds "],threshold:e.Fltr.Thsh,quality:Ro.decode(e.Fltr.SmBQ),mode:Mo.decode(e.Fltr.SmBM)}});case"surfaceBlur":return h(h({},n),{type:"surface blur",filter:{radius:ie(e.Fltr["Rds "]),threshold:e.Fltr.Thsh}});case"Dspl":return h(h({},n),{type:"displace",filter:{horizontalScale:e.Fltr.HrzS,verticalScale:e.Fltr.VrtS,displacementMap:Bo.decode(e.Fltr.DspM),undefinedAreas:Ot.decode(e.Fltr.UndA),displacementFile:{signature:e.Fltr.DspF.sig,path:e.Fltr.DspF.path}}});case"Pnch":return h(h({},n),{type:"pinch",filter:{amount:e.Fltr.Amnt}});case"Plr ":return h(h({},n),{type:"polar coordinates",filter:{conversion:_o.decode(e.Fltr.Cnvr)}});case"Rple":return h(h({},n),{type:"ripple",filter:{amount:e.Fltr.Amnt,size:No.decode(e.Fltr.RplS)}});case"Shr ":return h(h({},n),{type:"shear",filter:{shearPoints:e.Fltr.ShrP.map(function(s){return{x:s.Hrzn,y:s.Vrtc}}),shearStart:e.Fltr.ShrS,shearEnd:e.Fltr.ShrE,undefinedAreas:Ot.decode(e.Fltr.UndA)}});case"Sphr":return h(h({},n),{type:"spherize",filter:{amount:e.Fltr.Amnt,mode:zo.decode(e.Fltr.SphM)}});case"Twrl":return h(h({},n),{type:"twirl",filter:{angle:e.Fltr.Angl}});case"Wave":return h(h({},n),{type:"wave",filter:{numberOfGenerators:e.Fltr.NmbG,type:Go.decode(e.Fltr.Wvtp),wavelength:{min:e.Fltr.WLMn,max:e.Fltr.WLMx},amplitude:{min:e.Fltr.AmMn,max:e.Fltr.AmMx},scale:{x:e.Fltr.SclH,y:e.Fltr.SclV},randomSeed:e.Fltr.RndS,undefinedAreas:Ot.decode(e.Fltr.UndA)}});case"ZgZg":return h(h({},n),{type:"zigzag",filter:{amount:e.Fltr.Amnt,ridges:e.Fltr.NmbR,style:Uo.decode(e.Fltr.ZZTy)}});case"AdNs":return h(h({},n),{type:"add noise",filter:{amount:oe(e.Fltr.Nose),distribution:Vo.decode(e.Fltr.Dstr),monochromatic:e.Fltr.Mnch,randomSeed:e.Fltr.FlRs}});case"DstS":return h(h({},n),{type:"dust and scratches",filter:{radius:e.Fltr["Rds "],threshold:e.Fltr.Thsh}});case"Mdn ":return h(h({},n),{type:"median",filter:{radius:ie(e.Fltr["Rds "])}});case"denoise":return h(h({},n),{type:"reduce noise",filter:{preset:e.Fltr.preset,removeJpegArtifact:e.Fltr.removeJPEGArtifact,reduceColorNoise:oe(e.Fltr.ClNs),sharpenDetails:oe(e.Fltr.Shrp),channelDenoise:e.Fltr.channelDenoise.map(function(s){return h({channels:s.Chnl.map(rn.decode),amount:s.Amnt},s.EdgF?{preserveDetails:s.EdgF}:{})})}});case"ClrH":return h(h({},n),{type:"color halftone",filter:{radius:e.Fltr["Rds "],angle1:e.Fltr.Ang1,angle2:e.Fltr.Ang2,angle3:e.Fltr.Ang3,angle4:e.Fltr.Ang4}});case"Crst":return h(h({},n),{type:"crystallize",filter:{cellSize:e.Fltr.ClSz,randomSeed:e.Fltr.FlRs}});case"Mztn":return h(h({},n),{type:"mezzotint",filter:{type:Ho.decode(e.Fltr.MztT),randomSeed:e.Fltr.FlRs}});case"Msc ":return h(h({},n),{type:"mosaic",filter:{cellSize:ie(e.Fltr.ClSz)}});case"Pntl":return h(h({},n),{type:"pointillize",filter:{cellSize:e.Fltr.ClSz,randomSeed:e.Fltr.FlRs}});case"Clds":return h(h({},n),{type:"clouds",filter:{randomSeed:e.Fltr.FlRs}});case"DfrC":return h(h({},n),{type:"difference clouds",filter:{randomSeed:e.Fltr.FlRs}});case"Fbrs":return h(h({},n),{type:"fibers",filter:{variance:e.Fltr.Vrnc,strength:e.Fltr.Strg,randomSeed:e.Fltr.RndS}});case"LnsF":return h(h({},n),{type:"lens flare",filter:{brightness:e.Fltr.Brgh,position:{x:e.Fltr.FlrC.Hrzn,y:e.Fltr.FlrC.Vrtc},lensType:jo.decode(e.Fltr["Lns "])}});case"smartSharpen":return h(h({},n),{type:"smart sharpen",filter:{amount:oe(e.Fltr.Amnt),radius:ie(e.Fltr["Rds "]),threshold:e.Fltr.Thsh,angle:e.Fltr.Angl,moreAccurate:e.Fltr.moreAccurate,blur:Wo.decode(e.Fltr.blur),preset:e.Fltr.preset,shadow:{fadeAmount:oe(e.Fltr.sdwM.Amnt),tonalWidth:oe(e.Fltr.sdwM.Wdth),radius:e.Fltr.sdwM["Rds "]},highlight:{fadeAmount:oe(e.Fltr.hglM.Amnt),tonalWidth:oe(e.Fltr.hglM.Wdth),radius:e.Fltr.hglM["Rds "]}}});case"UnsM":return h(h({},n),{type:"unsharp mask",filter:{amount:oe(e.Fltr.Amnt),radius:ie(e.Fltr["Rds "]),threshold:e.Fltr.Thsh}});case"Dfs ":return h(h({},n),{type:"diffuse",filter:{mode:Xo.decode(e.Fltr["Md  "]),randomSeed:e.Fltr.FlRs}});case"Embs":return h(h({},n),{type:"emboss",filter:{angle:e.Fltr.Angl,height:e.Fltr.Hght,amount:e.Fltr.Amnt}});case"Extr":return h(h({},n),{type:"extrude",filter:{type:qo.decode(e.Fltr.ExtT),size:e.Fltr.ExtS,depth:e.Fltr.ExtD,depthMode:$o.decode(e.Fltr.ExtR),randomSeed:e.Fltr.FlRs,solidFrontFaces:e.Fltr.ExtF,maskIncompleteBlocks:e.Fltr.ExtM}});case"Tls ":return h(h({},n),{type:"tiles",filter:{numberOfTiles:e.Fltr.TlNm,maximumOffset:e.Fltr.TlOf,fillEmptyAreaWith:Zo.decode(e.Fltr.FlCl),randomSeed:e.Fltr.FlRs}});case"TrcC":return h(h({},n),{type:"trace contour",filter:{level:e.Fltr["Lvl "],edge:Yo.decode(e.Fltr["Edg "])}});case"Wnd ":return h(h({},n),{type:"wind",filter:{method:Ko.decode(e.Fltr.WndM),direction:Jo.decode(e.Fltr.Drct)}});case"Dntr":return h(h({},n),{type:"de-interlace",filter:{eliminate:Qo.decode(e.Fltr.IntE),newFieldsBy:es.decode(e.Fltr.IntC)}});case"Cstm":return h(h({},n),{type:"custom",filter:{scale:e.Fltr["Scl "],offset:e.Fltr.Ofst,matrix:e.Fltr.Mtrx}});case"HghP":return h(h({},n),{type:"high pass",filter:{radius:ie(e.Fltr["Rds "])}});case"Mxm ":return h(h({},n),{type:"maximum",filter:{radius:ie(e.Fltr["Rds "])}});case"Mnm ":return h(h({},n),{type:"minimum",filter:{radius:ie(e.Fltr["Rds "])}});case"Ofst":return h(h({},n),{type:"offset",filter:{horizontal:e.Fltr.Hrzn,vertical:e.Fltr.Vrtc,undefinedAreas:ts.decode(e.Fltr["Fl  "])}});case"rigidTransform":return h(h({},n),{type:"puppet",filter:{rigidType:e.Fltr.rigidType,bounds:[{x:e.Fltr.PuX0,y:e.Fltr.PuY0},{x:e.Fltr.PuX1,y:e.Fltr.PuY1},{x:e.Fltr.PuX2,y:e.Fltr.PuY2},{x:e.Fltr.PuX3,y:e.Fltr.PuY3}],puppetShapeList:e.Fltr.puppetShapeList.map(function(s){return{rigidType:s.rigidType,originalVertexArray:Pa(s.originalVertexArray),deformedVertexArray:Pa(s.deformedVertexArray),indexArray:Array.from(nu(s.indexArray)),pinOffsets:zn(s.pinOffsets),posFinalPins:zn(s.posFinalPins),pinVertexIndices:s.pinVertexIndices,selectedPin:s.selectedPin,pinPosition:zn(s.PinP),pinRotation:s.PnRt,pinOverlay:s.PnOv,pinDepth:s.PnDp,meshQuality:s.meshQuality,meshExpansion:s.meshExpansion,meshRigidity:s.meshRigidity,imageResolution:s.imageResolution,meshBoundaryPath:{pathComponents:s.meshBoundaryPath.pathComponents.map(function(c){return{shapeOperation:c.shapeOperation.split(".")[1],paths:c.SbpL.map(function(l){return{closed:l.Clsp,points:l["Pts "].map(function(u){return{anchor:jt(u.Anch),forward:jt(u["Fwd "]),backward:jt(u["Bwd "]),smooth:u.Smoo}})}})}})}}})}});case"PbPl":{for(var i=[],r=e.Fltr,a=0;a<Te.length&&r["PN".concat(Te[a],"a")];a++)for(var o=0;o<Te.length&&r["PN".concat(Te[a]).concat(Te[o])];o++)i.push({name:r["PN".concat(Te[a]).concat(Te[o])],value:r["PF".concat(Te[a]).concat(Te[o])]});return h(h({},n),{type:"oil paint plugin",filter:{name:e.Fltr.KnNm,gpu:e.Fltr.GpuY,lighting:e.Fltr.LIWy,parameters:i}})}case"HsbP":return h(h({},n),{type:"hsb/hsl",filter:{inputMode:Hn.decode(e.Fltr.Inpt),rowOrder:Hn.decode(e.Fltr.Otpt)}});case"oilPaint":return h(h({},n),{type:"oil paint",filter:{lightingOn:e.Fltr.lightingOn,stylization:e.Fltr.stylization,cleanliness:e.Fltr.cleanliness,brushScale:e.Fltr.brushScale,microBrush:e.Fltr.microBrush,lightDirection:e.Fltr.LghD,specularity:e.Fltr.specularity}});case"LqFy":return h(h({},n),{type:"liquify",filter:{liquifyMesh:e.Fltr.LqMe}});case"perspectiveWarpTransform":return h(h({},n),{type:"perspective warp",filter:{vertices:e.Fltr.vertices.map(jt),warpedVertices:e.Fltr.warpedVertices.map(jt),quads:e.Fltr.quads.map(function(s){return s.indices})}});case"Crvs":return h(h({},n),{type:"curves",filter:h({presetKind:ns.decode(e.Fltr.presetKind)},e.Fltr.Adjs?{adjustments:e.Fltr.Adjs.map(function(s){var c=s.Chnl.map(rn.decode);if(s["Crv "])return{channels:c,curve:s["Crv "].map(function(l){var u={x:l.Hrzn,y:l.Vrtc};return l.Cnty&&(u.curved=!0),u})};if(s.Mpng)return{channels:c,values:s.Mpng};throw new Error("Unknown curve adjustment")})}:{})});case"BrgC":return h(h({},n),{type:"brightness/contrast",filter:{brightness:e.Fltr.Brgh,contrast:e.Fltr.Cntr,useLegacy:!!e.Fltr.useLegacy}});default:if(t.throwForMissingFeatures)throw new Error("Unknown filter classId: ".concat(e.Fltr._classID));return}else switch(e.filterID){case 1098281575:return h(h({},n),{type:"average"});case 1114403360:return h(h({},n),{type:"blur"});case 1114403405:return h(h({},n),{type:"blur more"});case 1148416099:return h(h({},n),{type:"despeckle"});case 1180922912:return h(h({},n),{type:"facet"});case 1181902701:return h(h({},n),{type:"fragment"});case 1399353968:return h(h({},n),{type:"sharpen"});case 1399353925:return h(h({},n),{type:"sharpen edges"});case 1399353933:return h(h({},n),{type:"sharpen more"});case 1181639749:return h(h({},n),{type:"find edges"});case 1399616122:return h(h({},n),{type:"solarize"});case 1314149187:return h(h({},n),{type:"ntsc colors"});case 1231976050:return h(h({},n),{type:"invert"});default:if(t.throwForMissingFeatures)throw new Error("Unknown filterID: ".concat(e.filterID))}}function ru(e,t){return{enabled:e.enab,validAtPosition:e.validAtPosition,maskEnabled:e.filterMaskEnable,maskLinked:e.filterMaskLinked,maskExtendWithWhite:e.filterMaskExtendWithWhite,list:e.filterFXList.map(function(n){return iu(n,t)}).filter(function(n){return!!n})}}function Ye(e){return ce(e.radius,"radius")}function au(e){var t={_name:"",_classID:"filterFX","Nm  ":e.name,blendOptions:{_name:"",_classID:"blendOptions",Opct:_e(e.opacity),"Md  ":Ne.encode(e.blendMode)},enab:e.enabled,hasoptions:e.hasOptions,FrgC:$e(e.foregroundColor),BckC:$e(e.backgroundColor)};switch(e.type){case"average":return h(h({},t),{filterID:1098281575});case"blur":return h(h({},t),{filterID:1114403360});case"blur more":return h(h({},t),{filterID:1114403405});case"box blur":return h(h({},t),{Fltr:{_name:"Box Blur",_classID:"boxblur","Rds ":Ye(e.filter)},filterID:697});case"gaussian blur":return h(h({},t),{Fltr:{_name:"Gaussian Blur",_classID:"GsnB","Rds ":Ye(e.filter)},filterID:1198747202});case"motion blur":return h(h({},t),{Fltr:{_name:"Motion Blur",_classID:"MtnB",Angl:e.filter.angle,Dstn:ce(e.filter.distance,"distance")},filterID:1299476034});case"radial blur":return h(h({},t),{Fltr:{_name:"Radial Blur",_classID:"RdlB",Amnt:e.filter.amount,BlrM:To.encode(e.filter.method),BlrQ:Oo.encode(e.filter.quality)},filterID:1382313026});case"shape blur":return h(h({},t),{Fltr:{_name:"Shape Blur",_classID:"shapeBlur","Rds ":Ye(e.filter),customShape:{_name:"",_classID:"customShape","Nm  ":e.filter.customShape.name,Idnt:e.filter.customShape.id}},filterID:702});case"smart blur":return h(h({},t),{Fltr:{_name:"Smart Blur",_classID:"SmrB","Rds ":e.filter.radius,Thsh:e.filter.threshold,SmBQ:Ro.encode(e.filter.quality),SmBM:Mo.encode(e.filter.mode)},filterID:1399681602});case"surface blur":return h(h({},t),{Fltr:{_name:"Surface Blur",_classID:"surfaceBlur","Rds ":Ye(e.filter),Thsh:e.filter.threshold},filterID:701});case"displace":return h(h({},t),{Fltr:{_name:"Displace",_classID:"Dspl",HrzS:e.filter.horizontalScale,VrtS:e.filter.verticalScale,DspM:Bo.encode(e.filter.displacementMap),UndA:Ot.encode(e.filter.undefinedAreas),DspF:{sig:e.filter.displacementFile.signature,path:e.filter.displacementFile.path}},filterID:1148416108});case"pinch":return h(h({},t),{Fltr:{_name:"Pinch",_classID:"Pnch",Amnt:e.filter.amount},filterID:1349411688});case"polar coordinates":return h(h({},t),{Fltr:{_name:"Polar Coordinates",_classID:"Plr ",Cnvr:_o.encode(e.filter.conversion)},filterID:1349284384});case"ripple":return h(h({},t),{Fltr:{_name:"Ripple",_classID:"Rple",Amnt:e.filter.amount,RplS:No.encode(e.filter.size)},filterID:1383099493});case"shear":return h(h({},t),{Fltr:{_name:"Shear",_classID:"Shr ",ShrP:e.filter.shearPoints.map(function(c){return{_name:"",_classID:"Pnt ",Hrzn:c.x,Vrtc:c.y}}),UndA:Ot.encode(e.filter.undefinedAreas),ShrS:e.filter.shearStart,ShrE:e.filter.shearEnd},filterID:1399353888});case"spherize":return h(h({},t),{Fltr:{_name:"Spherize",_classID:"Sphr",Amnt:e.filter.amount,SphM:zo.encode(e.filter.mode)},filterID:1399875698});case"twirl":return h(h({},t),{Fltr:{_name:"Twirl",_classID:"Twrl",Angl:e.filter.angle},filterID:1417114220});case"wave":return h(h({},t),{Fltr:{_name:"Wave",_classID:"Wave",Wvtp:Go.encode(e.filter.type),NmbG:e.filter.numberOfGenerators,WLMn:e.filter.wavelength.min,WLMx:e.filter.wavelength.max,AmMn:e.filter.amplitude.min,AmMx:e.filter.amplitude.max,SclH:e.filter.scale.x,SclV:e.filter.scale.y,UndA:Ot.encode(e.filter.undefinedAreas),RndS:e.filter.randomSeed},filterID:1466005093});case"zigzag":return h(h({},t),{Fltr:{_name:"ZigZag",_classID:"ZgZg",Amnt:e.filter.amount,NmbR:e.filter.ridges,ZZTy:Uo.encode(e.filter.style)},filterID:1516722791});case"add noise":return h(h({},t),{Fltr:{_name:"Add Noise",_classID:"AdNs",Dstr:Vo.encode(e.filter.distribution),Nose:_e(e.filter.amount),Mnch:e.filter.monochromatic,FlRs:e.filter.randomSeed},filterID:1097092723});case"despeckle":return h(h({},t),{filterID:1148416099});case"dust and scratches":return h(h({},t),{Fltr:{_name:"Dust & Scratches",_classID:"DstS","Rds ":e.filter.radius,Thsh:e.filter.threshold},filterID:1148417107});case"median":return h(h({},t),{Fltr:{_name:"Median",_classID:"Mdn ","Rds ":Ye(e.filter)},filterID:1298427424});case"reduce noise":return h(h({},t),{Fltr:{_name:"Reduce Noise",_classID:"denoise",ClNs:_e(e.filter.reduceColorNoise),Shrp:_e(e.filter.sharpenDetails),removeJPEGArtifact:e.filter.removeJpegArtifact,channelDenoise:e.filter.channelDenoise.map(function(c){return h({_name:"",_classID:"channelDenoiseParams",Chnl:c.channels.map(function(l){return rn.encode(l)}),Amnt:c.amount},c.preserveDetails?{EdgF:c.preserveDetails}:{})}),preset:e.filter.preset},filterID:633});case"color halftone":return h(h({},t),{Fltr:{_name:"Color Halftone",_classID:"ClrH","Rds ":e.filter.radius,Ang1:e.filter.angle1,Ang2:e.filter.angle2,Ang3:e.filter.angle3,Ang4:e.filter.angle4},filterID:1131180616});case"crystallize":return h(h({},t),{Fltr:{_name:"Crystallize",_classID:"Crst",ClSz:e.filter.cellSize,FlRs:e.filter.randomSeed},filterID:1131574132});case"facet":return h(h({},t),{filterID:1180922912});case"fragment":return h(h({},t),{filterID:1181902701});case"mezzotint":return h(h({},t),{Fltr:{_name:"Mezzotint",_classID:"Mztn",MztT:Ho.encode(e.filter.type),FlRs:e.filter.randomSeed},filterID:1299870830});case"mosaic":return h(h({},t),{Fltr:{_name:"Mosaic",_classID:"Msc ",ClSz:ce(e.filter.cellSize,"cellSize")},filterID:1299407648});case"pointillize":return h(h({},t),{Fltr:{_name:"Pointillize",_classID:"Pntl",ClSz:e.filter.cellSize,FlRs:e.filter.randomSeed},filterID:1349416044});case"clouds":return h(h({},t),{Fltr:{_name:"Clouds",_classID:"Clds",FlRs:e.filter.randomSeed},filterID:1131177075});case"difference clouds":return h(h({},t),{Fltr:{_name:"Difference Clouds",_classID:"DfrC",FlRs:e.filter.randomSeed},filterID:1147564611});case"fibers":return h(h({},t),{Fltr:{_name:"Fibers",_classID:"Fbrs",Vrnc:e.filter.variance,Strg:e.filter.strength,RndS:e.filter.randomSeed},filterID:1180856947});case"lens flare":return h(h({},t),{Fltr:{_name:"Lens Flare",_classID:"LnsF",Brgh:e.filter.brightness,FlrC:{_name:"",_classID:"Pnt ",Hrzn:e.filter.position.x,Vrtc:e.filter.position.y},"Lns ":jo.encode(e.filter.lensType)},filterID:1282306886});case"sharpen":return h(h({},t),{filterID:1399353968});case"sharpen edges":return h(h({},t),{filterID:1399353925});case"sharpen more":return h(h({},t),{filterID:1399353933});case"smart sharpen":return h(h({},t),{Fltr:{_name:"Smart Sharpen",_classID:"smartSharpen",Amnt:_e(e.filter.amount),"Rds ":Ye(e.filter),Thsh:e.filter.threshold,Angl:e.filter.angle,moreAccurate:e.filter.moreAccurate,blur:Wo.encode(e.filter.blur),preset:e.filter.preset,sdwM:{_name:"Parameters",_classID:"adaptCorrectTones",Amnt:_e(e.filter.shadow.fadeAmount),Wdth:_e(e.filter.shadow.tonalWidth),"Rds ":e.filter.shadow.radius},hglM:{_name:"Parameters",_classID:"adaptCorrectTones",Amnt:_e(e.filter.highlight.fadeAmount),Wdth:_e(e.filter.highlight.tonalWidth),"Rds ":e.filter.highlight.radius}},filterID:698});case"unsharp mask":return h(h({},t),{Fltr:{_name:"Unsharp Mask",_classID:"UnsM",Amnt:_e(e.filter.amount),"Rds ":Ye(e.filter),Thsh:e.filter.threshold},filterID:1433301837});case"diffuse":return h(h({},t),{Fltr:{_name:"Diffuse",_classID:"Dfs ","Md  ":Xo.encode(e.filter.mode),FlRs:e.filter.randomSeed},filterID:1147564832});case"emboss":return h(h({},t),{Fltr:{_name:"Emboss",_classID:"Embs",Angl:e.filter.angle,Hght:e.filter.height,Amnt:e.filter.amount},filterID:1164796531});case"extrude":return h(h({},t),{Fltr:{_name:"Extrude",_classID:"Extr",ExtS:e.filter.size,ExtD:e.filter.depth,ExtF:e.filter.solidFrontFaces,ExtM:e.filter.maskIncompleteBlocks,ExtT:qo.encode(e.filter.type),ExtR:$o.encode(e.filter.depthMode),FlRs:e.filter.randomSeed},filterID:1165522034});case"find edges":return h(h({},t),{filterID:1181639749});case"solarize":return h(h({},t),{filterID:1399616122});case"tiles":return h(h({},t),{Fltr:{_name:"Tiles",_classID:"Tls ",TlNm:e.filter.numberOfTiles,TlOf:e.filter.maximumOffset,FlCl:Zo.encode(e.filter.fillEmptyAreaWith),FlRs:e.filter.randomSeed},filterID:1416393504});case"trace contour":return h(h({},t),{Fltr:{_name:"Trace Contour",_classID:"TrcC","Lvl ":e.filter.level,"Edg ":Yo.encode(e.filter.edge)},filterID:1416782659});case"wind":return h(h({},t),{Fltr:{_name:"Wind",_classID:"Wnd ",WndM:Ko.encode(e.filter.method),Drct:Jo.encode(e.filter.direction)},filterID:1466852384});case"de-interlace":return h(h({},t),{Fltr:{_name:"De-Interlace",_classID:"Dntr",IntE:Qo.encode(e.filter.eliminate),IntC:es.encode(e.filter.newFieldsBy)},filterID:1148089458});case"ntsc colors":return h(h({},t),{filterID:1314149187});case"invert":return h(h({},t),{filterID:1231976050});case"custom":return h(h({},t),{Fltr:{_name:"Custom",_classID:"Cstm","Scl ":e.filter.scale,Ofst:e.filter.offset,Mtrx:e.filter.matrix},filterID:1131639917});case"high pass":return h(h({},t),{Fltr:{_name:"High Pass",_classID:"HghP","Rds ":Ye(e.filter)},filterID:1214736464});case"maximum":return h(h({},t),{Fltr:{_name:"Maximum",_classID:"Mxm ","Rds ":Ye(e.filter)},filterID:1299737888});case"minimum":return h(h({},t),{Fltr:{_name:"Minimum",_classID:"Mnm ","Rds ":Ye(e.filter)},filterID:1299082528});case"offset":return h(h({},t),{Fltr:{_name:"Offset",_classID:"Ofst",Hrzn:e.filter.horizontal,Vrtc:e.filter.vertical,"Fl  ":ts.encode(e.filter.undefinedAreas)},filterID:1332114292});case"puppet":return h(h({},t),{Fltr:{_name:"Rigid Transform",_classID:"rigidTransform",null:["Ordn.Trgt"],rigidType:e.filter.rigidType,puppetShapeList:e.filter.puppetShapeList.map(function(c){return{_name:"",_classID:"puppetShape",rigidType:c.rigidType,VrsM:1,VrsN:0,originalVertexArray:bi(new Float32Array(Ht(c.originalVertexArray))),deformedVertexArray:bi(new Float32Array(Ht(c.deformedVertexArray))),indexArray:bi(new Uint32Array(c.indexArray)),pinOffsets:Ht(c.pinOffsets),posFinalPins:Ht(c.posFinalPins),pinVertexIndices:c.pinVertexIndices,PinP:Ht(c.pinPosition),PnRt:c.pinRotation,PnOv:c.pinOverlay,PnDp:c.pinDepth,meshQuality:c.meshQuality,meshExpansion:c.meshExpansion,meshRigidity:c.meshRigidity,imageResolution:c.imageResolution,meshBoundaryPath:{_name:"",_classID:"pathClass",pathComponents:c.meshBoundaryPath.pathComponents.map(function(l){return{_name:"",_classID:"PaCm",shapeOperation:"shapeOperation.".concat(l.shapeOperation),SbpL:l.paths.map(function(u){return{_name:"",_classID:"Sbpl",Clsp:u.closed,"Pts ":u.points.map(function(d){return{_name:"",_classID:"Pthp",Anch:Wt(d.anchor),"Fwd ":Wt(d.forward),"Bwd ":Wt(d.backward),Smoo:d.smooth}})}})}})},selectedPin:c.selectedPin}}),PuX0:e.filter.bounds[0].x,PuX1:e.filter.bounds[1].x,PuX2:e.filter.bounds[2].x,PuX3:e.filter.bounds[3].x,PuY0:e.filter.bounds[0].y,PuY1:e.filter.bounds[1].y,PuY2:e.filter.bounds[2].y,PuY3:e.filter.bounds[3].y},filterID:991});case"oil paint plugin":{for(var n={},i=0;i<e.filter.parameters.length;i++){var r=e.filter.parameters[i],a=r.name,o=r.value,s="".concat(Te[Math.floor(i/Te.length)]).concat(Te[i%Te.length]);n["PN".concat(s)]=a,n["PT".concat(s)]=0,n["PF".concat(s)]=o}return h(h({},t),{Fltr:h({_name:"Oil Paint Plugin",_classID:"PbPl",KnNm:e.filter.name,GpuY:e.filter.gpu,LIWy:e.filter.lighting,FPth:"1"},n),filterID:1348620396})}case"oil paint":return h(h({},t),{Fltr:{_name:"Oil Paint",_classID:"oilPaint",lightingOn:e.filter.lightingOn,stylization:e.filter.stylization,cleanliness:e.filter.cleanliness,brushScale:e.filter.brushScale,microBrush:e.filter.microBrush,LghD:e.filter.lightDirection,specularity:e.filter.specularity},filterID:1122});case"liquify":return h(h({},t),{Fltr:{_name:"Liquify",_classID:"LqFy",LqMe:e.filter.liquifyMesh},filterID:1282492025});case"perspective warp":return h(h({},t),{Fltr:{_name:"Perspective Warp",_classID:"perspectiveWarpTransform",vertices:e.filter.vertices.map(Wt),warpedVertices:e.filter.warpedVertices.map(Wt),quads:e.filter.quads.map(function(c){return{indices:c}})},filterID:442});case"curves":return h(h({},t),{Fltr:h({_name:"Curves",_classID:"Crvs",presetKind:ns.encode(e.filter.presetKind)},e.filter.adjustments?{Adjs:e.filter.adjustments.map(function(c){return"curve"in c?{_name:"",_classID:"CrvA",Chnl:c.channels.map(rn.encode),"Crv ":c.curve.map(function(l){return h({_name:"",_classID:"Pnt ",Hrzn:l.x,Vrtc:l.y},l.curved?{Cnty:!0}:{})})}:{_name:"",_classID:"CrvA",Chnl:c.channels.map(rn.encode),Mpng:c.values}})}:{}),filterID:1131574899});case"brightness/contrast":return h(h({},t),{Fltr:{_name:"Brightness/Contrast",_classID:"BrgC",Brgh:e.filter.brightness,Cntr:e.filter.contrast,useLegacy:!!e.filter.useLegacy},filterID:1114793795});default:throw new Error("Unknow filter type: ".concat(e.type))}}function xs(e){if(e.warp)return e.warp;if(!e.width||!e.height)throw new Error("You must provide width and height of the linked image in placedLayer");var t=e.width,n=e.height,i=0,r=t/3,a=t*2/3,o=t,s=0,c=n/3,l=n*2/3,u=n;return{style:"custom",value:0,perspective:0,perspectiveOther:0,rotate:"horizontal",bounds:{top:{value:0,units:"Pixels"},left:{value:0,units:"Pixels"},bottom:{value:n,units:"Pixels"},right:{value:t,units:"Pixels"}},uOrder:4,vOrder:4,customEnvelopeWarp:{meshPoints:[{x:i,y:s},{x:r,y:s},{x:a,y:s},{x:o,y:s},{x:i,y:c},{x:r,y:c},{x:a,y:c},{x:o,y:c},{x:i,y:l},{x:r,y:l},{x:a,y:l},{x:o,y:l},{x:i,y:u},{x:r,y:u},{x:a,y:u},{x:o,y:u}]}}}N("SoLd",ae("placedLayer"),function(e,t,n){if(se(e)!=="soLD")throw new Error("Invalid SoLd type");var i=_(e);if(i!==4&&i!==5)throw new Error("Invalid SoLd version");var r=Y(e,!0);t.placedLayer={id:r.Idnt,placed:r.placed,type:Dt[r.Type],pageNumber:r.PgNm,totalPages:r.totalPages,frameStep:Ee(r.frameStep),duration:Ee(r.duration),frameCount:r.frameCount,transform:r.Trnf,width:r["Sz  "].Wdth,height:r["Sz  "].Hght,resolution:ie(r.Rslt),warp:Ss(r.quiltWarp||r.warp)},r.nonAffineTransform&&r.nonAffineTransform.some(function(a,o){return a!==r.Trnf[o]})&&(t.placedLayer.nonAffineTransform=r.nonAffineTransform),r.Crop&&(t.placedLayer.crop=r.Crop),r.comp&&(t.placedLayer.comp=r.comp),r.compInfo&&(t.placedLayer.compInfo={compID:r.compInfo.compID,originalCompID:r.compInfo.originalCompID}),r.filterFX&&(t.placedLayer.filter=ru(r.filterFX,e)),R(e,n())},function(e,t){var n,i;U(e,"soLD"),H(e,4);var r=t.placedLayer;if(!r.id||typeof r.id!="string"||!/^[0-9a-f]{8}-([0-9a-f]{4}-){3}[0-9a-f]{12}$/.test(r.id))throw new Error("Placed layer ID must be in a GUID format (example: 20953ddb-9391-11ec-b4f1-c15674f50bc4)");var a=h(h({Idnt:r.id,placed:(n=r.placed)!==null&&n!==void 0?n:r.id,PgNm:r.pageNumber||1,totalPages:r.totalPages||1},r.crop?{Crop:r.crop}:{}),{frameStep:r.frameStep||{numerator:0,denominator:600},duration:r.duration||{numerator:0,denominator:600},frameCount:r.frameCount||0,Annt:16,Type:Dt.indexOf(r.type),Trnf:r.transform,nonAffineTransform:(i=r.nonAffineTransform)!==null&&i!==void 0?i:r.transform,warp:Wn(xs(r)),"Sz  ":{_name:"",_classID:"Pnt ",Wdth:r.width||0,Hght:r.height||0},Rslt:r.resolution?ce(r.resolution,"resolution"):{units:"Density",value:72}});if(r.filter&&(a.filterFX={_name:"",_classID:"filterFXStyle",enab:r.filter.enabled,validAtPosition:r.filter.validAtPosition,filterMaskEnable:r.filter.maskEnabled,filterMaskLinked:r.filter.maskLinked,filterMaskExtendWithWhite:r.filter.maskExtendWithWhite,filterFXList:r.filter.list.map(function(s){return au(s)})}),r.warp&&Hi(r.warp)){var o=Wn(r.warp);a.quiltWarp=o,a.warp={warpStyle:"warpStyle.warpNone",warpValue:o.warpValue,warpPerspective:o.warpPerspective,warpPerspectiveOther:o.warpPerspectiveOther,warpRotate:o.warpRotate,bounds:o.bounds,uOrder:o.uOrder,vOrder:o.vOrder}}else delete a.quiltWarp;r.comp&&(a.comp=r.comp),r.compInfo&&(a.compInfo=r.compInfo),K(e,"","null",a,a.quiltWarp?"quiltWarp":"warp")});zt("SoLE","SoLd");N("fxrp",ae("referencePoint"),function(e,t){t.referencePoint={x:ze(e),y:ze(e)}},function(e,t){Ke(e,t.referencePoint.x),Ke(e,t.referencePoint.y)});N("Lr16",function(){return!1},function(e,t,n,i,r){zi(e,i,r)},function(e,t){});N("Lr32",function(){return!1},function(e,t,n,i,r){zi(e,i,r)},function(e,t){});N("LMsk",ae("userMask"),function(e,t){t.userMask={colorSpace:Se(e),opacity:E(e)/255};var n=T(e);if(n!==128)throw new Error("Invalid flag value");R(e,1)},function(e,t){var n=t.userMask;Fe(e,n.colorSpace),I(e,ao(n.opacity,0,1)*255),B(e,128),re(e,1)});N("Patt",function(e){return!e},function(e,t,n){n()&&R(e,n())},function(e,t){});function Da(e){var t=_(e),n=_(e),i=_(e),r=_(e);return{top:t,left:n,bottom:i,right:r}}function Ta(e,t){H(e,t.top),H(e,t.left),H(e,t.bottom),H(e,t.right)}N("Anno",function(e){return e.annotations!==void 0},function(e,t,n){var i=E(e),r=E(e);if(i!==2||r!==1)throw new Error("Invalid Anno version");for(var a=L(e),o=[],s=0;s<a;s++){L(e);var c=se(e),l=!!T(e);T(e),E(e);var u=Da(e),d=Da(e),p=Se(e),f=pt(e,2),m=pt(e,2),v=pt(e,2);L(e),se(e);var x=L(e),b=void 0;if(c==="txtA")x>=2&&E(e)===65279?b=Ni(e,(x-2)/2):(e.offset-=2,b=Kn(e,x)),b=b.replace(/\r/g,`
`);else if(c==="sndA")b=Ce(e,x);else throw new Error("Unknown annotation type");o.push({type:c==="txtA"?"text":"sound",open:l,iconLocation:u,popupLocation:d,color:p,author:f,name:m,date:v,data:b})}t.annotations=o,R(e,n())},function(e,t){var n=t.annotations;I(e,2),I(e,1),D(e,n.length);for(var i=0,r=n;i<r.length;i++){var a=r[i],o=a.type==="sound";if(o&&!(a.data instanceof Uint8Array))throw new Error("Sound annotation data should be Uint8Array");if(!o&&typeof a.data!="string")throw new Error("Text annotation data should be string");var s=e.offset;D(e,0),U(e,o?"sndA":"txtA"),B(e,a.open?1:0),B(e,28),I(e,1),Ta(e,a.iconLocation),Ta(e,a.popupLocation),Fe(e,a.color),Mt(e,a.author||"",2),Mt(e,a.name||"",2),Mt(e,a.date||"",2);var c=e.offset;D(e,0),U(e,o?"sndM":"txtC"),D(e,0);var l=e.offset;if(o)st(e,a.data);else{I(e,65279);for(var u=a.data.replace(/\n/g,"\r"),d=0;d<u.length;d++)I(e,u.charCodeAt(d))}e.view.setUint32(s,e.offset-s,!1),e.view.setUint32(c,e.offset-c,!1),e.view.setUint32(l-4,e.offset-l,!1)}});function Fs(e){N(e,function(t){var n=t;return!(!n.linkedFiles||!n.linkedFiles.length||e==="lnkE"&&!n.linkedFiles.some(function(i){return i.linkedFile}))},function(t,n,i,r){var a=n;for(a.linkedFiles=a.linkedFiles||[];i()>8;){var o=mi(t),s=t.offset,c=se(t),l=_(t),u=pt(t,1),d=ke(t),p=se(t).trim(),f=se(t).trim(),m=mi(t),v=T(t),x=v?Y(t):void 0,b=c==="liFE"?Y(t):void 0,y={id:u,name:d};if(p&&(y.type=p),f&&(y.creator=f),x&&(y.descriptor={compInfo:{compID:x.compInfo.compID,originalCompID:x.compInfo.originalCompID}}),c==="liFE"&&l>3){var S=_(t),g=T(t),F=T(t),w=T(t),k=T(t),C=ze(t),O=Math.floor(C),P=(C-O)*1e3;y.time=new Date(Date.UTC(S,g,F,w,k,O,P)).toISOString()}var M=c==="liFE"?mi(t):0;for(c==="liFA"&&R(t,8),c==="liFD"&&(y.data=Ce(t,m)),l>=5&&(y.childDocumentID=ke(t)),l>=6&&(y.assetModTime=ze(t)),l>=7&&(y.assetLockedState=T(t)),c==="liFE"&&l===2&&(y.data=Ce(t,M)),t.skipLinkedFilesData&&(y.data=void 0),e==="lnkE"&&(y.linkedFile={fileSize:M,name:b?.["Nm  "]||"",fullPath:b?.fullPath||"",originalPath:b?.originalPath||"",relativePath:b?.relPath||""}),a.linkedFiles.push(y);o%4;)o++;t.offset=s+o}R(t,i())},function(t,n){for(var i,r,a,o,s,c,l,u,d,p=n,f=0,m=p.linkedFiles;f<m.length;f++){var v=m[f];if(e==="lnkE"==!!v.linkedFile){var x=2;v.assetLockedState!=null?x=7:v.assetModTime!=null?x=6:v.childDocumentID!=null?x=5:e=="lnkE"&&(x=3),gi(t,0);var b=t.offset;if(U(t,e==="lnkE"?"liFE":v.data?"liFD":"liFA"),H(t,x),!v.id||typeof v.id!="string"||!/^[0-9a-f]{8}-([0-9a-f]{4}-){3}[0-9a-f]{12}$/.test(v.id))throw new Error("Linked file ID must be in a GUID format (example: 20953ddb-9391-11ec-b4f1-c15674f50bc4)");if(Mt(t,v.id,1),xt(t,v.name||""),U(t,v.type?"".concat(v.type,"    ").substring(0,4):"    "),U(t,v.creator?"".concat(v.creator,"    ").substring(0,4):"\0\0\0\0"),gi(t,v.data?v.data.byteLength:0),v.descriptor&&v.descriptor.compInfo){var y={compInfo:{compID:v.descriptor.compInfo.compID,originalCompID:v.descriptor.compInfo.originalCompID}};B(t,1),K(t,"","null",y)}else B(t,0);if(e==="lnkE"){var y={descVersion:2,"Nm  ":(r=(i=v.linkedFile)===null||i===void 0?void 0:i.name)!==null&&r!==void 0?r:"",fullPath:(o=(a=v.linkedFile)===null||a===void 0?void 0:a.fullPath)!==null&&o!==void 0?o:"",originalPath:(c=(s=v.linkedFile)===null||s===void 0?void 0:s.originalPath)!==null&&c!==void 0?c:"",relPath:(u=(l=v.linkedFile)===null||l===void 0?void 0:l.relativePath)!==null&&u!==void 0?u:""};K(t,"","ExternalFileLink",y);var S=v.time?new Date(v.time):new Date;H(t,S.getUTCFullYear()),B(t,S.getUTCMonth()),B(t,S.getUTCDate()),B(t,S.getUTCHours()),B(t,S.getUTCMinutes()),Ke(t,S.getUTCSeconds()+S.getUTCMilliseconds()/1e3)}v.data?st(t,v.data):gi(t,((d=v.linkedFile)===null||d===void 0?void 0:d.fileSize)||0),x>=5&&xt(t,v.childDocumentID||""),x>=6&&Ke(t,v.assetModTime||0),x>=7&&B(t,v.assetLockedState||0);var g=t.offset-b;for(t.view.setUint32(b-4,g,!1);g%4;)g++,B(t,0)}}})}Fs("lnk2");Fs("lnkE");zt("lnkD","lnk2");zt("lnk3","lnk2");N("pths",ae("pathList"),function(e,t){Y(e,!0),t.pathList=[]},function(e,t){var n={pathList:[]};K(e,"","pathsDataClass",n)});N("lyvr",ae("version"),function(e,t){return t.version=L(e)},function(e,t){return D(e,t.version)});N("lfxs",function(){return!1},function(e,t,n){var i=L(e);if(i!==0)throw new Error("Invalid lfxs version");var r=Y(e);t.effects=un(r,!!e.logMissingFeatures),R(e,n())},function(e,t,n,i){var r=cn(t.effects,!!i.logMissingFeatures,!0);D(e,0),K(e,"","null",r)});function Ie(e){return function(t){return!!t.adjustment&&t.adjustment.type===e}}N("brit",Ie("brightness/contrast"),function(e,t,n){t.adjustment||(t.adjustment={type:"brightness/contrast",brightness:Q(e),contrast:Q(e),meanValue:Q(e),labColorOnly:!!T(e),useLegacy:!0}),R(e,n())},function(e,t){var n,i=t.adjustment;ne(e,i.brightness||0),ne(e,i.contrast||0),ne(e,(n=i.meanValue)!==null&&n!==void 0?n:127),B(e,i.labColorOnly?1:0),re(e,1)});function Mn(e){var t=Q(e),n=Q(e),i=Q(e),r=Q(e),a=Q(e)/100;return{shadowInput:t,highlightInput:n,shadowOutput:i,highlightOutput:r,midtoneInput:a}}function Xt(e,t){ne(e,t.shadowInput),ne(e,t.highlightInput),ne(e,t.shadowOutput),ne(e,t.highlightOutput),ne(e,Math.round(t.midtoneInput*100))}N("levl",Ie("levels"),function(e,t,n){if(E(e)!==2)throw new Error("Invalid levl version");t.adjustment=h(h({},t.adjustment),{type:"levels",rgb:Mn(e),red:Mn(e),green:Mn(e),blue:Mn(e)}),R(e,n())},function(e,t){var n=t.adjustment,i={shadowInput:0,highlightInput:255,shadowOutput:0,highlightOutput:255,midtoneInput:1};I(e,2),Xt(e,n.rgb||i),Xt(e,n.red||i),Xt(e,n.blue||i),Xt(e,n.green||i);for(var r=0;r<59;r++)Xt(e,i)});function Rn(e){for(var t=E(e),n=[],i=0;i<t;i++){var r=Q(e),a=Q(e);n.push({input:a,output:r})}return n}function ft(e,t){I(e,t.length);for(var n=0,i=t;n<i.length;n++){var r=i[n];I(e,r.output),I(e,r.input)}}N("curv",Ie("curves"),function(e,t,n){if(T(e),E(e)!==1)throw new Error("Invalid curv version");E(e);var i=E(e),r={type:"curves"};i&1&&(r.rgb=Rn(e)),i&2&&(r.red=Rn(e)),i&4&&(r.green=Rn(e)),i&8&&(r.blue=Rn(e)),t.adjustment=h(h({},t.adjustment),r),R(e,n())},function(e,t){var n=t.adjustment,i=n.rgb,r=n.red,a=n.green,o=n.blue,s=0,c=0;i&&i.length&&(s|=1,c++),r&&r.length&&(s|=2,c++),a&&a.length&&(s|=4,c++),o&&o.length&&(s|=8,c++),B(e,0),I(e,1),I(e,0),I(e,s),i&&i.length&&ft(e,i),r&&r.length&&ft(e,r),a&&a.length&&ft(e,a),o&&o.length&&ft(e,o),U(e,"Crv "),I(e,4),I(e,0),I(e,c),i&&i.length&&(I(e,0),ft(e,i)),r&&r.length&&(I(e,1),ft(e,r)),a&&a.length&&(I(e,2),ft(e,a)),o&&o.length&&(I(e,3),ft(e,o))});N("expA",Ie("exposure"),function(e,t,n){if(E(e)!==1)throw new Error("Invalid expA version");t.adjustment=h(h({},t.adjustment),{type:"exposure",exposure:We(e),offset:We(e),gamma:We(e)}),R(e,n())},function(e,t){var n=t.adjustment;I(e,1),Xe(e,n.exposure),Xe(e,n.offset),Xe(e,n.gamma),re(e,2)});N("vibA",Ie("vibrance"),function(e,t,n){var i=Y(e);t.adjustment={type:"vibrance"},i.vibrance!==void 0&&(t.adjustment.vibrance=i.vibrance),i.Strt!==void 0&&(t.adjustment.saturation=i.Strt),R(e,n())},function(e,t){var n=t.adjustment,i={};n.vibrance!==void 0&&(i.vibrance=n.vibrance),n.saturation!==void 0&&(i.Strt=n.saturation),K(e,"","null",i)});function mt(e){return{a:Q(e),b:Q(e),c:Q(e),d:Q(e),hue:Q(e),saturation:Q(e),lightness:Q(e)}}function gt(e,t){var n=t||{};ne(e,n.a||0),ne(e,n.b||0),ne(e,n.c||0),ne(e,n.d||0),ne(e,n.hue||0),ne(e,n.saturation||0),ne(e,n.lightness||0)}N("hue2",Ie("hue/saturation"),function(e,t,n){if(E(e)!==2)throw new Error("Invalid hue2 version");t.adjustment=h(h({},t.adjustment),{type:"hue/saturation",master:mt(e),reds:mt(e),yellows:mt(e),greens:mt(e),cyans:mt(e),blues:mt(e),magentas:mt(e)}),R(e,n())},function(e,t){var n=t.adjustment;I(e,2),gt(e,n.master),gt(e,n.reds),gt(e,n.yellows),gt(e,n.greens),gt(e,n.cyans),gt(e,n.blues),gt(e,n.magentas)});function yi(e){return{cyanRed:Q(e),magentaGreen:Q(e),yellowBlue:Q(e)}}function Si(e,t){ne(e,t.cyanRed||0),ne(e,t.magentaGreen||0),ne(e,t.yellowBlue||0)}N("blnc",Ie("color balance"),function(e,t,n){t.adjustment={type:"color balance",shadows:yi(e),midtones:yi(e),highlights:yi(e),preserveLuminosity:!!T(e)},R(e,n())},function(e,t){var n=t.adjustment;Si(e,n.shadows||{}),Si(e,n.midtones||{}),Si(e,n.highlights||{}),B(e,n.preserveLuminosity?1:0),re(e,1)});N("blwh",Ie("black & white"),function(e,t,n){var i=Y(e);t.adjustment={type:"black & white",reds:i["Rd  "],yellows:i.Yllw,greens:i["Grn "],cyans:i["Cyn "],blues:i["Bl  "],magentas:i.Mgnt,useTint:!!i.useTint,presetKind:i.bwPresetKind,presetFileName:i.blackAndWhitePresetFileName},i.tintColor!==void 0&&(t.adjustment.tintColor=qe(i.tintColor)),R(e,n())},function(e,t){var n=t.adjustment,i={"Rd  ":n.reds||0,Yllw:n.yellows||0,"Grn ":n.greens||0,"Cyn ":n.cyans||0,"Bl  ":n.blues||0,Mgnt:n.magentas||0,useTint:!!n.useTint,tintColor:$e(n.tintColor),bwPresetKind:n.presetKind||0,blackAndWhitePresetFileName:n.presetFileName||""};K(e,"","null",i)});N("phfl",Ie("photo filter"),function(e,t,n){var i=E(e);if(i!==2&&i!==3)throw new Error("Invalid phfl version");var r;i===2?r=Se(e):r={l:_(e)/100,a:_(e)/100,b:_(e)/100},t.adjustment={type:"photo filter",color:r,density:L(e)/100,preserveLuminosity:!!T(e)},R(e,n())},function(e,t){var n=t.adjustment;I(e,2),Fe(e,n.color||{l:0,a:0,b:0}),D(e,(n.density||0)*100),B(e,n.preserveLuminosity?1:0),re(e,3)});function Bn(e){var t=Q(e),n=Q(e),i=Q(e);R(e,2);var r=Q(e);return{red:t,green:n,blue:i,constant:r}}function qt(e,t){var n=t||{};ne(e,n.red),ne(e,n.green),ne(e,n.blue),re(e,2),ne(e,n.constant)}N("mixr",Ie("channel mixer"),function(e,t,n){if(E(e)!==1)throw new Error("Invalid mixr version");var i=t.adjustment=h(h({},t.adjustment),{type:"channel mixer",monochrome:!!E(e)});i.monochrome||(i.red=Bn(e),i.green=Bn(e),i.blue=Bn(e)),i.gray=Bn(e),R(e,n())},function(e,t){var n=t.adjustment;I(e,1),I(e,n.monochrome?1:0),n.monochrome?(qt(e,n.gray),re(e,30)):(qt(e,n.red),qt(e,n.green),qt(e,n.blue),qt(e,n.gray))});var Oa=z("colorLookupType","3DLUT",{"3dlut":"3DLUT",abstractProfile:"abstractProfile",deviceLinkProfile:"deviceLinkProfile"}),Ma=z("LUTFormatType","look",{look:"LUTFormatLOOK",cube:"LUTFormatCUBE","3dl":"LUTFormat3DL"}),_n=z("colorLookupOrder","rgb",{rgb:"rgbOrder",bgr:"bgrOrder"});N("clrL",Ie("color lookup"),function(e,t,n){if(E(e)!==1)throw new Error("Invalid clrL version");var i=Y(e);t.adjustment={type:"color lookup"};var r=t.adjustment;i.lookupType!==void 0&&(r.lookupType=Oa.decode(i.lookupType)),i["Nm  "]!==void 0&&(r.name=i["Nm  "]),i.Dthr!==void 0&&(r.dither=i.Dthr),i.profile!==void 0&&(r.profile=i.profile),i.LUTFormat!==void 0&&(r.lutFormat=Ma.decode(i.LUTFormat)),i.dataOrder!==void 0&&(r.dataOrder=_n.decode(i.dataOrder)),i.tableOrder!==void 0&&(r.tableOrder=_n.decode(i.tableOrder)),i.LUT3DFileData!==void 0&&(r.lut3DFileData=i.LUT3DFileData),i.LUT3DFileName!==void 0&&(r.lut3DFileName=i.LUT3DFileName),R(e,n())},function(e,t){var n=t.adjustment,i={};n.lookupType!==void 0&&(i.lookupType=Oa.encode(n.lookupType)),n.name!==void 0&&(i["Nm  "]=n.name),n.dither!==void 0&&(i.Dthr=n.dither),n.profile!==void 0&&(i.profile=n.profile),n.lutFormat!==void 0&&(i.LUTFormat=Ma.encode(n.lutFormat)),n.dataOrder!==void 0&&(i.dataOrder=_n.encode(n.dataOrder)),n.tableOrder!==void 0&&(i.tableOrder=_n.encode(n.tableOrder)),n.lut3DFileData!==void 0&&(i.LUT3DFileData=n.lut3DFileData),n.lut3DFileName!==void 0&&(i.LUT3DFileName=n.lut3DFileName),I(e,1),K(e,"","null",i)});N("nvrt",Ie("invert"),function(e,t,n){t.adjustment={type:"invert"},R(e,n())},function(){});N("post",Ie("posterize"),function(e,t,n){t.adjustment={type:"posterize",levels:E(e)},R(e,n())},function(e,t){var n,i=t.adjustment;I(e,(n=i.levels)!==null&&n!==void 0?n:4),re(e,2)});N("thrs",Ie("threshold"),function(e,t,n){t.adjustment={type:"threshold",level:E(e)},R(e,n())},function(e,t){var n,i=t.adjustment;I(e,(n=i.level)!==null&&n!==void 0?n:128),re(e,2)});var Ra=["","","","rgb","hsb","","lab"];N("grdm",Ie("gradient map"),function(e,t,n){var i=E(e);if(i!==1&&i!==3)throw new Error("Invalid grdm version");var r={type:"gradient map",gradientType:"solid"};r.reverse=!!T(e),r.dither=!!T(e);var a=!!T(e);if(e.offset--,a){var o=se(e);r.method=_t.decode(o)}r.name=ke(e),r.colorStops=[],r.opacityStops=[];for(var s=E(e),c=0;c<s;c++)r.colorStops.push({location:L(e),midpoint:L(e)/100,color:Se(e)}),R(e,2);for(var l=E(e),c=0;c<l;c++)r.opacityStops.push({location:L(e),midpoint:L(e)/100,opacity:E(e)/255});var u=E(e);if(u!==2)throw new Error("Invalid grdm expansion count");var d=E(e);r.smoothness=d/4096;var p=E(e);if(p!==32)throw new Error("Invalid grdm length");r.gradientType=E(e)?"noise":"solid",r.randomSeed=L(e),r.addTransparency=!!E(e),r.restrictColors=!!E(e),r.roughness=L(e)/4096,r.colorModel=Ra[E(e)]||"rgb",r.min=[E(e)/32768,E(e)/32768,E(e)/32768,E(e)/32768],r.max=[E(e)/32768,E(e)/32768,E(e)/32768,E(e)/32768],R(e,n());for(var f=0,m=r.colorStops;f<m.length;f++){var v=m[f];v.location/=d}for(var x=0,b=r.opacityStops;x<b.length;x++){var v=b[x];v.location/=d}t.adjustment=r},function(e,t){var n,i,r,a=t.adjustment;I(e,a.method!==void 0?3:1),B(e,a.reverse?1:0),B(e,a.dither?1:0),a.method!==void 0&&U(e,_t.encode(a.method)),xt(e,a.name||""),I(e,a.colorStops&&a.colorStops.length||0);for(var o=Math.round(((n=a.smoothness)!==null&&n!==void 0?n:1)*4096),s=0,c=a.colorStops||[];s<c.length;s++){var l=c[s];D(e,Math.round(l.location*o)),D(e,Math.round(l.midpoint*100)),Fe(e,l.color),re(e,2)}I(e,a.opacityStops&&a.opacityStops.length||0);for(var u=0,d=a.opacityStops||[];u<d.length;u++){var l=d[u];D(e,Math.round(l.location*o)),D(e,Math.round(l.midpoint*100)),I(e,Math.round(l.opacity*255))}I(e,2),I(e,o),I(e,32),I(e,a.gradientType==="noise"?1:0),D(e,a.randomSeed||0),I(e,a.addTransparency?1:0),I(e,a.restrictColors?1:0),D(e,Math.round(((i=a.roughness)!==null&&i!==void 0?i:1)*4096));var p=Ra.indexOf((r=a.colorModel)!==null&&r!==void 0?r:"rgb");I(e,p===-1?3:p);for(var f=0;f<4;f++)I(e,Math.round((a.min&&a.min[f]||0)*32768));for(var f=0;f<4;f++)I(e,Math.round((a.max&&a.max[f]||0)*32768));re(e,4)});function et(e){return{c:Q(e),m:Q(e),y:Q(e),k:Q(e)}}function tt(e,t){var n=t||{};ne(e,n.c),ne(e,n.m),ne(e,n.y),ne(e,n.k)}N("selc",Ie("selective color"),function(e,t){if(E(e)!==1)throw new Error("Invalid selc version");var n=E(e)?"absolute":"relative";R(e,8),t.adjustment={type:"selective color",mode:n,reds:et(e),yellows:et(e),greens:et(e),cyans:et(e),blues:et(e),magentas:et(e),whites:et(e),neutrals:et(e),blacks:et(e)}},function(e,t){var n=t.adjustment;I(e,1),I(e,n.mode==="absolute"?1:0),re(e,8),tt(e,n.reds),tt(e,n.yellows),tt(e,n.greens),tt(e,n.cyans),tt(e,n.blues),tt(e,n.magentas),tt(e,n.whites),tt(e,n.neutrals),tt(e,n.blacks)});N("CgEd",function(e){var t=e.adjustment;return t?t.type==="brightness/contrast"&&!t.useLegacy||(t.type==="levels"||t.type==="curves"||t.type==="exposure"||t.type==="channel mixer"||t.type==="hue/saturation")&&t.presetFileName!==void 0:!1},function(e,t,n){var i=Y(e);if(i.Vrsn!==1)throw new Error("Invalid CgEd version");"presetFileName"in i?t.adjustment=h(h({},t.adjustment),{presetKind:i.presetKind,presetFileName:i.presetFileName}):"curvesPresetFileName"in i?t.adjustment=h(h({},t.adjustment),{presetKind:i.curvesPresetKind,presetFileName:i.curvesPresetFileName}):"mixerPresetFileName"in i?t.adjustment=h(h({},t.adjustment),{presetKind:i.mixerPresetKind,presetFileName:i.mixerPresetFileName}):t.adjustment={type:"brightness/contrast",brightness:i.Brgh,contrast:i.Cntr,meanValue:i.means,useLegacy:!!i.useLegacy,labColorOnly:!!i["Lab "],auto:!!i.Auto},R(e,n())},function(e,t){var n,i,r,a,o=t.adjustment;if(o.type==="levels"||o.type==="exposure"||o.type==="hue/saturation"){var s={Vrsn:1,presetKind:(n=o.presetKind)!==null&&n!==void 0?n:1,presetFileName:o.presetFileName||""};K(e,"","null",s)}else if(o.type==="curves"){var s={Vrsn:1,curvesPresetKind:(i=o.presetKind)!==null&&i!==void 0?i:1,curvesPresetFileName:o.presetFileName||""};K(e,"","null",s)}else if(o.type==="channel mixer"){var s={Vrsn:1,mixerPresetKind:(r=o.presetKind)!==null&&r!==void 0?r:1,mixerPresetFileName:o.presetFileName||""};K(e,"","null",s)}else if(o.type==="brightness/contrast"){var s={Vrsn:1,Brgh:o.brightness||0,Cntr:o.contrast||0,means:(a=o.meanValue)!==null&&a!==void 0?a:127,"Lab ":!!o.labColorOnly,useLegacy:!!o.useLegacy,Auto:!!o.auto};K(e,"","null",s)}else throw new Error("Unhandled CgEd case")});function ou(e){var t=[];function n(i){var r;if(i.children)for(var a=0,o=i.children;a<o.length;a++){var s=o[a];((r=s.text)===null||r===void 0?void 0:r.index)!==void 0&&(t[s.text.index]=s),n(s)}}return n(e),t}N("Txt2",ae("engineData"),function(e,t,n,i){var r=Ce(e,n());t.engineData=Ei.fromByteArray(r);var a=ou(i),o=ds(r),s=Kc(o),c=s.ResourceDict.TextFrameSet;if(c)for(var l=0;l<c.length;l++){var u=a[l];c[l].path&&u?.text&&(u.text.textPath=c[l].path)}},function(e,t){var n=Ei.toByteArray(t.engineData);st(e,n)});N("FEid",ae("filterEffectsMasks"),function(e,t,n){var i=_(e);if(i<1||i>3)throw new Error("Invalid filterEffects version ".concat(i));for(t.filterEffectsMasks=[];n()>8;){if(L(e))throw new Error("filterEffects: 64 bit length is not supported");var r=L(e),a=e.offset+r,o=pt(e,1),s=_(e);if(s!==1)throw new Error("Invalid filterEffect version ".concat(s));if(L(e))throw new Error("filterEffect: 64 bit length is not supported");L(e);for(var c=_(e),l=_(e),u=_(e),d=_(e),p=_(e),f=_(e),m=[],v=0;v<f+2;v++){var x=_(e);if(x){if(L(e))throw new Error("filterEffect: 64 bit length is not supported");var b=L(e);if(!b)throw new Error("filterEffect: Empty channel");var y=E(e),S=Ce(e,b-2);m.push({compressionMode:y,data:S})}else m.push(void 0)}if(t.filterEffectsMasks.push({id:o,top:c,left:l,bottom:u,right:d,depth:p,channels:m}),e.offset<a&&T(e)){var g=_(e),F=_(e),w=_(e),k=_(e);if(L(e))throw new Error("filterEffect: 64 bit length is not supported");var C=L(e),y=E(e),S=Ce(e,C-2);t.filterEffectsMasks[t.filterEffectsMasks.length-1].extra={top:g,left:F,bottom:w,right:k,compressionMode:y,data:S}}e.offset=a;for(var O=r;O%4;)e.offset++,O++}},function(e,t){var n;H(e,3);for(var i=0,r=t.filterEffectsMasks;i<r.length;i++){var a=r[i];D(e,0),D(e,0);var o=e.offset;Mt(e,a.id,1),H(e,1),D(e,0),D(e,0);var s=e.offset;H(e,a.top),H(e,a.left),H(e,a.bottom),H(e,a.right),H(e,a.depth);var c=Math.max(0,a.channels.length-2);H(e,c);for(var l=0;l<c+2;l++){var u=a.channels[l];H(e,u?1:0),u&&(D(e,0),D(e,u.data.length+2),I(e,u.compressionMode),st(e,u.data))}e.view.setUint32(s-4,e.offset-s,!1);var d=(n=t.filterEffectsMasks[t.filterEffectsMasks.length-1])===null||n===void 0?void 0:n.extra;d&&(B(e,1),H(e,d.top),H(e,d.left),H(e,d.bottom),H(e,d.right),D(e,0),D(e,d.data.byteLength+2),I(e,d.compressionMode),st(e,d.data));var p=e.offset-o;for(e.view.setUint32(o-4,p,!1);p%4;)re(e,1),p++}});zt("FXid","FEid");N("FMsk",ae("filterMask"),function(e,t){t.filterMask={colorSpace:Se(e),opacity:E(e)/255}},function(e,t){var n;Fe(e,t.filterMask.colorSpace),I(e,ao((n=t.filterMask.opacity)!==null&&n!==void 0?n:1,0,1)*255)});N("artd",function(e){return e.artboards!==void 0},function(e,t,n){var i=Y(e);t.artboards={count:i["Cnt "],autoExpandOffset:{horizontal:i.autoExpandOffset.Hrzn,vertical:i.autoExpandOffset.Vrtc},origin:{horizontal:i.origin.Hrzn,vertical:i.origin.Vrtc},autoExpandEnabled:i.autoExpandEnabled,autoNestEnabled:i.autoNestEnabled,autoPositionEnabled:i.autoPositionEnabled,shrinkwrapOnSaveEnabled:!!i.shrinkwrapOnSaveEnabled,docDefaultNewArtboardBackgroundColor:qe(i.docDefaultNewArtboardBackgroundColor),docDefaultNewArtboardBackgroundType:i.docDefaultNewArtboardBackgroundType},R(e,n())},function(e,t){var n,i,r,a,o,s=t.artboards,c={"Cnt ":s.count,autoExpandOffset:s.autoExpandOffset?{Hrzn:s.autoExpandOffset.horizontal,Vrtc:s.autoExpandOffset.vertical}:{Hrzn:0,Vrtc:0},origin:s.origin?{Hrzn:s.origin.horizontal,Vrtc:s.origin.vertical}:{Hrzn:0,Vrtc:0},autoExpandEnabled:(n=s.autoExpandEnabled)!==null&&n!==void 0?n:!0,autoNestEnabled:(i=s.autoNestEnabled)!==null&&i!==void 0?i:!0,autoPositionEnabled:(r=s.autoPositionEnabled)!==null&&r!==void 0?r:!0,shrinkwrapOnSaveEnabled:(a=s.shrinkwrapOnSaveEnabled)!==null&&a!==void 0?a:!0,docDefaultNewArtboardBackgroundColor:$e(s.docDefaultNewArtboardBackgroundColor),docDefaultNewArtboardBackgroundType:(o=s.docDefaultNewArtboardBackgroundType)!==null&&o!==void 0?o:1};K(e,"","null",c,"artd")});function ks(e){return Object.keys(e).map(function(t){return e[t]}).some(function(t){return Array.isArray(t)&&t.length>1})}N("lfx2",function(e){return e.effects!==void 0&&!ks(e.effects)},function(e,t,n){var i=L(e);if(i!==0)throw new Error("Invalid lfx2 version");var r=Y(e);t.effects=un(r,!!e.logMissingFeatures),R(e,n())},function(e,t,n,i){var r=cn(t.effects,!!i.logMissingFeatures,!0);D(e,0),K(e,"","null",r)});N("cinf",ae("compositorUsed"),function(e,t,n){var i=Y(e);function r(a){return a.split(".")[1]}t.compositorUsed={description:i.description,reason:i.reason,engine:r(i.Engn)},i.Vrsn&&(t.compositorUsed.version=i.Vrsn),i.psVersion&&(t.compositorUsed.photoshopVersion=i.psVersion),i.enableCompCore&&(t.compositorUsed.enableCompCore=r(i.enableCompCore)),i.enableCompCoreGPU&&(t.compositorUsed.enableCompCoreGPU=r(i.enableCompCoreGPU)),i.enableCompCoreThreads&&(t.compositorUsed.enableCompCoreThreads=r(i.enableCompCoreThreads)),i.compCoreSupport&&(t.compositorUsed.compCoreSupport=r(i.compCoreSupport)),i.compCoreGPUSupport&&(t.compositorUsed.compCoreGPUSupport=r(i.compCoreGPUSupport)),R(e,n())},function(e,t){var n=t.compositorUsed,i={Vrsn:n.version||{major:1,minor:0,fix:0}};n.photoshopVersion&&(i.psVersion=n.photoshopVersion),i.description=n.description,i.reason=n.reason,i.Engn="Engn.".concat(n.engine),n.enableCompCore&&(i.enableCompCore="enable.".concat(n.enableCompCore)),n.enableCompCoreGPU&&(i.enableCompCoreGPU="enable.".concat(n.enableCompCoreGPU)),n.enableCompCoreThreads&&(i.enableCompCoreThreads="enable.".concat(n.enableCompCoreThreads)),n.compCoreSupport&&(i.compCoreSupport="reason.".concat(n.compCoreSupport)),n.compCoreGPUSupport&&(i.compCoreGPUSupport="reason.".concat(n.compCoreGPUSupport)),K(e,"","null",i)});N("extn",function(e){return e._extn!==void 0},function(e,t){Y(e)},function(e,t){});N("iOpa",ae("fillOpacity"),function(e,t){t.fillOpacity=T(e)/255,R(e,3)},function(e,t){B(e,t.fillOpacity*255),re(e,3)});N("brst",ae("channelBlendingRestrictions"),function(e,t,n){for(t.channelBlendingRestrictions=[];n()>4;)t.channelBlendingRestrictions.push(_(e))},function(e,t){for(var n=0,i=t.channelBlendingRestrictions;n<i.length;n++){var r=i[n];H(e,r)}});N("tsly",ae("transparencyShapesLayer"),function(e,t){t.transparencyShapesLayer=!!T(e),R(e,3)},function(e,t){B(e,t.transparencyShapesLayer?1:0),re(e,3)});function B(e,t){var n=lt(e,1);e.view.setUint8(n,t)}function ne(e,t){var n=lt(e,2);e.view.setInt16(n,t,!1)}function I(e,t){var n=lt(e,2);e.view.setUint16(n,t,!1)}function su(e,t){var n=lt(e,2);e.view.setUint16(n,t,!0)}function H(e,t){var n=lt(e,4);e.view.setInt32(n,t,!1)}function Ba(e,t){var n=lt(e,4);e.view.setInt32(n,t,!0)}function D(e,t){var n=lt(e,4);e.view.setUint32(n,t,!1)}function Xe(e,t){var n=lt(e,4);e.view.setFloat32(n,t,!1)}function Ke(e,t){var n=lt(e,8);e.view.setFloat64(n,t,!1)}function Oe(e,t){H(e,t*65536)}function je(e,t){H(e,t*(1<<24))}function st(e,t){if(t){Cs(e,e.offset+t.length);var n=new Uint8Array(e.buffer);n.set(t,e.offset),e.offset+=t.length}}function re(e,t){for(var n=0;n<t;n++)B(e,0)}function U(e,t){if(t.length!==4)throw new Error("Invalid signature: '".concat(t,"'"));for(var n=0;n<4;n++)B(e,t.charCodeAt(n))}function lu(e,t){for(var n=0;n<t.length;n++)B(e,t.charCodeAt(n))}function Mt(e,t,n){var i=t.length;if(i>255)throw new Error("String too long");B(e,i);for(var r=0;r<i;r++){var a=t.charCodeAt(r);B(e,a<128?a:63)}for(;++i%n;)B(e,0)}function cu(e,t){for(var n=0;n<t.length;n++)I(e,t.charCodeAt(n))}function uu(e,t){for(var n=0;n<t.length;n++)su(e,t.charCodeAt(n))}function Me(e,t){D(e,t.length),cu(e,t)}function xt(e,t){D(e,t.length+1);for(var n=0;n<t.length;n++)I(e,t.charCodeAt(n));I(e,0)}function yt(e,t,n,i,r){i===void 0&&(i=!1),r===void 0&&(r=!1),r&&D(e,0);var a=e.offset;D(e,0),n();for(var o=e.offset-a-4,s=o;s%t;)B(e,0),s++;i&&(o=s),e.view.setUint32(a,o,!1)}function fu(e,t){var n=e.buffer.byteLength;do n*=2;while(t>n);var i=new ArrayBuffer(n),r=new Uint8Array(i),a=new Uint8Array(e.buffer);r.set(a),e.buffer=i,e.view=new DataView(e.buffer)}function Cs(e,t){t>e.buffer.byteLength&&fu(e,t)}function lt(e,t){var n=e.offset;return Cs(e,e.offset+=t),n}function Fe(e,t){t?"r"in t?(I(e,0),I(e,Math.round(t.r*257)),I(e,Math.round(t.g*257)),I(e,Math.round(t.b*257)),I(e,0)):"fr"in t?(I(e,0),I(e,Math.round(t.fr*255*257)),I(e,Math.round(t.fg*255*257)),I(e,Math.round(t.fb*255*257)),I(e,0)):"l"in t?(I(e,7),ne(e,Math.round(t.l*1e4)),ne(e,Math.round(t.a<0?t.a*12800:t.a*12700)),ne(e,Math.round(t.b<0?t.b*12800:t.b*12700)),I(e,0)):"h"in t?(I(e,1),I(e,Math.round(t.h*65535)),I(e,Math.round(t.s*65535)),I(e,Math.round(t.b*65535)),I(e,0)):"c"in t?(I(e,2),I(e,Math.round(t.c*257)),I(e,Math.round(t.m*257)),I(e,Math.round(t.y*257)),I(e,Math.round(t.k*257))):(I(e,8),I(e,Math.round(t.k*1e4/255)),re(e,6)):(I(e,0),re(e,8))}var _a;(function(e){e[e.Bitmap=0]="Bitmap",e[e.Grayscale=1]="Grayscale",e[e.Indexed=2]="Indexed",e[e.RGB=3]="RGB",e[e.CMYK=4]="CMYK",e[e.Multichannel=7]="Multichannel",e[e.Duotone=8]="Duotone",e[e.Lab=9]="Lab"})(_a||(_a={}));var Na;(function(e){e[e.Other=0]="Other",e[e.OpenFolder=1]="OpenFolder",e[e.ClosedFolder=2]="ClosedFolder",e[e.BoundingSectionDivider=3]="BoundingSectionDivider"})(Na||(Na={}));var za;(function(e){e[e.None=0]="None",e[e.Visibility=1]="Visibility",e[e.Position=2]="Position",e[e.Appearance=4]="Appearance"})(za||(za={}));function du(e,t){var n="buffer"in e?ya(e.buffer,e.byteOffset,e.byteLength):ya(e);return wc(n,t)}class ln extends HTMLElement{static observedAttributes=["src","layers"];resizeObserver;psd=null;shadow;container=document.createElement("div");baseWidth=0;baseHeight=0;constructor(t={}){super(),this.#e(t),this.container.classList.add("container"),this.shadow=this.attachShadow({mode:"closed"});const n=document.createElement("style");n.textContent=`
            :host {
                display: flex;
                justify-content: center;             
                align-items: center;             
            }

            .container {
                position: relative;     /* レイヤーの基準座標 */
                transform-origin: center;
            }

            .psd-canvas {
                position: absolute;     /* 全レイヤーが同一原点に重なる */
                image-rendering: pixelated;
                animation: fade-in 0.1s linear; 
            }

            @keyframes fade-in {
                from {
                    opacity: 0.5;
                }

                to {
                    opacity: 1;
                }
            }
        `,this.shadow.appendChild(n),this.shadow.appendChild(this.container),this.resizeObserver=new ResizeObserver(()=>{this.updateScale()}),this.resizeObserver.observe(this)}#e(t){t.url&&this.setAttribute("src",t.url),t.layers&&this.setAttribute("layers",t.layers)}set layers(t){this.setAttribute("layers",t)}get layers(){return this.getAttribute("layers")??""}attributeChangedCallback(t,n,i){n!==i&&(t==="src"&&i?this.loadPsd(i):t==="layers"&&this.renderLayers())}async loadPsd(t){this.psd=null;try{const n=await this.fetchPsdData(t);this.psd=du(n,{useImageData:!0}),this.baseWidth=this.psd.width??0,this.baseHeight=this.psd.height??0,this.container.style.width=`${this.baseWidth}px`,this.container.style.height=`${this.baseHeight}px`,this.renderLayers()}catch(n){this.renderError(n)}}async fetchPsdData(t){const n=await fetch(t);if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);return await n.arrayBuffer()}renderLayers(){if(!this.psd||!this.psd.children)return;const t=this.getAttribute("layers");if(!t){this.container.innerHTML+='<p>Please specify a "layers" attribute.</p>';return}this.clearContent();const n=t.split(",").map(i=>i.trim());for(const i of n){const r=ln.findLayerByName(this.psd.children,i);if(!r){console.error(`PsdElement: layer-name ${i} is not found.`),console.error("layers:",this.psd?.children?.map(a=>a.name));break}this.appendLayerCanvas(r)}this.updateScale()}appendLayerCanvas(t){if(t.children){for(const n of t.children)this.appendLayerCanvas(n);return}t.canvas||(t.canvas=ln.createCanvas(t.imageData),t.canvas.dataset.baseLeft=String(t.left),t.canvas.dataset.baseTop=String(t.top),t.canvas.classList.add("psd-canvas")),this.container.appendChild(t.canvas)}renderLoading(){this.clearContent(),this.container.innerHTML+="<p>Loading PSD...</p>"}renderError(t){this.clearContent();const n=t instanceof Error?t.message:"Unknown error";this.container.innerHTML+=`<p style="color:red">Error: ${n}</p>`}clearContent(){this.container.innerHTML=""}updateScale(){if(!this.baseWidth||!this.baseHeight)return;const t=this.clientWidth/this.baseWidth,n=this.clientHeight/this.baseHeight,i=Math.min(t,n);this.container.style.width=`${this.baseWidth*i}px`,this.container.style.height=`${this.baseHeight*i}px`,this.shadow.querySelectorAll("canvas").forEach(r=>{r.style.left=`${Number(r.dataset.baseLeft)*i}px`,r.style.top=`${Number(r.dataset.baseTop)*i}px`,r.style.width=`${r.width*i}px`,r.style.height=`${r.height*i}px`})}static findLayerByName(t,n){for(const i of t){if(i.name===n)return i;if(i.children){const r=this.findLayerByName(i.children,n);if(r)return r}}return null}static createCanvas(t){const n=document.createElement("canvas");n.width=t.width,n.height=t.height;const i=n.getContext("2d");if(!i)throw new Error("Failed to get 2D context");return i.putImageData(t,0,0),n}}customElements.define("psd-viewer",ln);class dt{#e;#r;constructor(t,n=.5){this.#e=new Audio(t),this.#r=n,this.#e.volume=n}get duration(){return this.#e.duration}play(){this.#e.currentTime=0,this.#e.play()}setVolume(t){this.#e.volume=t*this.#r}}class hu{static clear=new dt("assets/sounds/se/clear.mp3",1);static move=new dt("assets/sounds/se/マウススプレー・口内.mp3",.5);static reset=new dt("assets/sounds/se/窓を開ける.mp3",1);static switch=new dt("assets/sounds/se/引き戸を閉める.mp3",1);static click=new dt("assets/sounds/se/カーソル移動2.mp3",1);static suzu=new dt("assets/sounds/se/鈴が鳴る.mp3",1);static kansei=new dt("assets/sounds/se/歓声.mp3",1);static voice=new dt("assets/sounds/se/voice.mp3",.5);static setVolume(t){Object.values(this).forEach(n=>{n.setVolume(t)})}}class pu{static#e=document.createElement("div");static#r;static#n;static#i;static#t;static#s;static#o="say";static#u=()=>{};static#l=[];static init(){this.#f(),this.#d(),this.#h()}static#f(){this.#e.innerHTML=`
            <div id="serif-background"></div>
            <div id="serif-window">
                <div id="serif-icon-container" class="hidden"></div>
                <div id="serif-text-container" class="text-end"></div>
                <span id="serif-Z">[Z]長押しでスキップ</span>
            </div>
        `,this.#e.id="serif-container",document.body.appendChild(this.#e)}static#d(){this.#r=this.#e.querySelector("#serif-background"),this.#n=this.#e.querySelector("#serif-window"),this.#i=this.#e.querySelector("#serif-icon-container"),this.#t=this.#e.querySelector("#serif-text-container"),this.#s=this.#e.querySelector("#serif-Z")}static#h(){this.#e.addEventListener("click",()=>{this.#o==="say"&&this.#a()}),window.addEventListener("keydown",t=>{["KeyZ","Enter","Space"].includes(t.code)&&this.#o==="say"&&this.#a(),t.code==="KeyX"&&this.#n.classList.toggle("hidden")})}static ask(t,n){return this.#o="ask",this.#s.classList.add("hidden"),this.#c(),this.#t.innerHTML=t,requestAnimationFrame(()=>{this.#t.dataset.mode="ask",this.#t.classList.add("fade-in")}),new Promise(i=>{n.forEach((r,a)=>{const o=document.createElement("button");o.textContent=r,o.onclick=()=>{this.#e.classList.remove("shown"),i(a)},this.#t.appendChild(o)}),this.#e.classList.add("shown")})}static say(...t){return t.length===0?Promise.resolve():(this.#t.dataset.mode="say",this.#o="say",this.#s.classList.remove("hidden"),this.#c(),this.#l=t,this.#t.classList.add("text-end"),requestAnimationFrame(()=>{this.#e.classList.add("shown")}),this.#a(),new Promise(n=>{this.#u=n}))}static#a(){if(this.#l.length===0){this.#e.classList.remove("shown"),me.sleep(400).then(()=>{this.#c()}),this.#u();return}this.#p()}static#p(){const t=this.#l.shift();if(typeof t=="string")hu.voice.play(),this.#t.innerHTML=t,this.#t.classList.remove("fade-in"),requestAnimationFrame(()=>{this.#t.classList.add("fade-in")});else if(t.type==="background")this.#r.innerHTML=`<img src="${t.image}" alt="" class="fade-in"/>`,this.#a();else if(t.type==="portrait"){const n=new ln({url:`${t.url}`,layers:"normal"});n.classList.add("serif-portrait","hidden"),n.classList.add(t.side??"left"),n.id=t.name,this.#e.appendChild(n),this.#a()}else if(t.type==="portrait-change"){const n=this.#e.querySelector(`#${t.name}`);n.layers=t.layers,n.classList.remove("hidden"),this.#a()}}static#c(){this.#n.classList.remove("hidden"),this.#e.style.cursor={say:"pointer",ask:"default"}[this.#o],this.#r.innerHTML="",this.#i.classList.add("hidden"),this.#t.classList.remove("fade-in"),this.#t.classList.remove("text-end"),this.#e.querySelectorAll("psd-viewer").forEach(t=>t.remove())}}document.addEventListener("DOMContentLoaded",async()=>{Ve.init(),pu.init(),er.init(),Gn.init(),er.container.innerHTML='<p class="loading">Loading</p>',new URLSearchParams(window.location.search).get("delete")==="true"&&Ga.clear(),await document.fonts.ready;const{SceneTitle:t}=await Ps(async()=>{const{SceneTitle:n}=await import("./assets/SceneTitle.js").then(i=>i.a);return{SceneTitle:n}},[],import.meta.url);Ds.init(new t)});window.addEventListener("contextmenu",e=>{e.preventDefault()});export{me as A,Ve as B,er as D,Ga as L,hu as S,Ps as _,Ds as a,pu as b};
//# sourceMappingURL=run.js.map
